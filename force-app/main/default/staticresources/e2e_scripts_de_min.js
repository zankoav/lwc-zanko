$j=jQuery.noConflict();var chatActivityTimeout,chatOfflineUpdateTimeout,chatOfflineOLDText,autoChatLastStep,displayVoucherLightbox,regs={phone:/^([0-9+]{13,15})+$/,numbers:/^[0-9]+$/,letters:/^[a-zA-ZÀ-ž\x7f-\xff\s'-]+$/,lettersAndNumbers:/^[0-9a-zA-ZÀ-ž\x7f-\xff\s'&.-]+$/,embossingLetters:/^[a-zA-Z\s]+$/,embossingLettersAndNumbers:/^[0-9a-zA-Z\s]+$/,email:/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,carNumberFormat_DE:/^[A-Za-z]{1,3}\-?\s?[A-Za-z]{0,2}[0-9]{1,4}[H]{0,1}/,swiftFormat:/^[A-Za-z]{4}[A-Za-z]{2}[A-Za-z0-9]{2}([A-Za-z0-9]{3})?$/,ibanFormat_DE:/^[DEde]{2}[0-9]{2}\s?[0-9]{4}\s?[0-9]{4}\s?[0-9]{4}\s?[0-9]{4}\s?[0-9]{2}?$/,vatIdFormat_DE:/^([DEde]{2}[0-9]{9})+$/},minPumpValue=75,maxPumpValue=5e4,dataSource="eurolocator.fleetcor.de",favStationInfo="",errors={0:"ZERO_SEARCH_RESULTS"};function isInputValueValid(e,t){var n=!1,i=e.val();return""!=i.trim()&&t.test(i)?(e.closest(".form-group input").removeClass("error"),e.closest(".form-group input").addClass("success"),e.closest(".form-group").find(".invalid-feedback").hide(),e.closest(".form-group").find(".glyphicon").show(),n=!0):(e.closest(".form-group input").removeClass("success"),e.closest(".form-group input").addClass("error"),e.closest(".form-group").find(".invalid-feedback").show(),e.closest(".form-group").find(".glyphicon").hide(),n=!1),n}function checkRequiredFields(e,t){var n=!1,i=!1;e.each(function(){""==$j(this).val()&&(n=!0),$j(this).hasClass("error")&&(i=!0)}),n||i?t.attr("disabled",!0):t.attr("disabled",!1)}function isRadioButtonSelected(e){var t=!1;return e.each(function(){$j(this).is(":checked")&&(t=!0)}),t}function isSwitchChecked(e){var t=!1;return e.each(function(){$j(this).is(":checked")&&(t=!0)}),t}function validateContactDetails(e){var t,n=$j(".step-content .contact-details"),i=n.find(".first-name").find("input"),a=n.find(".last-name").find("input"),r=n.find(".phone").find("input"),s=n.find(".email").find("input"),d=[];d.push(isInputValueValid(i,new RegExp(regs.letters))),d.push(isInputValueValid(a,new RegExp(regs.letters))),d.push(isInputValueValid(r,new RegExp(regs.phone))),d.push(isInputValueValid(s,new RegExp(regs.email))),t=-1==d.indexOf(!1);var o=n.find('input[type="checkbox"]').is(":checked"),c=n.find(".btn-red").is("[disabled=disabled]");return!(!t||c||!o)&&(e&&goToCreditScoring(),!0)}function validateTaxId(e,t){var n=!1,i=e.val().length,a=e.val();return""!=a.trim()&&t.test(a)&&i>=9&&i<=12?(e.closest(".form-group input").removeClass("error"),e.closest(".form-group input").addClass("success"),e.closest(".form-group").find(".invalid-feedback").hide(),e.closest(".form-group").find(".glyphicon").show(),n=!0):(e.closest(".form-group input").removeClass("success"),e.closest(".form-group input").addClass("error"),e.closest(".form-group").find(".invalid-feedback").show(),e.closest(".form-group").find(".glyphicon").hide(),n=!1),n}function validateCompanyDetails(e){var t,n=$j(".step-content .credit-scoring"),i=n.find(".company").find("input"),a=[];a.push(isInputValueValid(i,new RegExp(regs.lettersAndNumbers))),t=-1==a.indexOf(!1);var r=n.find(".btn-red").is("[disabled=disabled]");return!(!t||r)&&(e&&goToFuelConsumption(),!0)}function recheckCompanyDetails(){var e=$j(".step-content .credit-scoring");checkRequiredFields(e.find(".form-control.required"),e.find(".btn-red.search"))}function validateCompanyDetailsForSearch(){startSplash();var e,t=$j(".step-content .credit-scoring"),n=t.find(".company").find("input"),i=[];i.push(isInputValueValid(n,new RegExp(regs.lettersAndNumbers))),e=-1==i.indexOf(!1);var a=t.find(".btn-red.search").is("[disabled=disabled]");return!(!e||a)&&(doSaveCompany(),!0)}function validatePumpInputValue(e,t){void 0!=e.val()&&(e.val(e.val().replace(/[^\d]/,"")),$j(".totalPumpField").val(e.val()));var n=e.val(),i=e.val();void 0!=i&&""!=i.trim()&&t.test(i)?n<minPumpValue?(e.closest(".form-group input").addClass("error"),e.closest(".wrapper").find(".consumption-warning1").show(),e.closest(".wrapper").find(".consumption-warning2").hide(),e.closest(".wrapper").find(".limit-info").css("color","#EE3A43"),e.closest(".wrapper").find(".btn-red").attr("disabled",!0)):n>maxPumpValue?(e.closest(".form-group input").addClass("error"),e.closest(".wrapper").find(".consumption-warning2").show(),e.closest(".wrapper").find(".consumption-warning1").hide(),e.closest(".wrapper").find(".limit-info").css("color","#EE3A43"),e.closest(".wrapper").find(".btn-red").attr("disabled",!0)):(e.closest(".form-group input").removeClass("error"),e.closest(".wrapper").find(".consumption-warning1").hide(),e.closest(".wrapper").find(".limit-info").css("color","#1A1A1A"),e.closest(".wrapper").find(".btn-red").attr("disabled",!1)):(e.closest(".form-group input").removeClass("error"),e.closest(".wrapper").find(".consumption-warning1").hide(),e.closest(".wrapper").find(".limit-info").css("color","#1A1A1A"),e.closest(".wrapper").find(".btn-red").attr("disabled",!0))}function validatePumpDetails(){var e=$j(".step-content .fuel-consumption"),t=!1;e.find(".btn-red").is("[disabled=disabled]")||(goToOfferCreditLine(),t=!0);var n=e.find(".pump").find("input").val();return(n<minPumpValue||n>maxPumpValue)&&(t=!1),t}function validateCreditLimit(e){var t=!1;return $j(".step-content .credit-line").find(".btn-red.continue").is("[disabled=disabled]")||(e&&(analytics_goToCardsConfig(),goToCardsOrder()),t=!0),t}function validateCreditLimitValue(e){var t=""===e.html()?0:parseInt(e.html()),n=parseInt($j(".slider-label-first").html()),i=parseInt($j(".slider-label-last").html());t<n||t>i?(e.closest(".form-group input").addClass("error"),e.closest(".form-group").find(".invalid-feedback").show(),e.closest(".wrapper").find(".btn-red").attr("disabled",!0)):(e.closest(".form-group input").removeClass("error"),e.closest(".form-group").find(".invalid-feedback").hide(),e.closest(".wrapper").find(".btn-red").attr("disabled",!1))}function checkCardsCounter(){$j(".step-content .cards-order");var e=parseInt($j(".cards-count input").val());$j(".diff-cards-category .cards-list").find(".card-item").size()>1&&1==e&&($j(".b-nav-cards").find(".tab1").removeClass("active"),$j(".b-nav-cards").find(".tab2").addClass("active"))}function checkCardTechParams(){var e=$j(".step-content").find(".cards-tech-parameters"),t=e.find(".cards-list .card-item"),n=e.find(".btn-red.continue"),i=!1,a=t.closest(".card-item").find(".card-owner-type").find('[id$="selectDriverNameOrCarNumber"]').attr("class"),r=e.find(".cards-list .card-item .card-param-value input");""!=r.val()&&void 0!=r.val()&&void 0!=a&&("car-number"===a.toLowerCase()&&(i=validateCarNumber(r,new RegExp(regs.carNumberFormat_DE))),"driver-name"===a.toLowerCase()&&(i=validateDriverName(r,new RegExp(regs.embossingLetters))));var s=t.find(".company-name input");void 0!=s.val()&&isInputValueValid(s,new RegExp(regs.embossingLettersAndNumbers)),i||i||n.find("disabled",!0)}function validateCardsTechParams(e){var t,n=$j(".step-content .cards-tech-parameters"),i=n.find(".btn-red.btn-done").is("[disabled=disabled]"),a=[],r=n.find(".cards-list .card-item"),s=r.closest(".card-item").find(".card-owner-type").find('[id$="selectDriverNameOrCarNumber"]').attr("class"),d=n.find(".cards-list .card-item .card-param-value input");void 0!=d.val()&&void 0!=s&&("car-number"===s.toLowerCase()&&a.push(validateCarNumber(d,new RegExp(regs.carNumberFormat_DE))),"driver-name"===s.toLowerCase()&&a.push(validateDriverName(d,new RegExp(regs.embossingLetters))));var o=r.find(".company-name input");return void 0!=o.val()&&a.push(isInputValueValid(o,new RegExp(regs.embossingLettersAndNumbers))),t=-1==a.indexOf(!1),!i&&t&&saveTechParamForSingleCard(e),!1}function validateCarNumber(e,t){var n=!1,i=e.val().length,a=e.val();return""!=a.trim()&&t.test(a)&&i>=8&&i<=11?(e.closest(".form-group input").removeClass("error"),e.closest(".form-group input").addClass("success"),e.closest(".form-group").find(".invalid-feedback-car-number").hide(),e.closest(".form-group").find(".glyphicon").show(),n=!0):(e.closest(".form-group input").removeClass("success"),e.closest(".form-group input").addClass("error"),e.closest(".form-group").find(".invalid-feedback-car-number").show(),e.closest(".form-group").find(".glyphicon").hide(),n=!1),n}function validateDriverName(e,t){var n=!1,i=e.val().length,a=e.val();return""!=a.trim()&&t.test(a)&&i<=16?(e.closest(".form-group input").removeClass("error"),e.closest(".form-group input").addClass("success"),e.closest(".form-group").find(".invalid-feedback-driver").hide(),e.closest(".form-group").find(".glyphicon").show(),n=!0):(e.closest(".form-group input").removeClass("success"),e.closest(".form-group input").addClass("error"),e.closest(".form-group").find(".invalid-feedback-driver").show(),e.closest(".form-group").find(".glyphicon").hide(),n=!1),n}function validatePaymentDirectDebit(){var e=!1;return $j(".step-content .payment-direct-debit").find(".btn-red.continue").is("[disabled=disabled]")||(goToCongratulations(),e=!0),e}function validateBankTransferNoDeposit(){var e=!1;return $j(".step-content .bank-transfer-no-deposit").find(".btn-red.continue").is("[disabled=disabled]")||(goToCongratulations(),e=!0),e}function validDirectDebitForm(e,t){var n=[];t.each(function(){$j(this).hasClass("active")?n.push(!0):n.push(!1)});var i=e.find('input[type="checkbox"]').is(":checked");-1!=n.indexOf(!0)&&i?e.find(".btn-red").attr("disabled",!1):e.find(".btn-red").attr("disabled",!0)}function validBankTransferForm(e,t,n){var i=[];t.each(function(){$j(this).hasClass("active")?i.push(!0):i.push(!1)}),-1!=i.indexOf(!0)&&(-1!=n.indexOf(!1)?e.find(".btn-red.continue").attr("disabled",!0):e.find(".btn-red.continue").attr("disabled",!1))}function createSlider(e,t,n,i,a,r){$j("#"+e).slider({range:!1,min:a,max:r,values:[i],step:100,slide:function(e,i){$j("[id$="+n+"]").val(i.values[0]),$j("[id$="+t+"]").text(i.values[0]),colorSliderActiveLine()},stop:function(e,t){recalculateDeposit(),colorSliderActiveLine()}}),$j('[id$=" + dispOutput + "]').text(i)}function colorSliderActiveLine(){var e;void 0!=$j("#slider").find(".ui-slider-handle")[0]&&(e=parseInt($j("#slider").find(".ui-slider-handle")[0].style.left.split("%")[0]),$j("#slider").find(".slider-active-line")[0].style.width=e+"%")}function increaseCards(){var e=parseInt($j(".cards-count .number-wrapper input").val());e<50&&$j(".cards-count .number-wrapper input").val(e+1)}function reductionCards(){var e=parseInt($j(".cards-count .number-wrapper input").val());e>1&&$j(".cards-count .number-wrapper input").val(e-1)}function showCardsOrderNavigationTabs(){}function showInternationalTransactionInfo(e){e?$j(".wrapper.blue-block").find("#internationalTrans").show():$j(".wrapper.blue-block").find("#internationalTrans").hide()}function showFuelPartnerTransactionInfo(e){e?$j(".wrapper.blue-block").find("#partnerTrans").show():$j(".wrapper.blue-block").find("#partnerTrans").hide()}function showLocator(){$j(".b-locator").show();var e=$j('[id$="chooseStation"]');return e.find(".btn-red").hasClass("is-disabled")||(e.find(".choose-station-btn").hide(),e.find(".save-station-btn").show()),!1}function pickStation(){var e=$j('[id$="chooseStation"]');return e.find(".btn-red.my-station").is("[disabled=disabled]")||($j(".b-locator").hide(),e.find(".offer-label .arrow-right").addClass("selected"),e.find(".offer-label .price-right").addClass("selected"),e.find(".save-station-btn").hide(),e.find(".fav-station").show()),!1}function cancelStationChoice(){var e=$j('[id$="chooseStation"]');return e.find(".offer-label .arrow-right").removeClass("selected"),e.find(".offer-label .price-right").removeClass("selected"),e.find(".fav-station").hide(),e.find(".choose-station-btn").show(),!1}function setShellDiscount(){var e=$j('[id$="allShellDiscount"]');return e.find(".btn-red").hasClass("is-disabled")||(e.find(".offer-label .arrow-right").addClass("selected"),e.find(".offer-label .price-right").addClass("selected"),e.find(".save-btn").hide(),e.find(".remove-btn").show()),!1}function cancelShellDiscount(){var e=$j('[id$="allShellDiscount"]');return e.find(".offer-label .arrow-right").removeClass("selected"),e.find(".offer-label .price-right").removeClass("selected"),e.find(".save-btn").show(),e.find(".remove-btn").hide(),!1}function enableDisableContinueButton(){0==$j(".cards-tech-parameters .cards-list .btn-done:disabled").length?$j(".cards-tech-parameters .btn.continue").removeAttr("disabled"):$j(".cards-tech-parameters .btn.continue").attr("disabled",!0)}function switchingToDriverName(){var e=$j(".cards-tech-parameters .cards-list .card-item");e.find(".card-param.driver").show(),e.find(".card-param.car").hide()}function switchingToCarNumber(){var e=$j(".cards-tech-parameters .cards-list .card-item");e.find(".card-param.driver").hide(),e.find(".card-param.car").show()}function counterLenCompanyName(){var e=$j(".cards-tech-parameters .cards-list .card-item"),t=e.find(".company-name input")[0];void 0!=t&&e.find(".company-name .len-company-name").text(t.value.length+"/"+t.maxLength),e.find(".company-name").on("keyup",function(){e.find(".company-name .len-company-name").text(t.value.length+"/"+t.maxLength)})}function startPayment(e){var t=$j(".step-content ."+e).find(".btn-red.continue").is("[disabled=disabled]"),n=!1,i=document.getElementById("paymentFormToSubmit");return t||(i.submit(),n=!0),n}function updatePaymentMethod(e,t){var n=document.getElementById(t);null!=n&&(n.value=e.value,changeMethod())}function printDocument(e){window.frames[e].print()}function printPaymentInformation(){var e='<html><body onload="window.print()">'+document.getElementById("paymentInformation").innerHTML+"</body></html>",t=window.open("","Payment Information");t.document.open(),t.document.write(e),t.document.close(),setTimeout(function(){t.close()},10)}function onPageLoad(){createSlider("slider","creditLimitInput","idInputHidden",100,100,600),0==$j("#slider").find(".slider-active-line").length&&$j("#slider").append('<div class="slider-active-line" style="width:0%"></div>'),$j(".b-switch-block").each(function(){$j(this).find(".onoffswitch .onoffswitch-checkbox").is(":checked")||$j(this).css("background","#f6f6f6")}),$j(".onoffswitch .onoffswitch-checkbox").on("click",function(){var e=$j(this).parents().closest(".b-switch-block");$j(this).is(":checked")?(e.css("background","#cecece"),e.find(".onoffswitch-switch").css({margin:"8px",background:"#ffffff"})):(e.css("background","#f6f6f6"),e.find(".onoffswitch-switch").css({margin:"8px",background:"#cecece"}))}),setCollapseBlockEvent()}function onPageRender(){$j('[data-toggle="popover"]').popover()}function setCollapseBlockEvent(){$j(".collapse-block .link").on("click",function(){var e=$j(this).parent().find(".row"),t=$j(this).find(".expander");e.is(":hidden")?(t.removeClass("expend-detail").addClass("collapse-detail"),$j(this).find(".more").hide(),$j(this).find(".less").show()):(t.removeClass("collapse-detail").addClass("expend-detail"),$j(this).find(".less").hide(),$j(this).find(".more").show())})}function setEvents_contactDetails(){var e=$j(".step-content").find(".contact-details"),t=e.find(".first-name").find("input");t.on("input",function(e){isInputValueValid(t,new RegExp(regs.letters))});var n=e.find(".last-name").find("input");n.on("input",function(e){isInputValueValid(n,new RegExp(regs.letters))});var i=e.find(".phone").find("input");i.inputmask({mask:"+4\\9999999999999",placeholder:""}),i.on("input",function(e){isInputValueValid(i,new RegExp(regs.phone))});var a=e.find(".email").find("input");a.on("input",function(e){isInputValueValid(a,new RegExp(regs.email))});var r=e.find('input[type="checkbox"]'),s=e.find(".form-control.required");s.keyup(function(){checkRequiredFields(s,e.find(".btn-red")),r.is(":checked")||e.find(".btn-red").attr("disabled",!0)}),r.is(":checked")||e.find(".btn-red").attr("disabled",!0),r.on("click",function(){var t=!1;s.each(function(){return""==$j(this).val()?(t=!1,!1):$j(this).hasClass("error")?(t=!1,!1):void(t=!0)}),t&&r.is(":checked")?e.find(".btn-red").attr("disabled",!1):e.find(".btn-red").attr("disabled",!0)}),setCollapseBlockEvent()}function setEvents_companyDetails(){var e=$j(".step-content").find(".credit-scoring"),t=e.find(".company").find("input");""!=t.val()&&void 0!=t.val()&&isInputValueValid(t,new RegExp(regs.lettersAndNumbers)),t.on("input",function(e){isInputValueValid(t,new RegExp(regs.lettersAndNumbers))});var n=e.find(".city-id").find("input");""!=n.val()&&void 0!=n.val()&&isInputValueValid(n,new RegExp(regs.letters)),n.on("input",function(e){isInputValueValid(n,new RegExp(regs.letters))});var i=e.find(".form-control.required");e.find('input[type = "radio"]');i.keyup(function(){checkRequiredFields(i,e.find(".btn-red.search"))});var a=document.getElementById("chat-button-online");null!=a&&(a.style.visibility="visible");var r=document.getElementById("chat-button-offline");null!=r&&(r.style.visibility="visible"),setCollapseBlockEvent()}function setEvents_fuelConsumption(){var e=$j(".step-content").find(".fuel-consumption").find(".pump").find("input");validatePumpInputValue(e,new RegExp(regs.numbers)),e.on("input",function(t){validatePumpInputValue(e,new RegExp(regs.numbers))}),e.change(function(){validatePumpInputValue(e,new RegExp(regs.numbers))}),e.on("mouseout",function(){validatePumpInputValue(e,new RegExp(regs.numbers))}),setCollapseBlockEvent()}function setEvents_creditLimit(){var e=$j(".step-content").find(".credit-line"),t=e.find(".credit-limit").find($j('[id$="creditLimitInput"]'));validateCreditLimitValue(t);var n=parseInt(e.find(".min-limit").html()),i=parseInt(e.find(".max-limit").html());createSlider("slider","creditLimitInput","idInputHidden",t.text(),n,i),0==$j("#slider").find(".slider-active-line").length&&$j("#slider").append('<div class="slider-active-line" style="width:0%"></div>'),colorSliderActiveLine(),t.unbind("DOMSubtreeModified"),t.bind("DOMSubtreeModified",function(){colorSliderActiveLine()}),$j("#slider").on("click mousemove mouseout mouseleave",function(){colorSliderActiveLine()}),setCollapseBlockEvent()}function setEvents_cardsOrder(){$j(".step-content").find(".cards-order");showCardsOrderNavigationTabs(),$j("#outsideSwitch input").change(function(){showInternationalTransactionInfo($j("#outsideSwitch input").is(":checked"))}),$j("#partnerSwitch input").change(function(){showFuelPartnerTransactionInfo($j("#partnerSwitch input").is(":checked"))});var e=$j(".cards-count .number-wrapper input");e.on("input",function(){showCardsOrderNavigationTabs();var t=parseInt($j(".cards-count .number-wrapper input").val());t<1?e.val(1).trigger("change"):t>50&&e.val(50).trigger("change")}),e.change(function(){showCardsOrderNavigationTabs()});var t=$j(".cards-categories .tab-content").find("#diffCards"),n=t.find(".onoffswitch.outside input"),i=t.find(".onoffswitch.partner input");n.change(function(){showInternationalTransactionInfo(isSwitchChecked(n))}),i.change(function(){showFuelPartnerTransactionInfo(isSwitchChecked(i))}),setCollapseBlockEvent()}function setEvents_specialOffers(){var e=$j(".special-offers .offer").find(".fav-station").find(".point"),t=$j(".special-offers .offer");e.unbind("DOMSubtreeModified"),e.bind("DOMSubtreeModified",function(){""!==favStationInfo&&t.find(".btn-red.my-station").attr("disabled",!1)}),setCollapseBlockEvent()}function setEvents_cardsTechnicalParams(){var e=$j(".step-content").find(".cards-tech-parameters"),t=e.find(".cards-list .card-item"),n=e.find(".btn-red.continue");counterLenCompanyName();var i=!1;t.find(".card-param-value input").on("input",function(){checkRequiredFields($j(this).closest(".card-item").find(".form-control.required"),e.find(".btn-red.save-params"));var a=$j(this),r=t.closest(".card-item").find(".card-owner-type").find('[id$="selectDriverNameOrCarNumber"]').attr("class");void 0!=r&&("car-number"===r.toLowerCase()&&(i=validateCarNumber(a,new RegExp(regs.carNumberFormat_DE))),"driver-name"===r.toLowerCase()&&(i=validateDriverName(a,new RegExp(regs.embossingLetters)))),i||n.attr("disabled",!0)}),t.find(".company-name input").on("input",function(){checkRequiredFields($j(this).closest(".card-item").find(".form-control.required"),e.find(".btn-red.save-params"));var t=$j(this);isInputValueValid(t,new RegExp(regs.embossingLettersAndNumbers))||n.attr("disabled",!0)}),setCollapseBlockEvent()}function setEvents_vatNumber(){var e=$j(".step-content").find(".enter-vat-id");e.find(".btn-red").attr("disabled",!0);var t=e.find(".vat-number").find("input");t.on("input",function(n){isInputValueValid(t,new RegExp(regs.vatIdFormat_DE)),isInputValueValid(t,new RegExp(regs.vatIdFormat_DE))?e.find(".btn-red").attr("disabled",!1):e.find(".btn-red").attr("disabled",!0)}),setCollapseBlockEvent()}function setEvents_taxNumber(){var e=$j(".step-content").find(".enter-tax-id");e.find(".btn-red").attr("disabled",!0);var t=e.find(".tax-number").find("input");t.on("input",function(n){validateTaxId(t,new RegExp(regs.numbers)),validateTaxId(t,new RegExp(regs.numbers))?e.find(".btn-red").attr("disabled",!1):e.find(".btn-red").attr("disabled",!0)}),setCollapseBlockEvent()}function setEvents_directDebit(){var e=$j(".step-content").find(".payment-direct-debit"),t=e.find(".account-holder").find("input");t.on("input",function(e){isInputValueValid(t,new RegExp(regs.letters))});var n=e.find(".iban").find("input");n.on("input",function(e){isInputValueValid(n,new RegExp(regs.ibanFormat_DE))});var i=e.find(".swift").find("input");i.on("input",function(e){isInputValueValid(i,new RegExp(regs.swiftFormat))});var a=e.find(".form-control.required"),r=e.find('input[type="checkbox"].form-check-input'),s=[];r.each(function(){$j(this).is(":checked")?s.push(!0):s.push(!1)}),-1!=s.indexOf(!1)&&e.find(".btn-red.continue").attr("disabled",!0),r.click(function(){s=[],r.each(function(){$j(this).is(":checked")?s.push(!0):s.push(!1)}),-1==s.indexOf(!1)?checkRequiredFields(a,e.find(".btn-red.continue")):e.find(".btn-red.continue").attr("disabled",!0)}),a.keyup(function(){-1==s.indexOf(!1)?checkRequiredFields(a,e.find(".btn-red.continue")):e.find(".btn-red.continue").attr("disabled",!0)}),setCollapseBlockEvent()}function setEvents_bankTransferDebit(){var e=$j(".step-content").find(".payment-bank-transfer"),t=e.find(".category-link"),n=e.find('input[type="checkbox"].form-check-input'),i=[];n.each(function(){$j(this).is(":checked")?i.push(!0):i.push(!1)}),validBankTransferForm(e,t,i),t.change(function(){i=[],n.each(function(){$j(this).is(":checked")?i.push(!0):i.push(!1)}),validBankTransferForm(e,t,i)}),n.click(function(){i=[],n.each(function(){$j(this).is(":checked")?i.push(!0):i.push(!1)}),validBankTransferForm(e,t,i)}),setCollapseBlockEvent()}function setEvents_directDebitDeposit(){var e=$j(".step-content").find(".direct-debit-deposit"),t=e.find(".category-link");validDirectDebitForm(e,t),t.change(function(){validDirectDebitForm(e,t)}),e.find('input[type="checkbox"]').click(function(){validDirectDebitForm(e,t)}),setCollapseBlockEvent()}function setEvents_bankTransferNoDeposit(){var e=$j(".step-content").find(".bank-transfer-no-deposit"),t=e.find('input[type="checkbox"].form-check-input'),n=[];t.each(function(){$j(this).is(":checked")?n.push(!0):n.push(!1)}),-1!=n.indexOf(!1)?e.find(".btn-red.continue").attr("disabled",!0):e.find(".btn-red.continue").attr("disabled",!1),t.click(function(){n=[],t.each(function(){$j(this).is(":checked")?n.push(!0):n.push(!1)}),-1!=n.indexOf(!1)?e.find(".btn-red.continue").attr("disabled",!0):e.find(".btn-red.continue").attr("disabled",!1)}),setCollapseBlockEvent()}function setChatOptions(){setupChatInit(),$j(document).on("keydown click",function(){resetInActive()}),resetInActive(),document.getElementById("liveAgentChatTextArea").onkeydown=function(e){if(13==e.keyCode)return updateOfflineChat(),!1};var e=new URL(window.location.href).searchParams.get("country");$j(".modal-open").bind("DOMSubtreeModified",function(){for(var t=document.getElementsByTagName("form"),n=0;n<t.length;n++)"frameChat"==t[n].target&&-1!=t[n].action.toString().indexOf("language%3D%23")&&(t[n].action=t[n].action.replace("language%3D","language%3D"+e))}),$j(".liveAgentSendButton").hide(),$j("#liveAgentChatTextArea").focus(function(e){$j(".liveAgentSendButton").is(":visible")||($j("#liveAgentChatLog").height($j("#liveAgentChatLog").height()-20),$j("#liveAgentChatTextArea").height($j("#liveAgentChatTextArea").height()+15),$j(".liveAgentSendButton").show())}),$j("#liveAgentChatTextArea").focusout(function(e){$j(e.relatedTarget).hasClass("liveAgentSendButton")?$j(".liveAgentSendButton").show():($j("#liveAgentChatLog").height($j("#liveAgentChatLog").height()+20),$j("#liveAgentChatTextArea").height($j("#liveAgentChatTextArea").height()-15),$j(".liveAgentSendButton").hide())}),$j(".liveAgentSendButton").on("click",function(){$j("#liveAgentChatTextArea").focus()})}function setupChatInitialization(e,t,n,i,a,r,s,d,o,c,l){"0"==o.toString()&&(document.getElementById("chat-button-online").style.visibility="hidden",document.getElementById("chat-button-offline").style.visibility="hidden"),liveagent.disconnect(),""!=r&&(liveagent.addCustomDetail("OpportunityID",r,!1).saveToTranscript("Opportunity__c"),liveagent.findOrCreate("Opportunity").map("ID","OpportunityID",!0,!0,!0).saveToTranscript("OpportunityId").showOnCreate(),liveagent.addCustomDetail("AccountID",s,!1).saveToTranscript("AccountID"),liveagent.findOrCreate("Account").map("ID","AccountID",!0,!0,!0).saveToTranscript("AccountId").showOnCreate()),""!=a&&(liveagent.addCustomDetail("ContactID",a,!1).saveToTranscript("ContactID"),liveagent.findOrCreate("Contact").map("ID","ContactID",!0,!0,!0).saveToTranscript("ContactId").showOnCreate()),liveagent.setName(d),liveagent.addCustomDetail("Step",c,!1).saveToTranscript("E2E_Step__c"),liveagent.addCustomDetail("Mode of initialization",l,!1).saveToTranscript("Mode_of_initialization__c"),liveagent.addCustomDetail("Type of chat","online",!1).saveToTranscript("Type__c");var u=new URL(window.location.href).searchParams.get("country");liveagent.addCustomDetail("Chat country",u,!1).saveToTranscript("Country__c"),liveagent.init(e,t,n),""!=i&&(window._laq||(window._laq=[]),window._laq.push(function(){liveagent.showWhenOnline(i,document.getElementById("chat-button-online")),liveagent.showWhenOffline(i,document.getElementById("chat-button-offline"))}))}function startOnlineChat(e,t,n,i,a,r,s,d,o,c,l,u){"automatical"==u?autoChatLastStep!=l&&(autoChatLastStep=l,delete liveagent,delete liveAgentDeployment,jQuery.loadScript(n,function(){executeOnlineChat(e,t,i,a,r,s,d,o,c,l,u)})):(delete liveagent,delete liveAgentDeployment,jQuery.loadScript(n,function(){executeOnlineChat(e,t,i,a,r,s,d,o,c,l,u)}))}function executeOnlineChat(e,t,n,i,a,r,s,d,o,c,l){if(null==document.getElementById("frameChat")&&"none"!=document.getElementById("chat-button-online").style.display){document.getElementById("chat-button-offline").style.visibility="hidden",document.getElementById("chat-button-online").style.visibility="hidden",setupChatInitialization(e,t,n,"",a,r,s,d,o,c,l);var u=document.createElement("iframe");u.id="frameChat",u.name="frameChat",u.classList.add("frameChat"),document.getElementById("chatOnlineBlock").appendChild(u),setTimeout(function(){try{liveagent.startChatWithWindow(i,"frameChat"),document.getElementById("chatOnlineBlock").classList.add("popup-on"),setOpportunityFlagChat(l)}catch(n){document.getElementById("chat-button-offline").style.visibility="visible",document.getElementById("chat-button-online").style.visibility="visible",document.getElementById("chatOnlineBlock").classList.remove("popup-on"),document.getElementById("frameChat").remove();for(var e=document.getElementsByTagName("form"),t=0;t<e.length;t++)"frameChat"==e[t].target&&e[t].remove()}},800)}}function resetInActive(){clearTimeout(chatActivityTimeout),chatActivityTimeout=setTimeout(inActive,6e4)}function inActive(){var e=document.getElementById("chat-button-online");"none"!=e.style.display&&"hidden"!=e.style.visibility&&(null!=document.getElementById("frameChat")||$j("#chatOfflineBlock").hasClass("popup-on")||setupOnlineAutoChat());resetInActive()}function setupOfflineChat(){document.getElementById("chat-button-offline").style.visibility="hidden",document.getElementById("chat-button-online").style.visibility="hidden";var e=document.getElementById("liveAgentChatLog");document.getElementById("chatOfflineBlock").classList.add("popup-on"),e.scrollTop=e.scrollHeight,chatOfflineOLDText="",chatOfflineUpdateTimeout=setTimeout(updateDatabaseOfflineChat,5e3)}function updateOfflineChat(){var e=document.getElementById("liveAgentChatTextArea");if(""!=e.value){var t=document.getElementById("liveAgentChatLogText"),n=new Date,i=n.getHours(),a=n.getMinutes(),r=i>=12?"PM":"AM",s=(i=(i%=12)||12)+":"+(a=a<10?"0"+a:a)+" "+r;t.innerHTML=t.innerHTML+'<span class="chat-client"> <span class="chat-name"> <strong>You </strong><span class="chat-customDateTime" style="display: inline"> '+s+' </span> </span> <span class="chat-messageText">'+e.value+"</span> <span>",e.value=""}(t=document.getElementById("liveAgentChatLog")).scrollTop=t.scrollHeight}function updateDatabaseOfflineChat(){var e=$j(".liveAgentChatLogText").html().split('<span class="chat-operator">').join('<br><span class="chat-operator">').split('<span class="chat-client">').join('<br><span class="chat-client">');e!=chatOfflineOLDText&&(chatOfflineOLDText=e,saveOfflineChat(e),setOpportunityFlagChat("manual")),clearTimeout(chatOfflineUpdateTimeout),chatOfflineUpdateTimeout=setTimeout(updateDatabaseOfflineChat,5e3)}function closeChat(e){if("online"==e){document.getElementById("chatOnlineBlock").classList.remove("popup-on"),document.getElementById("frameChat").remove();for(var t=document.getElementsByTagName("form"),n=0;n<t.length;n++)"frameChat"==t[n].target&&t[n].remove()}else"offline"==e&&document.getElementById("chatOfflineBlock").classList.remove("popup-on");document.getElementById("chat-button-offline").style.visibility="visible",document.getElementById("chat-button-online").style.visibility="visible",resetInActive()}function downloadSepaBlock(e){document.location.href=e}function changeFieldsInSepa(e,n,t,l){var a=document.getElementById(l),m=a.contentWindow||a.contentDocument;if(m.document){var r=(m=m.document).getElementById("frameAccountHolder");null!=r&&(r.innerHTML=e);var c=m.getElementById("frameSepaIBAN");null!=c&&(c.innerHTML=n);var d=m.getElementById("frameSepaSWIFT");null!=d&&(d.innerHTML=t)}}function increaseCreditLimit(){var e=parseInt($j("[id$=idInputHidden]").val());isNaN(e)||setNewCreditLimit(e+100)}function decreaseCreditLimit(){var e=parseInt($j("[id$=idInputHidden]").val());isNaN(e)||setNewCreditLimit(e-100)}function setNewCreditLimit(e){$j("[id$=idInputHidden]").val(e),$j("[id$=creditLimitInput]").text(e),$j("#slider").slider("values",[e]),colorSliderActiveLine(),recalculateDeposit()}$j(function(){onPageLoad(),onPageRender()}),$j(document).ready(function(){var e=$j(".step-content");displayVoucherLightbox=!0;var t=e.find(".contact-details");t.find(".btn-red").attr("disabled",!0);var n=t.find(".first-name").find("input");""!=n.val()&&void 0!=n.val()&&isInputValueValid(n,new RegExp(regs.letters));var i=t.find(".last-name").find("input");""!=i.val()&&void 0!=i.val()&&isInputValueValid(i,new RegExp(regs.letters));var a=t.find(".phone").find("input");a.inputmask({mask:"+4\\9999999999999",placeholder:""}),""!=a.val()&&void 0!=a.val()&&isInputValueValid(a,new RegExp(regs.phone));var r=t.find(".email").find("input");""!=r.val()&&void 0!=r.val()&&isInputValueValid(r,new RegExp(regs.email)),checkRequiredFields(t.find(".form-control.required"),t.find(".btn-red")),setEvents_contactDetails();var s=e.find(".credit-scoring");s.find(".btn-red").attr("disabled",!0),s.find(".btn-red.search").attr("disabled",!0);var d=s.find(".company").find("input");""!=d.val()&&void 0!=d.val()&&isInputValueValid(d,new RegExp(regs.lettersAndNumbers)),""!=(w=s.find(".tax-id").find("input")).val()&&void 0!=w.val()&&validateTaxId(w,new RegExp(regs.numbers));var o=s.find(".city-id").find("input");""!=o.val()&&void 0!=o.val()&&isInputValueValid(o,new RegExp(regs.letters));var c=s.find(".form-control.required");checkRequiredFields(c,s.find(".btn-red.search")),isRadioButtonSelected(s.find('input[type = "radio"]'))&&checkRequiredFields(c,s.find(".btn-red.continue")),setEvents_companyDetails();var l=e.find(".fuel-consumption");l.find(".btn-red").attr("disabled",!0);var u=l.find(".pump").find("input");""!=u.val()&&void 0!=u.val()&&validatePumpInputValue(u,new RegExp(regs.numbers)),setEvents_fuelConsumption();var f=e.find(".credit-line");f.find(".form-control.required");validateCreditLimitValue(f.find(".credit-limit").find($j('[id$="creditLimit"]'))),setEvents_creditLimit();e.find(".cards-order");showCardsOrderNavigationTabs(),showInternationalTransactionInfo($j("#outsideSwitch input").is(":checked")),showFuelPartnerTransactionInfo($j("#partnerSwitch input").is(":checked"));var p=$j(".cards-categories .tab-content").find("#diffCards");showInternationalTransactionInfo(isSwitchChecked(p.find(".onoffswitch.outside input"))),showFuelPartnerTransactionInfo(isSwitchChecked(p.find(".onoffswitch.partner input"))),setEvents_cardsOrder(),$j(".special-offers .offer").find(".btn-red.my-station").attr("disabled",!0),setEvents_specialOffers(),window.addEventListener("message",function(e){if(~e.origin.indexOf(dataSource)){var t=$j(".locator-error-message1"),n=$j(".locator-error-message2");if(n.hide(),t.hide(),e.data.id)return favStationInfo=e.data.townName.toLowerCase()+", "+e.data.address.toLowerCase(),void $j("<span>"+favStationInfo+"</span>").insertBefore(".special-offers .offer .fav-station .edit");e.data.error!==errors[0]?0!=e.data.numberOfPoints||t.show():n.show()}});var m=e.find(".cards-tech-parameters");m.find(".btn-red.save-params").attr("disabled",!0);var v=m.find(".cards-list .card-item"),h=v.find(".card-owner-type input.selected").val();void 0!=h&&("driver name"===h.toLowerCase()?switchingToDriverName():switchingToCarNumber()),v.each(function(){var e=v.closest(".card-item").find(".card-owner-type").find('[id$="selectDriverNameOrCarNumber"]').attr("class"),t=v.find(".card-param-value input");""!=t.val()&&void 0!=t.val()&&void 0!=e&&("car-number"===e.toLowerCase()&&validateCarNumber(t,new RegExp(regs.carNumberFormat_DE)),"driver-name"===e.toLowerCase()&&validateDriverName(t,new RegExp(regs.embossingLetters)));var n=v.find(".company-name input");""!=n.val()&&void 0!=n.val()&&isInputValueValid(n,new RegExp(regs.embossingLettersAndNumbers))});var g=e.find(".enter-vat-id");g.find(".btn-red").attr("disabled",!0);var b=g.find(".vat-number").find("input");""!=b.val()&&void 0!=b.val()&&isInputValueValid(b,new RegExp(regs.vatIdFormat_DE)),setEvents_vatNumber();var w,C=e.find(".enter-tax-id");C.find(".btn-red").attr("disabled",!0),""!=(w=C.find(".tax-number").find("input")).val()&&void 0!=w.val()&&isInputValueValid(w,new RegExp(regs.numbers)),setEvents_taxNumber(),counterLenCompanyName(),setEvents_cardsTechnicalParams();var y=e.find(".payment-direct-debit");y.find(".btn-red.continue").attr("disabled",!0);var $=y.find(".account-holder").find("input");""!=$.val()&&void 0!=$.val()&&isInputValueValid($,new RegExp(regs.letters));var E=y.find(".iban").find("input");""!=E.val()&&void 0!=E.val()&&isInputValueValid(E,new RegExp(regs.ibanFormat_DE));var I=y.find(".swift").find("input");""!=I.val()&&void 0!=I.val()&&isInputValueValid(I,new RegExp(regs.swiftFormat)),checkRequiredFields(y.find(".form-control.required"),y.find(".btn-red.continue")),setEvents_directDebit(),e.find(".payment-bank-transfer").find(".btn-red.continue").attr("disabled",!0),setEvents_bankTransferDebit();var j=e.find(".direct-debit-deposit");j.find(".btn-red").attr("disabled",!0),validDirectDebitForm(j,j.find(".category-link")),setEvents_directDebitDeposit(),e.find(".bank-transfer-no-deposit").find(".btn-red.continue").attr("disabled",!0),setEvents_bankTransferNoDeposit(),setChatOptions()}),jQuery.loadScript=function(e,t){jQuery.ajax({url:e,dataType:"script",success:t,async:!0})};
