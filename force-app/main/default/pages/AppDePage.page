<apex:page standardStylesheets="false" sidebar="false" showHeader="false" controller="AppDeController" applyHtmlTag="false">
    <html>

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <title>Fleetcor</title>
        <meta name="description" content="Fleetcor upgrade" />
        <apex:stylesheet value="{!$Resource.reset}" />
        <apex:includeLightning />
    </head>

    <body>
        <div id="app"></div>
        <script>
            $Lightning.use("c:appTemplate", function () {
                $Lightning.createComponent("c:templateWrapperDe",
                    {
                        step: "{!state['step']}",
                        source: "{!state['source']}"
                    },
                    "app"
                );
            });

            window.addEventListener('cookie',setCookie);

            function setCookie(event) {
                var value = event.detail;
                console.log('value',value);
                var name = 'apex__source';
                var props = {};
                var exp = 60 * 60 * 24 * 365; // 1 year;

                if (typeof exp == "number" && exp) {
                    var d = new Date();
                    d.setTime(d.getTime() + exp * 1000);
                    exp = props.expires = d;
                }

                if (exp && exp.toUTCString) {
                    props.expires = exp.toUTCString();
                }

                value = encodeURIComponent(value);
                var updatedCookie = name + "=" + value + "; path=/";

                // for (var propName in props) {
                //     updatedCookie += "; " + propName;
                //     var propValue = props[propName];
                //     if (propValue !== true) {
                //         updatedCookie += "=" + propValue;
                //     }
                // }

                document.cookie = updatedCookie;
            }
        </script>
    </body>

    </html>
</apex:page>