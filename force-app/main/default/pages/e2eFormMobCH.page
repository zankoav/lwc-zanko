<apex:page language="en-US" id="e2eformmob" controller="LongFormMobileCHController" docType="html-5.0" action="{! init }" sidebar="false" showHeader="false" standardStylesheets="false" cache="false">
    <apex:form id="form" styleClass="form-horizontal">
        <head>
            <!-- PRODUCTION GTM -->
            <apex:outputPanel rendered="{! CONTAINS($CurrentPage.URL,'online.fleetcor.de')  }">
                <!-- Google Tag Manager -->
                <script>
                    (function(w,d,s,l,i){
                        w[l]=w[l] || []; w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
                        var f=d.getElementsByTagName(s)[0],
                        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';
                        j.async=true;
                        j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
                        f.parentNode.insertBefore(j,f);
                    })
                    (window,document,'script','dataLayer','GTM-TTBL98H');
                </script>
                <!-- End Google Tag Manager -->
            </apex:outputPanel>

            <!-- SANDBOX GTM -->
            <apex:outputPanel rendered="{! NOT(CONTAINS($CurrentPage.URL,'online.fleetcor.de')) }">
                <!-- Google Tag Manager after head -->
                <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
                })(window,document,'script','dataLayer','GTM-5V5GWZ9');</script>
                <!-- End Google Tag Manager -->
            </apex:outputPanel>
            <apex:includeScript value="{!$Resource.jQuery}"/>
            <apex:stylesheet value="{! URLFOR($Resource.jQueryUI,'jquery-ui-1.12.1/jquery-ui.css') }"/>
            <apex:includeScript value="{!$Resource.jqueryInputMask}"/>
            <apex:includeScript value="{!$Resource.e2e_scripts_ch_mobile}"/>
            <apex:includeScript value="{!$Resource.E2E_Analytics_CH_Mobile}"/>
            <apex:includeScript value="{!URLFOR($Resource.bootstrap_3_3_7,'bootstrap-3.3.7/js/bootstrap.min.js')}"/>
            <apex:stylesheet value="{!URLFOR($Resource.bootstrap_3_3_7,'bootstrap-3.3.7/css/bootstrap.min.css')}"/>
            <apex:stylesheet value="{!$Resource.e2e_style_ch_desktop}"/>
            <apex:stylesheet value="{!$Resource.e2e_style_ch_mobile}"/>
            <apex:stylesheet value="{!URLFOR($Resource.E2ESpinner, 'spinner.css')}"/>
            <apex:outputPanel id="lazyLoadId">
                <script>
                    function lazyLoadScripts() {
                        if ('{! activeStep }' != '' && '{! activeStep }' != '0') {
                            // slider
                            $j.getScript("{! URLFOR($Resource.jQueryUI,'jquery-ui-1.12.1/jquery-ui.js') }", function() {
                                $j.getScript("{!$Resource.jqueryUiTtouch}", function() {
                                    createSlider('slider', 'creditLimitInput', 'idInputHidden', 100, 100, 600);                                    
                                    setEvents_slider();
                                });    
                            });

                            // chat
                            $j.getScript("{!URLFOR($Resource.e2eLiveAgentDeployment)}", function() {
                                setChatOptions();
                            });
                        }  
                    }
                </script> 
            </apex:outputPanel>
            <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
            <link rel="shortcut icon" href="{!$Resource.FleetcorFavicon}" type="image/x-icon;"/>
            <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet"/>
            <title>Kunde werden und Tankkarten beantragen</title>
            <style type="text/css">
                .i-error {
                    display: inline-block;
                    margin-right: 5px;
                    vertical-align: top;
                    font-family: 'Montserrat';
                    width: 16px;
                    height: 16px;
                    font-weight: 500;
                    line-height: 15px;
                    text-align: center;
                    border-radius: 100%;
                    cursor: default;
                    font-size: 10px;
                    border: 1px solid #EE3A43;
                    color: #EE3A43;
                    opacity: 0.8;
                    text-decoration: none;
                }

                .invalidcards-feedback {
                    display: block;
                    margin-top: .5rem;
                    font-size: 12px;
                    color: #EE3A43;
                }

                .loadingField {
                    ground-color: #ffffff;
                    background-image: url({!URLFOR($Resource.E2ESpinner, 'field-spinner.gif')}) !important;
                    background-size: 15px 15px;
                    background-position: 90% center;
                    background-repeat: no-repeat;
                }

                .splashStatus .circle {
                    width: 60px;
                    margin: 0 auto;
                    margin-left: -40px;
                }

                .block-expand {
                    cursor: pointer;
                    width: 10px;
                    height: 12px;
                    background: url({!URLFOR($Resource.e2e_images, 'down.png')}) no-repeat;
                    float: right;
                    margin: 10px 10px;
                }

                .block-collapse {
                    cursor: pointer;
                    width: 10px;
                    height: 12px;
                    background: url({!URLFOR($Resource.e2e_images, 'up.png')}) no-repeat;
                    float: right;
                    margin: 10px 10px;
                }

                @media screen and (max-width: 1367px) {
                    .wrapper-collapsed .collapse-block .block-collapse,
                    .special-offers .block-collapse,
                    .congratulations .block-collapse,
                    .blue-block .block-collapse {
                        float: unset;
                        margin: 0 0 -5px 8px;
                        background: url({!URLFOR($Resource.e2e_images, 'collapse-arrow.png')}) no-repeat;
                    }

                    .wrapper-collapsed .collapse-block .block-expand,
                    .special-offers .block-expand,
                    .congratulations .block-expand,
                    .blue-block .block-expand {
                        float: unset;
                        margin: 0 0 -5px 8px;
                        background: url({!URLFOR($Resource.e2e_images, 'expend-arrow.png')}) no-repeat;
                    }

                    .m-help-info .block-expand,
                    .m-help-info .block-collapse {
                        margin: 8px 7px 10px 0px;
                    }

                    .credit-scoring .block-expand {
                        margin: 15px 10px;
                    }

                    .credit-scoring .block-collapse {
                        margin: 15px 10px;
                    }
                }

                .checkbox label::after {
                    display: inline-block;
                    position: absolute;
                    width: 16px;
                    height: 16px;
                    left: 0;
                    top: 3px;
                    margin-left: -20px;
                    color: #555555;
                    -webkit-transform: unset;
                    -ms-transform: unset;
                    transform: unset;
                }

                .checkbox input[type="checkbox"]:checked + label::after{
                    content: "";
                    background: url({!URLFOR($Resource.e2e_images, 'check.png')});
                }

                .radio input[type="radio"]:checked + label::after {
                    content: "";
                    padding-left: 5px;
                    font-size: 11px;
                    -webkit-transform: scale(1, 1);
                    -ms-transform: scale(1, 1);
                    -o-transform: scale(1, 1);
                    transform: scale(1, 1);
                    -webkit-transform: unset;
                    -ms-transform: unset;
                    transform: unset;
                    background: url({!URLFOR($Resource.e2e_images, 'check-circle.png')});
                }

                .cards-list .card-item .delete a {
                    height: 24px;
                    width: 40px;
                    cursor: pointer;
                    display: inline-block;
                    background: url({!URLFOR($Resource.e2e_images, 'basket.png')}) no-repeat;
                }

                .cards-tech-parameters .card-badge {
                    width: 230px;
                    height: 145px;
                    display: inline-block;
                    margin: 35px 30px 5px 45px;
                    background: url({!URLFOR($Resource.e2e_images, 'card.png')}) no-repeat;
                }

                .modal-header .close {
                    width: 15px;
                    height: 15px;
                    color: #3F536E;
                    opacity: 1;
                    background: url({!URLFOR($Resource.e2e_images, 'close.png')}) no-repeat;
                }

                @media screen {
                /* Hide the special layer from the screen. */
                    #paymentInformation { display: none; }
                }

                /* Mobile */
                @media screen and (max-width: 1367px) {
                   .nav-gray .navbar-toggle.collapsed .collapse-bar {
                       margin: 3px 3px;
                       width: 16px;
                       height: 16px;
                       background: url({!URLFOR($Resource.e2e_images, 'nav-open.png')}) no-repeat;
                   }

                   .nav-gray .navbar-toggle .collapse-bar {
                       margin: 2px 4px;
                       width: 16px;
                       height: 16px;
                       background: url({!URLFOR($Resource.e2e_images, 'nav-close.png')}) no-repeat;
                   }
                }

                .category-link {
                    font-family: 'Montserrat';
                    font-style: normal;
                    font-weight: 500;
                    line-height: 18px;
                    font-size: 15px;
                    width: 105%;
                    margin: 15px 0 5px 0px;
                    word-break: break-word;
                    display: inline-block;
                    position: relative;
                    padding-left: 5px;
                    color: #333 !important;
                }

                .category-link:before {
                    content: "";
                    display: inline-block;
                    position: absolute;
                    width: 18px;
                    height: 18px;
                    left: 0;
                    margin-left: -20px;
                    border-radius: 50%;
                    -webkit-transition: border 0.15s ease-in-out;
                    -o-transition: border 0.15s ease-in-out;
                    transition: border 0.15s ease-in-out;
                    background: rgba(0, 0, 0, 0.0001);
                    border: 2px solid rgba(0, 0, 0, 0.26);
                    box-sizing: border-box;
                }

                .category-link:after {
                    display: inline-block;
                    position: absolute;
                    content: "";
                    width: 18px;
                    height: 18px;
                    left: 3px;
                    top: 0;
                    margin-left: -23px;
                    border-radius: 100%;
                    background-color: #555555;
                    -webkit-transform: scale(0, 0);
                    -ms-transform: scale(0, 0);
                    -o-transform: scale(0, 0);
                    transform: scale(0, 0);
                    -webkit-transition: -webkit-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
                    -moz-transition: -moz-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
                    -o-transition: -o-transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
                    transition: transform 0.1s cubic-bezier(0.8, -0.33, 0.2, 1.33);
                }

                .category-link.active:before {
                    border-color: #d9534f;
                    content: "";
                    display: inline-block;
                    position: absolute;
                    width: 18px;
                    height: 18px;
                    left: 0;
                    margin-left: -20px;
                    border-radius: 50%;
                    -webkit-transition: border 0.15s ease-in-out;
                    -o-transition: border 0.15s ease-in-out;
                    transition: border 0.15s ease-in-out;
                    background: rgba(0, 0, 0, 0.0001);
                    border: 2px solid rgba(0, 0, 0, 0.26);
                    box-sizing: border-box;
                }

                .category-link.active:after {
                    content: "";
                    background: url({!URLFOR($Resource.e2e_images, 'check-circle.png')});
                    -webkit-transform: scale(1, 1);
                    -ms-transform: scale(1, 1);
                    -o-transform: scale(1, 1);
                    transform: scale(1, 1);
                    -webkit-transform: unset;
                    -ms-transform: unset;
                    transform: unset;
                }

                .chat-header .close {
                    width: 15px;
                    height: 15px;
                    color: #3F536E;
                    opacity: 1;
                    margin: 7px 5px 5px 0;
                    background: url({!URLFOR($Resource.e2e_images, 'close.png')}) no-repeat;
                }

                .lightbox {
                    z-index: 1100;
                    opacity: 0.85;
                }

                .limit-info {
                    color: #7F7F7F;
                }

                .popover{
                    max-width: 100%;
                }

                .popover-title {
                    float: right;
                    display: inline-block;
                    border: 0;
                }

                @media (min-width: 1367px) {
                    .hidden-lgxl {
                        display: none!important;
                    }
                }
            </style>
        </head>
        <body class="modal-open" style="overflow: auto">
            <!-- PRODUCTION GTM -->
            <apex:outputPanel rendered="{! CONTAINS($CurrentPage.URL,'online.fleetcor.de')  }">
                <!-- Google Tag Manager (noscript) -->
                <noscript>
                    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TTBL98H" height="0" width="0"></iframe>
                </noscript>
                <!-- End Google Tag Manager (noscript)-->
            </apex:outputPanel>

            <!-- SANDBOX GTM -->
            <apex:outputPanel rendered="{! NOT(CONTAINS($CurrentPage.URL,'online.fleetcor.de')) }">
                <!-- Google Tag Manager (noscript) after body -->
                <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5V5GWZ9" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
                <!-- End Google Tag Manager (noscript)-->
            </apex:outputPanel>
            <main>
                <apex:actionStatus id="splashStatus" onstart="startSplash();" onstop="endSplash(); "/>
                <div class="splashStatus" id="splashDiv">
                    <div class="circle"><img src="{!URLFOR($Resource.e2e_images, 'preloader-loop.gif')}"/></div>
                </div>
                <apex:outputPanel id="onlineChatBlock">
                    <script>
                        function setupOnlineChat(){
                           startOnlineChat('{!chatURL}','{!chatDeploymentId}','{!chatDeploymentJsURL}','{!$Organization.Id}'.slice(0,-3),'{!chatButtonId}',
                                                       '{!contact.Id}'.slice(0,-3),'{!opportunity.Id}'.slice(0,-3),'{!opportunity.AccountId}'.slice(0,-3),
                                                       '{!chatFirstMessage}','{!activeStep}','{!activeSubStep}','manual');
                           return false;
                        }

                        function setupOnlineAutoChat(){
                           startOnlineChat('{!chatURL}','{!chatDeploymentId}','{!chatDeploymentJsURL}','{!$Organization.Id}'.slice(0,-3),'{!chatButtonId}',
                                                       '{!contact.Id}'.slice(0,-3),'{!opportunity.Id}'.slice(0,-3),'{!opportunity.AccountId}'.slice(0,-3),
                                                       '{!chatFirstMessage}','{!activeStep}','{!activeSubStep}','automatical');
                           return false;
                        }

                        function executeSetOpportunityFlagChat(modeOfChat){
                            setOpportunityFlagChat('{!opportunity.Id}', '{!activeStep}', '{!activeSubStep}', modeOfChat);
                        }

                        function executeSaveOfflineChat(offlineChatBody){
                            saveOfflineChat('{!opportunity.Id}','{!contact.Id}', '{!activeStep}', '{!activeSubStep}', offlineChatBody);
                        }

                        </script>
                </apex:outputPanel>
                     <script>
                        function setOpportunityFlagChat(oppId, activeStep, activeSubStep, modeOfChat){
                            Visualforce.remoting.Manager.invokeAction(
                                '{!$RemoteAction.LongFormMobileCHController.setFlagChatToOpportunity}',
                                oppId, activeStep, activeSubStep, modeOfChat,
                                function(result, event){
                                     if (event.status) {

                                    } else if (event.type === 'exception') {
                                        console.debug(event.message + "<br/>\n<pre>" + event.where + "</pre>");
                                    } else {
                                        console.debug(document.getElementById("responseErrors").innerHTML = event.message);
                                    }
                                }
                            );
                        }

                         function saveOfflineChat(oppId, conId, activeStep, activeSubStep, offlineChatBody){
                            var country = getCountryParameter();
                            Visualforce.remoting.Manager.invokeAction(
                                '{!$RemoteAction.LongFormMobileCHController.saveOfflineChatLog}',
                                 oppId, conId, activeStep, activeSubStep, offlineChatBody, country,
                                 function(result, event){
                                     if (event.status) {

                                    } else if (event.type === 'exception') {
                                        console.debug(event.message + "<br/>\n<pre>" + event.where + "</pre>");
                                    } else {
                                        console.debug(event.message);
                                    }
                                }
                            );
                        }
                    </script>
                <apex:actionFunction id="setupChatInit" name="setupChatInit"
                                     onComplete="setupChatInitialization('{!chatURL}','{!chatDeploymentId}','{!$Organization.Id}'.slice(0,-3),
                                         '{!chatButtonId}','','','','','{!activeStep}','{!activeSubStep}','');" reRender="setupChatInit" />

                <apex:actionFunction id="viewportInit" name="viewportInit"
                                     onComplete="goToActiveViewport('{!activeStep}', '{!activeSubStep}');"/>

                <span id="top-heading-viewport"></span>
                <div class="container hidden-lgxl">
                    <apex:outputPanel id="pageHeader">
                        <apex:outputPanel layout="block" rendered="{! activeSubstep != 'Congratulations' }">
                            <div class="row">
                                <nav class="navbar nav-gray">
                                    <div class="container-fluid">
                                        <div class="navbar-header">
                                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
                                                <div class="collapse-bar"></div>
                                            </button>
                                            <div class="b-page-logo">
                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'm-logo.png')}"/>
                                            </div>
                                        </div>
                                        <div class="collapse navbar-collapse" id="navbar">
                                            <ul class="nav navbar-nav menu">
                                                <li class="expanded">
                                                    <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['TOP HEADING URL'].Value__c }">
                                                        {! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['TOP HEADING'].Value__c }
                                                    </a>
                                                    <ul class="nav-list">
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 1'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 1 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 2'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 2 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 3'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 3 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 4'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 1']['URL 4 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li class="expanded">
                                                    <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['TOP HEADING URL'].Value__c }">
                                                        {! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['TOP HEADING'].Value__c }
                                                    </a>
                                                    <apex:outputPanel rendered="{! countryParam = 'chde' }">
                                                        <ul class="nav-list">
                                                            <li class="nav-item">
                                                                <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['URL 1'].Value__c }">
                                                                    {! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['URL 1 LABEL'].Value__c }
                                                                </a>
                                                            </li>
                                                            <li class="nav-item">
                                                                <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['URL 2'].Value__c }">
                                                                    {! stepPagesMap['HEADER'].elements['INFO BLOCK 2']['URL 2 LABEL'].Value__c }
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </apex:outputPanel>
                                                </li>
                                                <li class="expanded">
                                                    <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['TOP HEADING URL'].Value__c }">
                                                        {! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['TOP HEADING'].Value__c }
                                                    </a>
                                                    <ul class="nav-list">
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['URL 1'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['URL 1 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['URL 2'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 3']['URL 2 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li class="expanded">
                                                    <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['TOP HEADING URL'].Value__c }">
                                                        {! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['TOP HEADING'].Value__c }
                                                    </a>
                                                    <ul class="nav-list">
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 1'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 1 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 2'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 2 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                        <li class="nav-item">
                                                            <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 3'].Value__c }">
                                                                {! stepPagesMap['HEADER'].elements['INFO BLOCK 4']['URL 3 LABEL'].Value__c }
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </li>
                                                <li class="expanded">
                                                    <a href="{! stepPagesMap['HEADER'].elements['INFO BLOCK 5']['TOP HEADING URL'].Value__c }">
                                                        {! stepPagesMap['HEADER'].elements['INFO BLOCK 5']['TOP HEADING'].Value__c }
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                            <div class="row">
                                <div class="b-page-header">
                                    {! stepPagesMap['HEADER'].elements['TOP HEADING']['VALUE'].Value__c }
                                </div>
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>

                    <div class="b-block-form">
                        <div class="row">
                            <!-- START PAGE -->
                            <span id="get-started-viewport"></span>
                            <apex:outputPanel layout="block" id="startPage">
                                <apex:outputPanel layout="block" styleClass="col-xs-12 col-sm-12" rendered="{! AND(activeStep = 0, activeSubstep = 'Get started') }">
                                    <apex:outputPanel layout="block" styleClass="details-content">
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-12">
                                                <div class="b-what-need">
                                                    <apex:outputPanel layout="block" styleClass="b-col-header">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['TOP HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <ul class="need-list font-13">
                                                        <li>
                                                            <apex:outputPanel styleClass="point-list">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 1'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="point">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 1 VALUE'].Value__c }
                                                            </apex:outputPanel>
                                                        </li>
                                                        <li>
                                                            <apex:outputPanel styleClass="point-list">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 2'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="point">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 2 VALUE'].Value__c }
                                                            </apex:outputPanel>
                                                        </li>
                                                        <li>
                                                            <apex:outputPanel styleClass="point-list">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 3'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="point">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['ITEM 3 VALUE'].Value__c }
                                                            </apex:outputPanel>
                                                        </li>
                                                    </ul>
                                                    <div class="b-splitter" style="margin: 16px 0px 8px 0;"></div>
                                                    <apex:outputPanel styleClass="warn">
                                                        <apex:image url="{!URLFOR($Resource.e2e_images, 'warn.png')}" style="vertical-align: top; padding-top: 4px;"/>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="font-13 warn-msg">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['ONLINE ORDER REQUIREMENTS']['REMARK'].Value__c }
                                                    </apex:outputPanel>
                                                    <div class="row">
                                                        <div class="m-buttons center-block text-center">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <apex:commandButton value="{! stepPagesMap['CONTACT DETAILS'].elements['GET STARTED BUTTON']['VALUE'].Value__c }"
                                                                                    action="{! getStarted }"
                                                                                    reRender="formBlock, startPage, additionInfo, stepList, onlineChatBlock"
                                                                                    onComplete="setEvents_contactDetails();"
                                                                                    styleClass="btn btn-red"
                                                                                    status="splashStatus"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                            </apex:outputPanel>

                            <!-- LEFT BLOCK -->
                            <div class="col-xs-12 col-sm-12">
                                <apex:outputPanel layout="block" styleClass="step-content" id="formBlock">
                                    <apex:outputPanel id="collapsedBlock"
                                        rendered="{! AND(
                                            activeStep != 5,
                                            activeSubStep != 'Too many reports',
                                            activeSubStep != 'Too high limit',
                                            activeSubStep != 'Company not found',
                                            activeSubStep != 'Private entity',
                                            activeSubStep != 'Authorization not granted',
                                            activeSubStep != 'Already in process',
                                            activeSubStep != 'Already a customer',
                                            activeSubStep != 'Black list',
                                            activeSubStep != 'System error'
                                        ) }" styleClass="ym-hide-content">
                                        <!-- COLLAPSED CONTACT DETAILS -->
                                        <apex:outputPanel layout="block" id="contactDetailsCollapsed" styleClass="contact-details-collapsed ym-hide-content" rendered="{! AND(activeStep != null, activeStep > 0) }">
                                            <div class="wrapper-collapsed">
                                                <div class="row">
                                                    <div class="col-xs-10 col-sm-10">
                                                        <div class="b-step">
                                                            <apex:outputPanel layout="block" styleClass="b-step-header">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/>
                                                                {! menuItemsMap[1].Step_Name__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="b-step-details">
                                                                {! contact.Salutation } {! contact.FirstName } {! contact.LastName }, {! contact.Email }, {! contact.Phone }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2 col-sm-2">
                                                        <apex:outputPanel styleClass="edit">
                                                            <apex:commandLink action="{! editContactDetails }"
                                                                oncomplete="toViewport('contact-details-viewport'); setEvents_contactDetails(); onPageRender();"
                                                                styleClass="font-11"
                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <!-- COLLAPSED COMPANY DETAILS -->
                                        <apex:outputPanel layout="block" id="companyDetailsCollapsed" styleClass="company-details-collapsed" rendered="{! AND(activeStep > 0, activeSubstep != 'Search company', activeSubstep != 'Enter Tax ID', activeSubstep != 'Set total consumption') }">
                                            <div style="background: #e0eded;">
                                                <div class="b-steps-splitter"></div>
                                            </div>
                                            <div class="wrapper-collapsed">
                                                <div class="row">
                                                    <div class="col-xs-10 col-sm-10">
                                                        <div class="b-step">
                                                            <apex:outputPanel layout="block" styleClass="b-step-header">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/>
                                                                {! menuItemsMap[2].Step_Name__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2 col-sm-2">
                                                        <apex:outputPanel styleClass="edit">
                                                            <apex:commandLink action="{! editCompanyDetails }"
                                                                oncomplete="toViewport('order-details-viewport'); setEvents_companyDetails(); onPageRender();isCompanyDetails = true;analytics_SearchCompanyOnLoad();"
                                                                styleClass="font-11"
                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="b-step-details">
                                                            {! selectedCompany.name }, {! selectedCompany.street } {! selectedCompany.housenumber }{! IF(selectedCompany.postcode != null, ', ' +
                                                            selectedCompany.postcode, '') }{! IF(selectedCompany.city != null, ', ' +
                                                            selectedCompany.city, '') }{! IF(selectedCompany.country != null, ', ' +
                                                            selectedCompany.country, '') }
                                                            <apex:outputPanel layout="block" styleClass="info">
                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['COMPANY INFO']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                            {! stepPagesMap['ORDER DETAIL BLOCK'].elements['PROGNOSED CONSUMPTION']['LABEL'].Value__c }: {! opportunity.Total_consumption_l_month__c } {! stepPagesMap['ORDER DETAIL BLOCK'].elements['PROGNOSED CONSUMPTION']['UNIT'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <!-- COLLAPSED CREDIT LINE -->
                                        <apex:outputPanel layout="block" id="creditLineCollapsed" styleClass="credit-line-collapsed" rendered="{! activeStep > 1 }">
                                            <div style="background: #e0eded;">
                                                <div class="b-steps-splitter"></div>
                                            </div>
                                            <div class="wrapper-collapsed">
                                                <div class="row">
                                                    <div class="col-xs-10 col-sm-10">
                                                        <div class="b-step">
                                                            <apex:outputPanel layout="block" styleClass="b-step-header">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/>
                                                                {! menuItemsMap[3].Step_Name__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2 col-sm-2">
                                                        <apex:outputPanel styleClass="edit">
                                                            <apex:commandLink action="{! editCreditScoreData }"
                                                                oncomplete="toViewport('order-details-viewport'); setEvents_creditLimit(); setEvents_slider(); onPageRender();"
                                                                styleClass="font-11"
                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="b-step-details">
                                                            {! opportunity.CF_Credit_Limit__c } {! stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['UNIT'].Value__c },<br/>
                                                            <apex:outputPanel rendered="{! AND(opportunity.Security_Amount_To_Pay__c != 0, opportunity.Security_Amount_To_Pay__c != null)  }">
                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['DEPOSIT REQUIRED LABEL'].Value__c } {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['UNIT'].Value__c }<br/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! OR(opportunity.Security_Amount_To_Pay__c = 0, opportunity.Security_Amount_To_Pay__c = null) }">
                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['REMARK NOT REQUIRED DEPOSIT'].Value__c },<br/>
                                                            </apex:outputPanel>
                                                                {! IF(opportunity.Zahlungsart__c = 'Lastschrift', stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['DIRECT DEBIT'].Value__c,
                                                                    IF(opportunity.Zahlungsart__c = 'Bank√ºberweisung', stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['BANK TRANSFER'].Value__c, '')) },

                                                                {! IF(opportunity.Rechnungsperiode__c = '7', stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['WEEKLY INVOICES'].Value__c,
                                                                    IF(opportunity.Rechnungsperiode__c = '15', stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['BI-WEEKLY INVOICES'].Value__c,
                                                                        IF(opportunity.Rechnungsperiode__c = '30', stepPagesMap['ORDER DETAIL BLOCK'].elements['CREDIT SCORE RESULT']['MONTHLY INVOICES'].Value__c, ''))) }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <!-- COLLAPSED CARDS CONFIGURATIONS -->
                                        <apex:outputPanel layout="block" id="cardConfigurationCollapsed" styleClass="card-configuration-collapsed" rendered="{! AND(activeStep > 1, activeSubstep != 'Card configuration', activeSubstep != 'Technical parameters') }">
                                            <div class="b-steps-splitter"></div>
                                            <div class="wrapper-collapsed">
                                                <div class="row">
                                                    <div class="col-xs-10 col-sm-10">
                                                        <div class="b-step">
                                                            <apex:outputPanel layout="block" styleClass="b-step-header">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/>
                                                                {! menuItemsMap[4].Step_Name__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2 col-sm-2">
                                                        <apex:outputPanel styleClass="edit">
                                                            <apex:commandLink action="{! editCardConfiguration }"
                                                                oncomplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                styleClass="font-11"
                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="b-step-details">
                                                            {! numberOfCards } {! IF(numberOfCards > 1, stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['-CARDS-'].Value__c, stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['-CARD-'].Value__c) }
                                                        </apex:outputPanel>
                                                        <div class="collapse-block">
                                                            <div class="link" data-toggle="collapse" data-target="#feesAndCostsTop">
                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['MORE DETAILS'].Value__c }<div class="expander block-expand inline-block"></div>
                                                            </div>
                                                            <div class="row collapse" id="feesAndCostsTop">
                                                                <div class="inner-block">
                                                                    <apex:repeat value="{! costsColumnsMap['1'] }" var="costItem">
                                                                        <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                            <apex:outputPanel layout="block" styleClass="item" style="{! costItem.style }">
                                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block">
                                                                                    {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentName].Value__c }
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                    {! costItem.costValue } {! costItem.costTariff }
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="f-desc">
                                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['-PER-'].Value__c } {! numberOfCards } {! IF(numberOfCards = 1, stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['-CARD-'].Value__c, stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['-CARDS-'].Value__c) }
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </apex:repeat>


                                                                    <apex:outputPanel layout="block" styleClass="fee-national-header">
                                                                        <apex:outputPanel layout="block">
                                                                            {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['NATIONAL HEADING'].Value__c }
                                                                            <div class="i-helper inline-block"
                                                                                data-content="{! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['NATIONAL HEADING HELP'].Value__c }"
                                                                                data-trigger="hover"
                                                                                data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:repeat value="{! costsColumnsMap['2_1'] }" var="costItem">
                                                                        <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                            <apex:outputPanel layout="block" styleClass="item">
                                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block" >
                                                                                    {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentName].Value__c }
                                                                                    <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                        <div class="i-helper inline-block" data-content="{! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentHelp].Value__c }" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                    {! costItem.costValue } {! costItem.costTariff }
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </apex:repeat>
                                                                    <apex:outputPanel rendered="{! showInternationalFeesBlock }">
                                                                        <apex:outputPanel layout="block" styleClass="fee-international-header">
                                                                            <apex:outputPanel layout="block">
                                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['INTERNATIONAL HEADING'].Value__c }
                                                                                <div class="i-helper inline-block" data-content="{! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['INTERNATIONAL HEADING HELP'].Value__c }" data-trigger="hover"
                                                                                     data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                        <apex:repeat value="{! costsColumnsMap['2_2'] }" var="costItem">
                                                                            <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                                <apex:outputPanel layout="block" styleClass="item">
                                                                                    <apex:outputPanel layout="block" styleClass="f-item inline-block" >
                                                                                        {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentName].Value__c }
                                                                                        <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                            <div class="i-helper inline-block" data-content="{! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentHelp].Value__c }" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                        {! costItem.costValue } {! costItem.costTariff }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </apex:repeat>
                                                                    </apex:outputPanel>

                                                                    <apex:outputPanel layout="block" styleClass="fee-other">
                                                                        <div class="collapse-block">
                                                                            <div class="link" data-toggle="collapse" data-target="#otherPossibleFees">
                                                                                {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['OTHER FEES HEADING'].Value__c }
                                                                                <div class="expander block-expand inline-block"></div>
                                                                            </div>
                                                                            <div class="row collapse" style="margin-left: 0px;" id="otherPossibleFees">
                                                                                <div class="fees-inner-block">
                                                                                    <apex:outputPanel layout="block" style="padding-top: 10px;">
                                                                                        {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO']['OTHER FEES SUBHEADING'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:repeat value="{! costsColumnsMap['3'] }" var="costItem">
                                                                                        <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                                            <apex:outputPanel layout="block" styleClass="item" style="margin-top: 7px;">
                                                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block">
                                                                                                    {! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentName].Value__c }
                                                                                                    <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                                        <div class="i-helper inline-block"
                                                                                                            data-content="{! stepPagesMap['ORDER DETAIL BLOCK'].elements['FEES AND COSTS INFO'][costItem.contentHelp].Value__c }"
                                                                                                            data-trigger="hover"
                                                                                                            data-html="true"
                                                                                                            data-container="body"
                                                                                                            data-toggle="popover"
                                                                                                            data-placement="top">?</div>
                                                                                                    </apex:outputPanel>
                                                                                                </apex:outputPanel>
                                                                                                <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                                    {! costItem.costValue } <span class="fees-euro-symbol">{! costItem.costTariff }</span>
                                                                                                </apex:outputPanel>
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </apex:repeat>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <!-- COLLAPSED SPECIAL OFFERS -->
                                        <apex:outputPanel layout="block" id="specialOffersCollapsed" styleClass="special-offers-collapsed" rendered="{! activeStep > 3 }">
                                            <div style="background: #e0eded;">
                                                <div class="b-steps-splitter"></div>
                                            </div>
                                            <div class="wrapper-collapsed">
                                                <div class="row">
                                                    <div class="col-xs-10 col-sm-10">
                                                        <div class="b-step">
                                                            <apex:outputPanel layout="block" styleClass="b-step-header">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/>
                                                                {! menuItemsMap[5].Step_Name__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="col-xs-2 col-sm-2">
                                                        <apex:outputPanel styleClass="edit">
                                                            <apex:commandLink action="{! editSpecialOffers }"
                                                                oncomplete="toViewport('order-details-viewport');isOffers = true; analytics_SpecialOfferOnLoad();"
                                                                styleClass="font-11"
                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:repeat value="{! nonHomeOffersList }" var="offer">
                                                            <apex:outputPanel rendered="{! offer.productName = opportunity.Product__c }">
                                                                <apex:outputPanel layout="block" styleClass="b-step-details">
                                                                    {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['OFFER NAME'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                    {! offer.offerDiscount } {! offer.offerDiscountRatePer }
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </apex:repeat>
                                                    </div>
                                                </div>
                                                <apex:repeat value="{! nonHomeOffersList }" var="offer">
                                                    <apex:outputPanel rendered="{! offer.productName = opportunity.Product__c }">
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <div class="collapse-block" style="margin: 0;">
                                                                    <div class="link" data-toggle="collapse" data-target="#stationDetails">
                                                                        <apex:outputPanel styleClass="font-13" style="color: #0093ee;">
                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['DETAILS HEADING'].Value__c }<div class="expander block-expand inline-block"></div>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <div class="row collapse" id="stationDetails" style="margin: 8px 0 0 0;">
                                                                        <div class="detail-list">
                                                                            <apex:outputPanel layout="block" styleClass="font-11" style="line-height: 1.91;">
                                                                                <apex:outputPanel layout="block" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['DISCOUNT'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerDiscount } {! offer.offerDiscountRatePer }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['TIME'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerTime }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" rendered="{! OR(offer.offerIsBased = 'Volume', offer.offerIsBased = 'Fuel + Volume') }" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['VOLUME'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerVolume }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" rendered="{! OR(offer.offerIsBased = 'Fuel', offer.offerIsBased = 'Fuel + Volume') }" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['FUEL TYPE'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerFuelType }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['GEOGRAPHY'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerCountry }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['STATION'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! offer.offerStation }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
<!--                                                                                 <apex:outputPanel layout="block" style="display: flex;">
                                                                                    <apex:outputPanel layout="block" styleClass="collapsable-head inline-block" style="min-width: 85px;">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['FUEL PRICE'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="inline-block">
                                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['FUEL PRICE VALUE'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel> -->
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>
                                                </apex:repeat>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>

                                    <!-- ORDER DETAILS LINK -->
                                    <span id="order-details-viewport"></span>
                                    <apex:outputPanel layout="block"
                                        rendered="{! AND(
                                            activeStep != 0,
                                            activeSubStep != 'Too many reports',
                                            activeSubstep != 'Congratulations',
                                            activeSubStep != 'Too high limit',
                                            activeSubStep != 'Company not found',
                                            activeSubStep != 'Private entity',
                                            activeSubStep != 'Authorization not granted',
                                            activeSubStep != 'Already in process',
                                            activeSubStep != 'Already a customer',
                                            activeSubStep != 'Black list',
                                            activeSubStep != 'System error'
                                        ) }">
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-12">
                                                <apex:outputPanel layout="block" styleClass="order-details-link">
                                                    <a href="" id="order"> &#8593; {! stepPagesMap['ORDER DETAIL BLOCK'].elements['TOP HEADING']['HEADING'].Value__c } </a>
                                                </apex:outputPanel>
                                            </div>
                                        </div>
                                    </apex:outputPanel>

                                    <!-- STEP CONTACT DETAILS -->
                                    <span id="contact-details-viewport"></span>
                                    <apex:outputPanel layout="block" id="contactDetails" styleClass="contact-details" rendered="{! AND(activeStep = 0, activeSubstep = 'Contact details') }">
                                        <script>
                                            activePageAnalytics = 'Contact details';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="b-desc">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['TOP HEADING']['SUBHEADING'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="salutation block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel id="salutationBlock">
                                                            <div class="btn-group btn-group-justified">
                                                                <div class="{! IF(stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MR BUTTON API'].Value__c = stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected salutation-mr', 'btn btn-select salutation-mr') }"
                                                                    onclick="$j(this).val('{! stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MR BUTTON API'].Value__c }');
                                                                             $j('.salutation-mr').toggleClass('selected'); $j('.salutation-mrs').toggleClass('selected');">
                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MR BUTTON LABEL'].Value__c }
                                                                </div>
                                                                <div class="{! IF(stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MRS BUTTON API'].Value__c = stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected salutation-mrs', 'btn btn-select salutation-mrs') }"
                                                                    onclick="$j('[id$=sltn-dflt]').val('{! stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MRS BUTTON API'].Value__c }');
                                                                             $j('.salutation-mr').toggleClass('selected'); $j('.salutation-mrs').toggleClass('selected');">
                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['MRS BUTTON LABEL'].Value__c }
                                                                </div>
                                                                <apex:inputHidden id="sltn-dflt" value="{! stepPagesMap['CONTACT DETAILS'].fields['SALUTATION'].elementItemsMap['DEFAULT VALUE'].Value__c }"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="first-name block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container">
                                                                        <span class="column">
                                                                            <apex:inputText id="firstName" value="{! stepPagesMap['CONTACT DETAILS'].fields['FIRST NAME'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input ym-disable-keys" maxLength="40"
                                                                            html-autocomplete="off"/>
                                                                            <apex:outputPanel styleClass="input-label">
                                                                                {! stepPagesMap['CONTACT DETAILS'].fields['FIRST NAME'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['FIRST NAME'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputPanel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CONTACT DETAILS'].fields['FIRST NAME'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="last-name block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container" for="lastName">
                                                                        <span class="column">
                                                                            <apex:inputText id="lastName" value="{! stepPagesMap['CONTACT DETAILS'].fields['LAST NAME'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input ym-disable-keys" maxLength="80"
                                                                            html-autocomplete="off"/>
                                                                            <apex:outputPanel styleClass="input-label">
                                                                                {! stepPagesMap['CONTACT DETAILS'].fields['LAST NAME'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['LAST NAME'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputPanel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CONTACT DETAILS'].fields['LAST NAME'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="phone block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container" for="phone">
                                                                        <span class="column">
                                                                            <apex:inputText id="phone" value="{! stepPagesMap['CONTACT DETAILS'].fields['MOBILE NUMBER'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input ym-disable-keys" maxLength="13"
                                                                            html-autocomplete="off"/>
                                                                            <apex:outputPanel styleClass="input-label">
                                                                                {! stepPagesMap['CONTACT DETAILS'].fields['MOBILE NUMBER'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['MOBILE NUMBER'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputPanel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CONTACT DETAILS'].fields['MOBILE NUMBER'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="email block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container" for="email">
                                                                        <span class="column">
                                                                            <apex:inputText id="email" value="{! stepPagesMap['CONTACT DETAILS'].fields['EMAIL ADDRESS'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input ym-disable-keys" maxLength="80" html-autocomplete="off"/>
                                                                            <apex:outputPanel styleClass="input-label">
                                                                                {! stepPagesMap['CONTACT DETAILS'].fields['EMAIL ADDRESS'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['EMAIL ADDRESS'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputPanel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CONTACT DETAILS'].fields['EMAIL ADDRESS'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <apex:outputPanel styleClass="row form-group" rendered="{! NOT(AND(opportunity != null, opportunity.Anzahl_der_Karten__c != null)) }" layout="block">
                                                <div class="email block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container" for="numberofcardscontactdetails">
                                                                        <span class="column">
                                                                            <apex:inputText id="numberofcardscontactdetails" value="{! stepPagesMap['CONTACT DETAILS'].fields['NUMBER OF CARDS'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input ym-disable-keys" html-min="1" html-max="50" onkeyup="validateNumberOfCards(this);"/>
                                                                            <apex:outputPanel styleClass="input-label">
                                                                                {! stepPagesMap['CONTACT DETAILS'].fields['NUMBER OF CARDS'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['NUMBER OF CARDS'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputPanel>
                                                                            <script>
                                                                                function validateNumberOfCards(numberOfCards) {
                                                                                    numberOfCards.value = numberOfCards.value.replace(/[^0-9\.]/g,'');
                                                                                    if(numberOfCards.value.split('.').length > 2) numberOfCards.value = numberOfCards.value.replace(/\.+$/,"");
                                                                                }
                                                                            </script>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                            <div class="row form-group">
                                                <div class="block">
                                                    <div class="col-xs-12 col-sm-12">
                                                    <apex:outputLabel value="{! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['LABEL'].Value__c }" styleClass="f-container company-form">
                                                    <span class="f-required">
                                                        {! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['ASTERISK'].Value__c }
                                                    </span>
                                                </apex:outputLabel>
                                                        <apex:outputPanel id="companyFormBlock">
                                                            <div class="btn-group btn-group-justified">
                                                                <div id="company-btn"
                                                                    class="{! IF(stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['COMPANY BUTTON API'].Value__c = stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected', 'btn btn-select') }"
                                                                    onclick="$j('[id$=company-form-dflt]').val('{! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['COMPANY BUTTON API'].Value__c }');
                                                                             $j('[id$=company-btn]').addClass('selected');
                                                                             $j('[id$=solo-trader-btn]').removeClass('selected');
                                                                             $j('[id$=private-btn]').removeClass('selected');isPrivateEntity = false;"
                                                                    style="font-size: 12px; width: 33%;">
                                                                        {! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['COMPANY BUTTON LABEL'].Value__c }
                                                                    </div>
                                                                <div id="solo-trader-btn"
                                                                    class="{! IF(stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['SOLO-TRADER BUTTON API'].Value__c = stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected', 'btn btn-select') }"
                                                                    onclick="$j('[id$=company-form-dflt]').val('{! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['SOLO-TRADER BUTTON API'].Value__c }');
                                                                             $j('[id$=solo-trader-btn]').addClass('selected');
                                                                             $j('[id$=company-btn]').removeClass('selected');
                                                                             $j('[id$=private-btn]').removeClass('selected');isPrivateEntity = false;"
                                                                    style="font-size: 12px; width: 34%;">
                                                                    {! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['SOLO-TRADER BUTTON LABEL'].Value__c }
                                                                </div>
                                                                <div id="private-btn"
                                                                    class="{! IF(stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['PRIVATE ENTITY BUTTON API'].Value__c = stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected', 'btn btn-select') }"
                                                                    onclick="$j('[id$=company-form-dflt]').val('{! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['PRIVATE ENTITY BUTTON API'].Value__c }');
                                                                             $j('[id$=private-btn]').addClass('selected');
                                                                             $j('[id$=solo-trader-btn]').removeClass('selected');
                                                                             $j('[id$=company-btn]').removeClass('selected');isPrivateEntity = true;"
                                                                    style="font-size: 12px; width: 33%;">
                                                                        {! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['PRIVATE ENTITY BUTTON LABEL'].Value__c }
                                                                    </div>
                                                                <apex:inputHidden id="company-form-dflt" value="{! stepPagesMap['CONTACT DETAILS'].fields['COMPANY FORM'].elementItemsMap['DEFAULT VALUE'].Value__c }"/>
                                                            </div>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-md-12">
                                                    <div class="b-checkbox">
                                                        <div class="form-check">
                                                            <div class="checkbox checkbox-red">
                                                                <apex:inputCheckbox value="{! stepPagesMap['CONTACT DETAILS'].fields['NEWS AGREEMENT'].elementItemsMap['DEFAULT VALUE'].Value__c }" styleClass="form-check-input" id="checkbox1"/>
                                                                <apex:outputLabel value="{! stepPagesMap['CONTACT DETAILS'].fields['NEWS AGREEMENT'].elementItemsMap['LABEL'].Value__c }"
                                                                    styleClass="form-check-label" for="checkbox1" escape="false"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="m-buttons center-block text-center">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:actionFunction name="mGoToCreditScoring" action="{! goToCompanyDetails }" oncomplete="toViewPortCreditScoring(); setEvents_companyDetails(); onPageRender(); lazyLoadScripts();" reRender="formBlock, stepList, systemError, onlineChatBlock, lazyLoadId" status="splashStatus"/>
                                                        <apex:commandLink value="{! stepPagesMap['CONTACT DETAILS'].elements['CONTINUE BUTTON']['VALUE'].Value__c }"
                                                                        onclick="return validateContactDetails(true);"
                                                                        styleClass="btn btn-red"
                                                                        reRender="none"
                                                                        status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            isCompanyDetails = true;
                                            analytics_ContactDetailsOnLoad();
                                        </script>
                                    </apex:outputPanel>

                                    <!-- STEP COMPANY DETAILS -->
                                    <apex:outputPanel layout="block" id="creditScoring" styleClass="credit-scoring" rendered="{! AND(activeStep = 1, OR(activeSubstep = 'Search company', activeSubstep = 'Enter Tax ID', activeSubstep = 'Set total consumption')) }">
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="b-desc" style="width: 90%;">
                                                        {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['TOP HEADING']['SUBHEADING'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="country block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div >
                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COUNTRY'].elementItemsMap['LABEL'].Value__c }" styleClass="f-label"/>
                                                        </div>
                                                        <apex:outputPanel layout="block" styleClass="font-15" style="margin-top: 3px">
                                                            {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COUNTRY'].elementItemsMap['DEFAULT VALUE'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="country-msg">
                                                            {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COUNTRY'].elementItemsMap['REMARK'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <span id="company-name-viewport"></span>
                                            <div class="row form-group">
                                                <div class="company block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container">
                                                                        <span class="column">
                                                                            <apex:inputText id="company" value="{! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COMPANY NAME'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input companyAndCity ym-disable-keys" maxLength="255" style="width: 83%;" html-autocomplete="off"/>
                                                                            <apex:outputLabel styleClass="input-label" for="company">
                                                                                {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COMPANY NAME'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COMPANY NAME'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputLabel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['COMPANY NAME'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row form-group">
                                                <div class="city-id block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container">
                                                                        <span class="column">
                                                                            <apex:inputText id="city" value="{! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['CITY'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input companyAndCity ym-disable-keys" maxLength="50" style="width: 70%;" html-autocomplete="off"/>
                                                                            <apex:outputLabel styleClass="input-label" for="city">
                                                                                {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['CITY'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['CITY'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputLabel>
                                                                        </span>
                                                                    </apex:outputLabel>
                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].fields['CITY'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="m-buttons center-block text-center">
                                                        <apex:actionFunction name="mDoSaveCompany" action="{! doSaveCompanyDetailsData }" onComplete="validateCompanyDetails(false); setEvents_companyDetails(); onPageRender(); mDoSearchCompany();" reRender="systemError"/>
                                                        <apex:actionFunction name="mDoSearchCompany" action="{! doSearchCompany }" onComplete="setEvents_companyDetails(); onPageRender(); endSplash();" reRender="stepList, formBlock, additionInfo, modalCompanySelection, systemError"/>
                                                        <apex:commandLink value="{! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['SEARCH BUTTON']['VALUE'].Value__c }"
                                                                        onclick="return validateCompanyDetailsForSearch();"
                                                                        reRender="systemError"
                                                                        styleClass="btn btn-gray search"
                                                                        status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <script>
                                                activePageAnalytics = 'Search company';
                                            </script>

                                            <span id="your-company-viewport"></span>
                                            <apex:outputPanel id="companySelection">
                                                <apex:outputPanel layout="block" styleClass="credit-scoring-sub" rendered="{! AND(activeStep = 1, OR(activeSubstep = 'Enter Tax ID', activeSubstep = 'Set total consumption')) }">
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="b-collapsed-company ym-hide-content">
                                                                <apex:outputPanel layout="block" styleClass="inline-block collapsed-company">
                                                                    <apex:outputPanel layout="block" styleClass="b-col-header" >
                                                                        {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['SELECT COMPANY BLOCK']['SELECTED COMPANY HEADING'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="font-11">
                                                                        {! selectedCompany.name },<br/>
                                                                        {! selectedCompany.street } {! selectedCompany.housenumber }{! IF(selectedCompany.postcode != null, ', ' +
                                                                        selectedCompany.postcode, '') }{! IF(selectedCompany.city != null, ', ' +
                                                                        selectedCompany.city, '') }{! IF(selectedCompany.country != null, ', ' +
                                                                        selectedCompany.country, '') }
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="i-image inline-block" >
                                                                    <div
                                                                        onclick="toViewport('company-name-viewport');"
                                                                        class="font-11">
                                                                        <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <!-- ENTER TAX ID -->
                                                    <apex:outputPanel styleClass="enter-tax-id" layout="block" rendered="{! AND(activeStep = 1, activeSubStep = 'Enter Tax ID') }">
                                                        <script>
                                                            activePageAnalytics = 'Enter Tax ID';
                                                        </script>
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <div class="b-warning-block">
                                                                    <div class="b-inside-warning">
                                                                        <apex:outputPanel layout="block" styleClass="b-col-header">
                                                                            <apex:outputPanel styleClass="warn"><apex:image url="{!URLFOR($Resource.e2e_images, 'warn.png')}"/></apex:outputPanel>
                                                                            {! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].elements['TOP HEADING']['HEADING'].Value__c }
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel layout="block" styleClass="font-13">
                                                                            {! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].elements['TOP HEADING']['SUBHEADING'].Value__c }
                                                                        </apex:outputPanel>
                                                                        <div class="row form-group">
                                                                            <div class="tax-id block">
                                                                                <div class="col-xs-12 col-sm-12">
                                                                                    <div class="b-form-field">
                                                                                        <div class="form-field">
                                                                                            <div class="f-input">
                                                                                                <apex:outputLabel styleClass="f-container">
                                                                                                    <span class="column">
                                                                                                        <apex:inputText id="taxId" value="{! selectedCompany.vatid }" required="false" styleClass="inline-block form-control required input taxIdInput ym-disable-keys" maxlength="12" style="width: 90%; text-transform: uppercase;"/>
                                                                                                        <apex:outputLabel styleClass="input-label" for="taxId" style="top: 0px;">
                                                                                                            {! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].fields['TAX ID'].elementItemsMap['LABEL'].Value__c }
                                                                                                            <span class="f-required">
                                                                                                                {! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].fields['TAX ID'].elementItemsMap['ASTERISK'].Value__c }
                                                                                                            </span>
                                                                                                        </apex:outputLabel>
                                                                                                        <div class="i-helper inline-block" data-content="{! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].fields['TAX ID'].elementItemsMap['HELP'].Value__c }"
                                                                                                            data-trigger="hover" data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                                                    </span>
                                                                                                </apex:outputLabel>
                                                                                                <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                                            </div>
                                                                                        </div>
                                                                                        <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                                            {! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].fields['TAX ID'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <div class="m-buttons center-block text-center">
                                                                            <apex:outputPanel layout="block">
                                                                                <apex:commandButton id="continueToPumping"
                                                                                    value="{! stepPagesMap['CREDIT SCORE. ENTER TAX ID'].elements['CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                                    action="{! continueToTotalConsumption }"
                                                                                    oncomplete="toViewport('your-company-viewport'); setEvents_companyDetails(); onPageRender();"
                                                                                    reRender="stepList, formBlock, additionInfo, systemError, onlineChatBlock"
                                                                                    styleClass="btn btn-red continue-fromtax"
                                                                                    status="splashStatus"/>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <script>
                                                            analytics_TaxIdOnLoad();
                                                        </script>
                                                    </apex:outputPanel>
                                                    <script>
                                                        activePageAnalytics = 'Search company';
                                                    </script>

                                                    <!-- SET TOTAL CONSUMPTION -->
                                                    <apex:outputPanel id="pump-block">
                                                        <apex:outputPanel layout="block" styleClass="fuel-consumption" rendered="{! AND(activeStep = 1, activeSubstep = 'Set total consumption') }">
                                                            <script>
                                                                activePageAnalytics = 'Set total consumption';
                                                            </script>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" styleClass="b-fuel-consumption">
                                                                        <apex:outputPanel layout="block" styleClass="font-13">
                                                                            {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].elements['TOP HEADING']['HEADING'].Value__c }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="row form-group">
                                                                <div class="pump block">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <div class="b-form-field">
                                                                            <div class="form-field">
                                                                                <div class="f-input">
                                                                                    <apex:outputLabel styleClass="f-container">
                                                                                        <span class="column">
                                                                                            <apex:inputText id="pump" value="{! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['DEFAULT VALUE'].Value__c }" required="false" styleClass="inline-block form-control required input pumpInput ym-disable-keys" maxLength="5"/>
                                                                                            <span class="litters" style="display:none;">
                                                                                                {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['UNIT'].Value__c }
                                                                                            </span>
                                                                                            <apex:outputLabel styleClass="input-label" for="pump">
                                                                                                {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['LABEL'].Value__c }
                                                                                                <span class="f-required">
                                                                                                    {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['ASTERISK'].Value__c }
                                                                                                </span>
                                                                                            </apex:outputLabel>
                                                                                        </span>
                                                                                    </apex:outputLabel>
                                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                                </div>
                                                                            </div>
                                                                            <apex:outputPanel layout="block" styleClass="limit-info font-12">
                                                                                {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['REMARK'].Value__c }
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback consumption-warning1">
                                                                                {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['WARN MESSAGE 1'].Value__c }
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback consumption-warning2">
                                                                                {! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].fields['TOTAL CONSUMPTION'].elementItemsMap['WARN MESSAGE 2'].Value__c }
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <div class="m-buttons center-block text-center">
                                                                            <apex:actionFunction name="goToOfferCreditLine"
                                                                                action="{! doCalculateCreditScoring }"
                                                                                reRender="stepList, formBlock, additionInfo, onlineChatBlock"
                                                                                oncomplete="if({! activeSubstep != 'Too high limit' }) {toViewport('order-details-viewport')}; setEvents_creditLimit(); setEvents_slider(); onPageRender();"
                                                                                status="splashStatus"/>
                                                                            <apex:commandLink value="{! stepPagesMap['CREDIT SCORE. TOTAL CONSUMPTION'].elements['CONTINUE BUTTON']['VALUE'].Value__c }"
                                                                                onclick="return validatePumpDetails();"
                                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                                styleClass="btn btn-red continue"
                                                                                status="splashStatus"/>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <script>
                                                                analytics_TotalConsumptionOnLoad();
                                                            </script>
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{! AND(activeStep = 1, activeSubstep != 'Search company') }">
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="text-center">
                                                                <apex:outputPanel layout="block" styleClass="save-and-continue">
                                                                    <apex:outputPanel layout="block">
                                                                        <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                            value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                            styleClass="font-13"
                                                                            reRender="sendDocumentsToEmail"
                                                                            status="splashStatus"/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                       {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                                <script>
                                                    analytics_SearchCompanyOnLoad();
                                                </script>
                                            </apex:outputPanel>
                                        </div>
                                    </apex:outputPanel>

                                    <!-- STEP CREDIT LINE -->
                                    <apex:outputPanel layout="block" id="creditLine" styleClass="credit-line" rendered="{! AND(activeStep = 1, activeSubstep = 'Calculating credit score') }">
                                        <script>
                                            activePageAnalytics = 'Calculating credit score';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <div class="m-under-header">
                                                        <apex:outputPanel layout="block" styleClass="font-13">
                                                            {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['TOP HEADING']['SUBHEADING'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="payment-method block" style="margin-top: 23px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="btn-group">
                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['LABEL'].Value__c }" styleClass="font-14" style="margin-bottom: 8px;"/>
                                                            <apex:outputPanel layout="block" id="payMethodBlock" styleClass="m-debit-block">
                                                                <apex:commandButton id="dd" style="font-size: 12px; {! IF(countryParam == 'chfr', 'width: 56%;', '') }"
                                                                    value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DD LABEL'].Value__c }"
                                                                    styleClass="{! IF(stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DD API NAME'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected', 'btn btn-select') }"
                                                                    onclick="$j('[id$=payMethod-dflt]').val('{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DD API NAME'].Value__c }');
                                                                             $j('[id$=dd]').addClass('selected');
                                                                             $j('[id$=bt]').removeClass('selected');"
                                                                    reRender="payMethod-dflt, paymentDescriptionBlock, credit-output,deposit-block, billingPeriodRemark"/>
                                                                <apex:commandButton id="bt" style="font-size: 12px; {! IF(countryParam == 'chfr', 'width: 44%;', '') }"
                                                                    value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BT LABEL'].Value__c }"
                                                                    styleClass="{! IF(stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BT API NAME'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c, 'btn btn-select selected', 'btn btn-select') }"
                                                                    onclick="$j('[id$=payMethod-dflt]').val('{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BT API NAME'].Value__c }');
                                                                             $j('[id$=bt]').addClass('selected');
                                                                             $j('[id$=dd]').removeClass('selected');"
                                                                    reRender="payMethod-dflt, paymentDescriptionBlock, credit-output,deposit-block, billingPeriodRemark"/>
                                                                <apex:inputhidden id="payMethod-dflt" value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c }"/>
                                                            </apex:outputPanel>
                                                        </div>
                                                        <apex:outputPanel id="paymentDescriptionBlock" layout="block" styleClass="pay-method-msg font-11 text-muted">
                                                            <apex:outputPanel rendered="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DD API NAME'].Value__c }">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DIRECT DEBIT DESCRIPTION'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BT API NAME'].Value__c }">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BANK TRANSFER DESCRIPTION'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="billing-period block" style="margin-top: 22px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="btn-group">
                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['BILLING PERIOD'].elementItemsMap['LABEL'].Value__c }" styleClass="font-14" style="margin-bottom: 9px;"/>
                                                            <apex:outputPanel layout="block" id="billingPeriodBlock" styleClass="m-calendar-deposit">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['BILLING PERIOD'].elementItemsMap['MONTHLY BUTTON NAME'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                        <apex:outputPanel id="billingPeriodRemark" layout="block" styleClass="pay-method-msg font-11 text-muted">
                                                            <apex:outputPanel rendered="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DD API NAME'].Value__c }">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['BILLING PERIOD'].elementItemsMap['DD REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel rendered="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['DEFAULT VALUE'].Value__c = stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['PAYMENT METHOD'].elementItemsMap['BT API NAME'].Value__c }">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['BILLING PERIOD'].elementItemsMap['BT REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <apex:outputPanel layout="block" styleClass="choose-credit-limit">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="m-block-around">
                                                            <apex:outputPanel layout="block" styleClass="m-row-header">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['CREDIT LIMIT SELECTION BLOCK']['HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="font-11" style="margin-top: 5px;">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['CREDIT LIMIT SELECTION BLOCK']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                            <div class="row form-group">
                                                <div class="credit-limit block" style="margin-top: 20px;">
                                                    <apex:actionFunction name="recalculateDepositValue" action="{! doRecalculateDeposit }"
                                                                         reRender="depositBlock, idInputHidden, payMethodBlock, credit-limit-actions"
                                                                         onComplete="setEvents_creditLimit(); setEvents_slider(); onPageRender(); return false;"
                                                                         status="splashStatus">
                                                        <apex:param name="creditLimit" assignTo="{! creditLimitValue }" value="" />
                                                        <apex:param name="minCreditLimit" assignTo="{! minCreditLimit }" value="" />
                                                        <apex:param name="maxCreditLimit" assignTo="{! maxCreditLimit }" value="" />
                                                    </apex:actionFunction>
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel styleClass="m-credit-output" id="credit-output">
                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['CREDIT LIMIT'].elementItemsMap['LABEL'].Value__c }" styleClass="font-13 credit-limit-label" style="margin-bottom: 4px;">
                                                                <span class="f-required" style="{! IF(minCreditLimit = maxValue, 'display: none;','') }">
                                                                    {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['CREDIT LIMIT'].elementItemsMap['ASTERISK'].Value__c }
                                                                </span>
                                                            </apex:outputLabel>
                                                            <div class="m-credit-value" style="{! IF(minCreditLimit = maxValue, 'margin-bottom: 0','')}">
                                                                <apex:outputPanel id="credit-limit-actions" layout="block" styleClass="inline-block" rendered="{! minCreditLimit != maxValue}">
                                                                    <apex:outputPanel styleClass="btn-group" layout="block">
                                                                        <apex:outputPanel styleClass="btn btn-select credit-value-block" style="width: auto;">
                                                                            <apex:outputText id="creditLimitInput" value="{! creditLimit }"
                                                                                            style="margin-right: 5px; padding: 0px 0px 15px;"
                                                                                            styleClass="limit-value inline-block font-15" />
                                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['CREDIT LIMIT'].elementItemsMap['UNIT'].Value__c }"
                                                                                style="font-weight: 500;"/>
                                                                        </apex:outputPanel>
                                                                        <apex:commandButton value="-" styleClass="btn btn-select action-btn" disabled="{! NOT(creditLimit > minCreditLimit) }" onclick="decreaseCreditLimit(); return false;"/>
                                                                        <apex:commandButton value="+" styleClass="btn btn-select action-btn" disabled="{! NOT(creditLimit < maxValue) }" onclick="increaseCreditLimit(); return false;"/>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" rendered="{! minCreditLimit = maxValue}">
                                                                    <apex:outputText value="{! creditLimit }"
                                                                                        style="margin-right: 5px; padding: 0px 0px 15px;"
                                                                                        styleClass="limit-value inline-block font-15" />
                                                                        <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['CREDIT LIMIT'].elementItemsMap['UNIT'].Value__c }"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel id="hidden-elements">
                                                            <apex:outputPanel layout="none" rendered="{! minCreditLimit != maxValue}">
                                                                <div data-role="range-slider" class="range-slider">
                                                                    <div id="slider"/>
                                                                    <div class="deposit-numbers" >
                                                                        <apex:outputPanel id="minCreditLimit" styleClass="min-limit slider-label-first">
                                                                            {! minCreditLimit }
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel id="maxCreditLimit" styleClass="max-limit slider-label-last" style="float: right; margin-top: 2px;">
                                                                            {! maxValue }
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <apex:inputHidden value="{! creditLimit }" id="idInputHidden"/>
                                                                    <apex:inputHidden value="{! minCreditLimit }" id="minLimit"/>
                                                                    <apex:inputHidden value="{! maxCreditLimit }" id="maxLimit"/>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <script type="text/javascript">
                                                        function recalculateDeposit() {
                                                            var creditLimitValue = document.getElementById('{!$Component.idInputHidden}').value;
                                                            var minLimitValue = document.getElementById('{!$Component.minLimit}').value;
                                                            var maxLimitValue = document.getElementById('{!$Component.maxLimit}').value;
                                                            recalculateDepositValue(creditLimitValue, minLimitValue, maxLimitValue);
                                                        }
                                                    </script>
                                                </div>
                                            </div>
                                            <apex:outputPanel styleClass="row" layout="block" id="deposit-block">
                                                <div class="deposit block" style="{! IF(minCreditLimit != maxCreditLimit,'margin-top: 22px;','margin-top: 0;')}">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel id="depositBlock">
                                                            <apex:outputLabel value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['LABEL'].Value__c }" styleClass="font-13 text-muted" style="margin-bottom: 4px;"/>
                                                            <apex:outputPanel layout="block" rendered="{! AND(deposit != 0, deposit != null) }">
                                                                <apex:outputPanel layout="block">
                                                                    <apex:outputPanel layout="block" styleClass="inline-block font-15" style="vertical-align: middle">
                                                                        <span class="deposit-value">{! deposit }</span>
                                                                        <apex:outputPanel >
                                                                            {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['UNIT'].Value__c }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <div class="i-helper inline-block" data-content="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['HELP REQUIRED DEPOSIT'].Value__c }" data-trigger="hover"
                                                                         data-container="body" data-toggle="popover" data-placement="top" style="margin: 2px 0 0 5px;">?</div>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="font-15">
                                                                    {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['REMARK REQUIRED DEPOSIT'].Value__c }
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" rendered="{! OR(deposit = 0, deposit = null) }">
                                                                <apex:outputPanel layout="block">
                                                                    <apex:outputPanel layout="block" styleClass="font-15 inline-block" style="vertical-align: middle">
                                                                        {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['REMARK NOT REQUIRED DEPOSIT'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <div class="i-helper inline-block" data-content="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].fields['DEPOSIT'].elementItemsMap['HELP NOT REQUIRED DEPOSIT'].Value__c }" data-trigger="hover"
                                                                         data-container="body" data-toggle="popover" data-placement="top" style="margin-top: 2px;">?</div>
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                            <div class="row">
                                                <div class="text-center" style="margin-top: 24px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:actionFunction name="goToCardsOrder" action="{! goToCardsConfig }" reRender="stepList, formBlock, systemError, onlineChatBlock" status="splashStatus" oncomplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"/>
                                                        <apex:commandLink value="{! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['CONTINUE BUTTON']['BUTTON NAME'].Value__c }" onclick="return validateCreditLimit();" reRender="formBlock, systemError" styleClass="btn btn-red continue" status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="text-center" style="margin: 24px 0;">
                                                        <apex:outputPanel layout="block" styleClass="save-and-continue">
                                                            <apex:outputPanel layout="block">
                                                                <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                    value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                    styleClass="font-13"
                                                                    reRender="sendDocumentsToEmail"
                                                                    status="splashStatus"/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="collapse-block">
                                                        <div class="link" data-toggle="collapse" data-target="#creditLine">
                                                            <apex:outputPanel styleClass="m-row-header" style="color: #1a1a1a;">
                                                                {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['INFO BLOCK']['TOP HEADING'].Value__c } <div class="expander block-expand inline-block" style="float: right;"></div>
                                                            </apex:outputPanel>
                                                        </div>
                                                        <div class="row collapse" id="creditLine" style="margin: 12px 0 0 0;">
                                                            <div class="credit-line-collapse">
                                                                <apex:outputPanel layout="block" styleClass="font-13 block-gap">
                                                                    {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['INFO BLOCK']['DESCRIPTION'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="m-row-header block-gap">
                                                                    {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['INFO BLOCK']['SUBBLOCK HEADING'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="font-13">
                                                                    {! stepPagesMap['CREDIT SCORE. SCORING RESULT'].elements['INFO BLOCK']['BODY OF SUBBLOCK'].Value__c }
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            analytics_PaymentMethodOnLoad();
                                        </script>
                                    </apex:outputPanel>

                                    <!-- STEP CARDS ORDER -->
                                    <apex:outputPanel layout="block" id="cardsOrder" styleClass="cards-order" rendered="{! AND(activeStep = 2, OR(activeSubstep = 'Card configuration', activeSubstep = 'Technical parameters')) }">
                                        <script>
                                            activePageAnalytics = 'Card configuration';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['TOP HEADING']['VALUE'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="cards-count block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="b-form-field">
                                                            <div class="form-field">
                                                                <div class="f-input">
                                                                    <apex:outputLabel styleClass="f-container">
                                                                        <span class="column">
                                                                            <apex:input id="counter"
                                                                                type="number"
                                                                                value="{! numberOfCards }"
                                                                                required="false"
                                                                                onchange="changeNumberOfCards();"
                                                                                styleClass="inline-block form-control required input not-emty"
                                                                                html-min="1"
                                                                                html-max="50"
                                                                                onkeypress="return event.charCode >= 48 && event.charCode <= 57"/>
                                                                            <apex:actionFunction name="changeNumberOfCards"
                                                                                action="{! changeNumberOfCards }"
                                                                                onComplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                                reRender="counter, configuration, cards-exception"
                                                                                status="splashStatus"/>
                                                                            <apex:outputLabel styleClass="input-label" for="counter">
                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['NUMBER OF CARDS'].elementItemsMap['LABEL'].Value__c }
                                                                                <span class="f-required">
                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['NUMBER OF CARDS'].elementItemsMap['ASTERISK'].Value__c }
                                                                                </span>
                                                                            </apex:outputLabel>
                                                                        </span>
                                                                        <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                    </apex:outputLabel>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel id="cards-exception">
                                                                <apex:outputPanel rendered="{! activeInnerPage = 'Remove extra cards' }" styleClass="invalidcards-feedback">
                                                                    <div class="i-error">!</div>{! stepPagesMap['CARD CONFIGURATION'].fields['NUMBER OF CARDS'].elementItemsMap['WARN MESSAGE TYPE 1'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{! activeInnerPage = 'No more 2 card error' }" styleClass="invalidcards-feedback">
                                                                    <div class="i-error">!</div>{! stepPagesMap['CARD CONFIGURATION'].fields['NUMBER OF CARDS'].elementItemsMap['WARN MESSAGE TYPE 2'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel rendered="{! activeInnerPage = 'No more 5 card error' }" styleClass="invalidcards-feedback">
                                                                    <div class="i-error">!</div>{! stepPagesMap['CARD CONFIGURATION'].fields['NUMBER OF CARDS'].elementItemsMap['WARN MESSAGE TYPE 3'].Value__c }
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <apex:outputPanel layout="block" id="configuration" styleClass="configurations">
                                            <div class="wrapper">
                                                <div class="cards-list">
                                                    <apex:variable var="index" value="{!1}"/>
                                                    <apex:repeat value="{! finalCardsMap }" var="cardIndx">
                                                        <div class="card-item">
                                                            <apex:outputPanel rendered="{! AND(finalCardsMap[cardIndx].cardIsConfigurated = true, finalCardsMap[cardIndx].techParamsIsConfigurated = true)  }">
                                                                <div class="row">
                                                                    <div class="col-xs-10 col-sm-10">
                                                                        <apex:outputPanel layout="block" styleClass="b-block-header font-15">
                                                                            {! stepPagesMap['CARD CONFIGURATION'].elements['-CARD #-']['LABEL'].Value__c } {! cardIndx }
                                                                            <apex:outputPanel styleClass="edit">
                                                                                <apex:commandLink action="{! editCardConfigurationMobile }"
                                                                                    onComplete="onPageRender(); goToConfiguredCardViewport();"
                                                                                    styleClass="font-11"
                                                                                    reRender="configuration, cards-exception"
                                                                                    status="splashStatus">
                                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                                                    <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                                </apex:commandLink>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                        <script>
                                                                            function goToConfiguredCardViewport() {
                                                                                toViewport('edit-card-viewport');
                                                                            }
                                                                        </script>
                                                                    </div>
                                                                    <div class="col-xs-2 col-sm-2">
                                                                        <apex:outputPanel styleClass="delete" rendered="{! numberOfCards != 1 }">
                                                                            <apex:commandLink action="{! removeCard }"
                                                                                oncomplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                                reRender="configuration, counter, systemError, cards-exception"
                                                                                status="splashStatus">
                                                                                <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                            </apex:commandLink>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <apex:outputPanel layout="block" styleClass="config-desc font-13">
                                                                            {! IF(finalCardsMap[cardIndx].categoryCard == 'Shop related products', stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['TYPE NAME'].Value__c, IF(finalCardsMap[cardIndx].categoryCard == 'All vehicle related product', stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['TYPE NAME'].Value__c, IF(finalCardsMap[cardIndx].categoryCard == 'All fuel types', stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 2'].elementItemsMap['TYPE NAME'].Value__c, IF(finalCardsMap[cardIndx].categoryCard == 'Diesel', stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 3'].elementItemsMap['TYPE NAME'].Value__c, '')))) }{!IF(finalCardsMap[cardIndx].pumpOutsideCountry = true, ', ' + stepPagesMap['CARD CONFIGURATION'].fields['PUMP LOCATION'].elementItemsMap['PUMP OUTSIDE COUNTRY TEASER'].Value__c, ', ' + stepPagesMap['CARD CONFIGURATION'].fields['PUMP LOCATION'].elementItemsMap['PUMP INSIDE COUNTRY TEASER'].Value__c)}{!IF(finalCardsMap[cardIndx].pumpAtPartners = true, ', ' + stepPagesMap['CARD CONFIGURATION'].fields['PUMP PARTNERS'].elementItemsMap['PUMP AT SHELL PARTNERS TEASER'].Value__c, ', ' + stepPagesMap['CARD CONFIGURATION'].fields['PUMP PARTNERS'].elementItemsMap['PUMP ONLY AT SHELL TEASER'].Value__c)}<br/><br/>
                                                                            {! IF(finalCardsMap[cardIndx].selectedTypeOfCar = 'PKW', stepPagesMap['CARD CONFIGURATION'].fields['TYPE OF CAR'].elementItemsMap['PKW TYPE TEASER'].Value__c + ',', stepPagesMap['CARD CONFIGURATION'].fields['TYPE OF CAR'].elementItemsMap['LKW TYPE TEASER'].Value__c + ',') }<br/>
                                                                            {! IF(finalCardsMap[cardIndx].needOdometerOptions = true, stepPagesMap['CARD CONFIGURATION'].fields['ODOMETER OPTIONS'].elementItemsMap['AGREE ODOMETER TEASER'].Value__c, stepPagesMap['CARD CONFIGURATION'].fields['ODOMETER OPTIONS'].elementItemsMap['DISAGREE ODOMETER TEASER'].Value__c) }
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                                <apex:outputPanel rendered="{! cardIndx != numberOfCards }">
                                                                    <div class="b-splitter"></div>
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                            <span id="edit-card-viewport"></span>
                                                            <span id="not-configured-card-{! cardIndx }-viewport"></span>
                                                            <apex:outputPanel layout="block" rendered="{! finalCardsMap[cardIndx].techParamsIsConfigurated = false  }" styleClass="{! IF(continueButtonStatus = 'show-feesAgreementButton', 'config-cards-shadow','') }">
                                                                <div class="row">
                                                                    <div class="col-xs-10 col-sm-10">
                                                                        <apex:outputPanel layout="block" styleClass="b-block-header font-15">
                                                                            {! stepPagesMap['CARD CONFIGURATION'].elements['-CARD #-']['LABEL'].Value__c } {! cardIndx }
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <div class="col-xs-2 col-sm-2">
                                                                        <apex:outputPanel layout="block" styleClass="delete" rendered="{! numberOfCards != 1 }">
                                                                            <apex:commandLink action="{! removeCard }"
                                                                                oncomplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                                reRender="configuration, counter"
                                                                                status="splashStatus">
                                                                                <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                            </apex:commandLink>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <apex:outputPanel layout="block" id="configBlock" styleClass="b-configs-block">
                                                                            <div class="config-list" id="confList">
                                                                                <div id="categoryLink" class="config {! IF(finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Category', 'active', 'blue')}">
                                                                                    <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['CATEGORY TAB']['TAB NAME'].Value__c }  "
                                                                                        reRender="configBlock, save-config-btn"
                                                                                        styleClass="link"
                                                                                        status="splashStatus"
                                                                                        style="width: 70px; display: inline-block;"
                                                                                        oncomplete="changeLink(this); toViewport('edit-card-viewport'); setEvents_cardsOrder(); onPageRender();">
                                                                                            <apex:param name="categoryTabName" value="Category" assignTo="{! finalCardsMap[cardIndx].activeCardConfigStepMobile }"/>
                                                                                    </apex:commandLink>
                                                                                </div>
                                                                                <div id="optionLink" class="config {! IF(finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Options', 'active', IF(finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Embossing','blue','disabled')) }">
                                                                                    <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['OPTIONS TAB']['TAB NAME'].Value__c }  "
                                                                                        reRender="configBlock, save-config-btn"
                                                                                        styleClass="link"
                                                                                        status="splashStatus"
                                                                                        style="width: 70px; display: inline-block; margin-left: 0;"
                                                                                        oncomplete="changeLink(this); toViewport('edit-card-viewport'); setEvents_cardsOrder(); onPageRender();">
                                                                                            <apex:param name="optionsTabName" value="Options" assignTo="{! finalCardsMap[cardIndx].activeCardConfigStepMobile }"/>
                                                                                            <apex:param name="continueButtonStatusValue" value="show-goToEmbossingButton" assignTo="{! continueButtonStatus }"/>
                                                                                    </apex:commandLink>
                                                                                </div>
                                                                                <div id="embossingLink" class="config {! IF(finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Embossing', 'active', 'disabled')}" style="{! IF(LEN(account.Name) <= 25, 'display: none', '') }">
                                                                                    <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['TAB NAME'].Value__c }  "
                                                                                        reRender="configBlock, save-config-btn"
                                                                                        styleClass="link"
                                                                                        status="splashStatus"
                                                                                        style="width: 70px; display: inline-block;"
                                                                                        oncomplete="changeLink(this); toViewport('edit-card-viewport');">
                                                                                            <apex:param name="embossingTabName" value="Embossing" assignTo="{! finalCardsMap[cardIndx].activeCardConfigStepMobile }"/>
                                                                                    </apex:commandLink>
                                                                                </div>
                                                                            </div>
                                                                            <apex:outputPanel layout="block" id="configSteps">
                                                                                <apex:outputPanel layout="block" styleClass="b-category" rendered="{! finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Category' }">
                                                                                    <apex:outputPanel layout="block" styleClass="font-11">
                                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['CATEGORY TAB']['DESCRIPTION'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <div class="category-list">
                                                                                        <apex:outputPanel rendered="{! unavailableOptions != 'No shop related products' }">
                                                                                            <div class="radio radio-red">
                                                                                                <div class="category">
                                                                                                    <input type="radio"
                                                                                                        id="shopRelatedProducts"
                                                                                                        value="Shop related products"
                                                                                                        name="category{! cardIndx }"
                                                                                                        onclick="$j('.hiddenRadioValue{! cardIndx } input').val('Shop related products');"/>
                                                                                                    <label for="shopRelatedProducts">
                                                                                                        <apex:outputPanel styleClass="select-item">
                                                                                                            {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['TYPE NAME'].Value__c }
                                                                                                            <span class="i-helper inline-block" data-content="{! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['HELP'].Value__c }" data-html="true" data-trigger="hover"
                                                                                                                 data-container="body" data-toggle="popover" data-placement="bottom">?</span>
                                                                                                        </apex:outputPanel><br/>
                                                                                                        <ul class="font-11">
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 1'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 2'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 3'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 4'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 5'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                            <li>
                                                                                                                <apex:outputPanel >
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 4'].elementItemsMap['ITEM 6'].Value__c }
                                                                                                                </apex:outputPanel>
                                                                                                            </li>
                                                                                                        </ul>
                                                                                                    </label>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="b-splitter"></div>
                                                                                        </apex:outputPanel>
                                                                                        <div class="radio radio-red">
                                                                                            <div class="category">
                                                                                                <input type="radio"
                                                                                                    id="radio4"
                                                                                                    value="All vehicle related product"
                                                                                                    name="category{! cardIndx }"
                                                                                                    onclick="$j('.hiddenRadioValue{! cardIndx } input').val('All vehicle related product');"/>
                                                                                                <label for="radio4">
                                                                                                    <apex:outputPanel styleClass="select-item">
                                                                                                        {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['TYPE NAME'].Value__c }
                                                                                                        <span class="i-helper inline-block" data-content="{! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['HELP'].Value__c }" data-html="true" data-trigger="hover"
                                                                                                             data-container="body" data-toggle="popover" data-placement="bottom">?</span>
                                                                                                    </apex:outputPanel><br/>
                                                                                                    <ul class="font-11">
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['ITEM 1'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li><apex:outputPanel >
                                                                                                            {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['ITEM 2'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['ITEM 3'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['ITEM 4'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 1'].elementItemsMap['ITEM 5'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                    </ul>
                                                                                                </label>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="b-splitter"></div>
                                                                                        <div class="radio radio-red">
                                                                                            <div class="category">
                                                                                                <input type="radio"
                                                                                                    id="radio5"
                                                                                                    value="All fuel types"
                                                                                                    onclick="$j('.hiddenRadioValue{! cardIndx } input').val('All fuel types');"
                                                                                                    name="category{! cardIndx }"/>
                                                                                                <label for="radio5">
                                                                                                    <apex:outputPanel styleClass="select-item">
                                                                                                        {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 2'].elementItemsMap['TYPE NAME'].Value__c }
                                                                                                        <span class="i-helper inline-block" data-content="{! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 2'].elementItemsMap['HELP'].Value__c }" data-html="true" data-trigger="hover"
                                                                                                            data-container="body" data-toggle="popover" data-placement="bottom">?</span>
                                                                                                    </apex:outputPanel><br/>
                                                                                                    <ul class="font-11">
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 2'].elementItemsMap['ITEM 1'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 2'].elementItemsMap['ITEM 2'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                    </ul>
                                                                                                </label>
                                                                                            </div>
                                                                                        </div>
                                                                                        <div class="b-splitter"></div>

                                                                                        <div class="radio radio-red">
                                                                                            <div class="category">
                                                                                                <input type="radio"
                                                                                                    id="radio6"
                                                                                                    value="Diesel"
                                                                                                    onclick="$j('.hiddenRadioValue{! cardIndx } input').val('Diesel');"
                                                                                                    name="category{! cardIndx }"/>
                                                                                                <label for="radio6">
                                                                                                    <apex:outputPanel styleClass="select-item">
                                                                                                        {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 3'].elementItemsMap['TYPE NAME'].Value__c }
                                                                                                    </apex:outputPanel><br/>
                                                                                                    <ul class="font-11">
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 3'].elementItemsMap['ITEM 1'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 3'].elementItemsMap['ITEM 2'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                        <li>
                                                                                                            <apex:outputPanel >
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['CARD TYPE 3'].elementItemsMap['ITEM 3'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </li>
                                                                                                    </ul>
                                                                                                </label>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="hiddenRadioValue{! cardIndx }">
                                                                                        <apex:inputHidden value="{! finalCardsMap[cardIndx].categoryCard }"/>
                                                                                        <script>
                                                                                            $j('input[name="category' + {! cardIndx } + '"][value="' + $j('.hiddenRadioValue{! cardIndx } input').val() + '"]').prop('checked', true);
                                                                                        </script>
                                                                                    </div>
                                                                                    <div class="row">
                                                                                        <div class="center-block text-center" style="margin-top: 24px;">
                                                                                            <div class="col-xs-12 col-sm-12">
                                                                                                <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['CATEGORY TAB']['NEXT BUTTON'].Value__c }"
                                                                                                    action="{! goToOptions }"
                                                                                                    reRender="configBlock"
                                                                                                    oncomplete="onPageRender(); goToLastNotConfiguredCardViewport(); setEvents_cardsOrder();"
                                                                                                    styleClass="btn btn-red"
                                                                                                    status="splashStatus">
                                                                                                        <apex:param name="optionsTabName" value="Options" assignTo="{! finalCardsMap[cardIndx].activeCardConfigStepMobile }"/>
                                                                                                </apex:commandLink>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <script>
                                                                                        analytics_CardConfigurationOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                                                                    </script>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" styleClass="b-option" rendered="{! finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Options' }">
                                                                                    <div class="options">
                                                                                        <div class="item">
                                                                                            <div class="b-checkbox">
                                                                                                <div class="form-check">
                                                                                                    <div class="checkbox checkbox-red">
                                                                                                        <apex:inputCheckbox value="{! finalCardsMap[cardIndx].pumpOutsideCountry }" styleClass="form-check-input" id="checkbox2"/>
                                                                                                        <apex:outputLabel for="checkbox2" value="{! stepPagesMap['CARD CONFIGURATION'].fields['PUMP LOCATION'].elementItemsMap['LABEL'].Value__c }" styleClass="form-check-label"/>
                                                                                                        <apex:outputPanel layout="block" styleClass="desc">
                                                                                                            {! stepPagesMap['CARD CONFIGURATION'].fields['PUMP LOCATION'].elementItemsMap['REMARK'].Value__c }
                                                                                                        </apex:outputPanel>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="b-splitter"></div>
                                                                                        </div>
                                                                                        <div class="item">
                                                                                            <div class="b-checkbox">
                                                                                                <div class="form-check">
                                                                                                    <div class="checkbox checkbox-red">
                                                                                                        <apex:inputCheckbox value="{! finalCardsMap[cardIndx].needOdometerOptions }" styleClass="form-check-input" id="checkbox4"/>
                                                                                                        <apex:outputLabel value="{! stepPagesMap['CARD CONFIGURATION'].fields['ODOMETER OPTIONS'].elementItemsMap['LABEL'].Value__c }" styleClass="form-check-label" for="checkbox4">
                                                                                                            <span
                                                                                                                class="i-helper inline-block"
                                                                                                                data-content="{! stepPagesMap['CARD CONFIGURATION'].fields['ODOMETER OPTIONS'].elementItemsMap['HELP'].Value__c }"
                                                                                                                data-html="true"
                                                                                                                data-trigger="hover"
                                                                                                                data-container="body"
                                                                                                                data-toggle="popover"
                                                                                                                data-placement="bottom">
                                                                                                                ?
                                                                                                            </span>
                                                                                                        </apex:outputLabel>
                                                                                                        <apex:outputPanel layout="block" styleClass="desc">
                                                                                                            {! stepPagesMap['CARD CONFIGURATION'].fields['ODOMETER OPTIONS'].elementItemsMap['REMARK'].Value__c }
                                                                                                        </apex:outputPanel>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class="row">
                                                                                        <div class="center-block text-center" style="margin-top: 24px;">
                                                                                            <div class="col-xs-12 col-sm-12">
                                                                                                <!-- if account name > 25 symbols -->
                                                                                                <apex:commandLink action="{! goToEmbossing }"
                                                                                                    value="{! stepPagesMap['CARD CONFIGURATION'].elements['OPTIONS TAB']['NEXT BUTTON'].Value__c }"
                                                                                                    reRender="configBlock, save-config-btn, cards-exception"
                                                                                                    rendered="{! continueButtonStatus = 'show-goToEmbossingButton' }"
                                                                                                    oncomplete="onPageRender(); setEvents_cardsOrder(); goToLastNotConfiguredCardViewport();"
                                                                                                    status="splashStatus"
                                                                                                    styleClass="btn btn-red">
                                                                                                        <apex:param name="embossingTabName" value="Embossing" assignTo="{! finalCardsMap[cardIndx].activeCardConfigStepMobile }"/>
                                                                                                </apex:commandLink>
                                                                                                <!-- if 1 card only and account name > 25 symbols -->
                                                                                                <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['CONTINUE BUTTON'].Value__c }"
                                                                                                    action="{! goToFeesAndCosts }"
                                                                                                    oncomplete="toViewport('fees-snd-costs-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                                                    reRender="configuration, cards-exception"
                                                                                                    styleClass="btn btn-red"
                                                                                                    rendered="{! continueButtonStatus = 'show-saveContinueButton' }"
                                                                                                    status="splashStatus">
                                                                                                        <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                                                </apex:commandLink>
                                                                                                <!-- if more than 2 cards and account name > 25 symbols -->
                                                                                                <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['SAVE BUTTON'].Value__c }"
                                                                                                    action="{! saveCard }"
                                                                                                    onComplete="onPageRender(); goToLastNotConfiguredCardViewport();"
                                                                                                    reRender="configuration, systemError, cards-exception"
                                                                                                    rendered="{! continueButtonStatus = 'show-saveSingleCardButton' }"
                                                                                                    styleClass="btn btn-red"
                                                                                                    status="splashStatus">
                                                                                                        <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                                                </apex:commandLink>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <script>
                                                                                        analytics_CardConfigurationOptionsOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                                                                    </script>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" styleClass="b-embossing" rendered="{! finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Embossing' }">
                                                                                    <apex:outputPanel layout="block" styleClass="font-13" rendered="{! countryParam = 'chde' }">
                                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['DESCRIPTION'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="font-13" rendered="{! countryParam = 'chfr' }">
                                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['DESCRIPTION'].Value__c } {! cardIndx } {! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['DESCRIPTION PART 2'].Value__c}
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel id="company-name-input">
                                                                                        <apex:outputPanel layout="block" rendered="{! finalCardsMap[cardIndx].displayCompanyNameField = true }">
                                                                                            <div class="row form-group">
                                                                                                <div class="company-name block ym-hide-content">
                                                                                                    <div class="col-xs-12 col-sm-12">
                                                                                                        <div class="b-form-field">
                                                                                                            <div class="form-field">
                                                                                                                <div class="f-input">
                                                                                                                    <apex:outputLabel styleClass="f-container">
                                                                                                                        <span class="column">
                                                                                                                            <apex:inputText id="companyName"
                                                                                                                                value="{! finalCardsMap[cardIndx].companyNameInputValue }"
                                                                                                                                required="false"
                                                                                                                                styleClass="inline-block form-control required input ym-disable-keys"
                                                                                                                                style="text-transform: uppercase;"
                                                                                                                                maxLength="25"
                                                                                                                                html-autocomplete="off"/>
                                                                                                                            <span class="len-company-name font-11"></span>
                                                                                                                            <apex:outputLabel styleClass="input-label" for="companyName">
                                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['LABEL'].Value__c }
                                                                                                                                <span class="f-required">
                                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['ASTERISK'].Value__c }
                                                                                                                                </span>
                                                                                                                            </apex:outputLabel>
                                                                                                                        </span>
                                                                                                                    </apex:outputLabel>
                                                                                                                    <span class="additional" style="display: none"><apex:image url="{!URLFOR($Resource.e2e_images, 'i-checked.png')}"/></span>
                                                                                                                </div>
                                                                                                                <apex:outputPanel layout="block" styleClass="font-11 text-muted" style="margin-top: 7px; display: flex;">
                                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['REMARK'].Value__c }
                                                                                                                    <span style="min-width: 21px; display: inline-block;"></span>
                                                                                                                </apex:outputPanel>
                                                                                                            </div>
                                                                                                            <apex:outputPanel layout="block" styleClass="invalid-feedback">
                                                                                                                {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['WARN MESSAGE'].Value__c }
                                                                                                            </apex:outputPanel>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </apex:outputPanel>

                                                                                        <apex:outputPanel layout="block" rendered="{! finalCardsMap[cardIndx].displayCompanyNameField = false }">
                                                                                            <div class="row">
                                                                                                <div class="col-xs-12 col-sm-12">
                                                                                                    <apex:outputLabel styleClass="font-13 text-muted" style="margin: 24px 0 4px 0;">
                                                                                                        {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['LABEL'].Value__c }
                                                                                                        <span class="f-required">
                                                                                                            {! stepPagesMap['CARD CONFIGURATION'].fields['COMPANY NAME'].elementItemsMap['ASTERISK'].Value__c }
                                                                                                        </span>
                                                                                                    </apex:outputLabel>
                                                                                                    <div class="m-company-value ym-hide-content">
                                                                                                        <apex:outputText id="companyInput"
                                                                                                            value="{! finalCardsMap[cardIndx].companyNameInputValue }"
                                                                                                            styleClass="company-value inline-block font-15"/>
                                                                                                        <apex:outputPanel styleClass="edit">
                                                                                                            <apex:commandLink action="{! editCompanyName }"
                                                                                                                onComplete="setEvents_cardsOrder(); onPageRender();"
                                                                                                                styleClass="font-11"
                                                                                                                reRender="company-name-input"
                                                                                                                status="splashStatus">
                                                                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                                                                                <apex:param name="cardindex" value="{! cardIndx }"/>
                                                                                                            </apex:commandLink>
                                                                                                        </apex:outputPanel>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <script>
                                                                                        analytics_CardConfigurationPersonOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                                                                    </script>
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>

                                                                <apex:outputPanel id="save-config-btn">
                                                                    <apex:outputPanel rendered="{! finalCardsMap[cardIndx].activeCardConfigStepMobile = 'Embossing' }">
                                                                        <apex:outputPanel rendered="{! LEN(account.Name) > 25 }">
                                                                            <div class="row">
                                                                                <div class="center-block text-center" style="margin-top: 24px;">
                                                                                    <div class="col-xs-12 col-sm-12">
                                                                                        <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['SAVE BUTTON'].Value__c }"
                                                                                            action="{! saveCard }"
                                                                                            onclick="if (! checkCompanyName()) return false;"
                                                                                            onComplete="goToLastNotConfiguredCardViewport(); onPageRender();"
                                                                                            reRender="configuration, systemError"
                                                                                            rendered="{! continueButtonStatus = 'show-saveSingleCardButton' }"
                                                                                            styleClass="btn btn-red"
                                                                                            status="splashStatus">
                                                                                                <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                                        </apex:commandLink>
                                                                                        <apex:commandLink value="{! stepPagesMap['CARD CONFIGURATION'].elements['EMBOSSING TAB']['CONTINUE BUTTON'].Value__c }"
                                                                                            action="{! goToFeesAndCosts }"
                                                                                            onclick="if (! checkCompanyName()) return false;"
                                                                                            oncomplete="toViewport('fees-snd-costs-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                                            reRender="configuration"
                                                                                            styleClass="btn btn-red"
                                                                                            rendered="{! continueButtonStatus = 'show-saveContinueButton' }"
                                                                                            status="splashStatus">
                                                                                            <apex:param name="cardIndex" value="{! cardIndx }"/>
                                                                                        </apex:commandLink>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="row">
                                                                                <div class="col-xs-12 col-sm-12">
                                                                                    <div class="text-center">
                                                                                        <apex:outputPanel layout="block" styleClass="save-and-continue">
                                                                                            <apex:outputPanel layout="block">
                                                                                                <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                                                    value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                                                    styleClass="font-13"
                                                                                                    reRender="sendDocumentsToEmail"
                                                                                                    status="splashStatus"/>
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                                                {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <script>
                                                                    function goToLastNotConfiguredCardViewport() {
                                                                        var cardIndxJs = + '{! cardIndx }';
                                                                        toViewport('not-configured-card-' + cardIndxJs + '-viewport');
                                                                    }
                                                                </script>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </apex:repeat>
                                                </div>
                                            </div>

                                            <apex:repeat value="{! finalCardsMap }" var="cardIndx">
                                                <apex:outputPanel layout="block" styleClass="col-xs-12 col-sm-12" rendered="{! AND(finalCardsMap[cardIndx].techParamsIsConfigurated = true, finalCardsMap[cardIndx].cardIsConfigurated = false) }">
                                                    <div class="card-item">
                                                        <div class="row">
                                                            <div class="b-steps-list-cards">
                                                                <apex:outputPanel layout="block" styleClass="li">
                                                                    <apex:outputPanel styleClass="li-text" layout="block">
                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['-CARD #-']['LABEL'].Value__c } {! cardIndx }
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </apex:repeat>

                                            <span id="fees-snd-costs-viewport"></span>
                                            <apex:outputPanel layout="block" styleClass="col-xs-12 col-sm-12" rendered="{! OR(continueButtonStatus = 'show-saveSingleCardButton', continueButtonStatus = 'show-saveContinueButton', continueButtonStatus = 'show-goToEmbossingButton') }">
                                                <div class="row">
                                                    <div class="b-steps-list-cards">
                                                        <apex:outputPanel layout="block" styleClass="li" style="border: none;">
                                                            <apex:outputPanel styleClass="li-text" layout="block">
                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['FEES AND COSTS']['HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                            <apex:outputPanel rendered="{! continueButtonStatus = 'show-feesAgreementButton' }">
                                                <div class="wrapper blue-block">
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <apex:outputPanel layout="block" styleClass="b-block-header">
                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['FEES AND COSTS']['HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="inner-block">
                                                                <apex:repeat value="{! costsColumnsMap['1'] }" var="costItem">
                                                                    <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                        <apex:outputPanel layout="block" styleClass="item" style="{! costItem.style }">
                                                                            <apex:outputPanel layout="block" styleClass="f-item inline-block">
                                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['SERVICE FEE'][costItem.contentName].Value__c }
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                {! costItem.costValue } {! costItem.costTariff }
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel layout="block" styleClass="f-desc">
                                                                            {! stepPagesMap['CARD CONFIGURATION'].elements['SERVICE FEE']['-PER-'].Value__c } {! numberOfCards } {! IF(numberOfCards = 1, stepPagesMap['CARD CONFIGURATION'].elements['SERVICE FEE']['-CARD-'].Value__c, stepPagesMap['CARD CONFIGURATION'].elements['SERVICE FEE']['-CARDS-'].Value__c) }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>

                                                                <apex:outputPanel layout="block" styleClass="fee-national-header">
                                                                    <apex:outputPanel layout="block">
                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE']['NATIONAL HEADING'].Value__c }
                                                                        <div class="i-helper inline-block"
                                                                            data-content="{! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE']['NATIONAL HEADING HELP'].Value__c }"
                                                                            data-trigger="hover"
                                                                            data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <apex:repeat value="{! costsColumnsMap['2_1'] }" var="costItem">
                                                                    <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                        <apex:outputPanel layout="block" styleClass="item">
                                                                            <apex:outputPanel layout="block" styleClass="f-item inline-block" >
                                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE'][costItem.contentName].Value__c }
                                                                                <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                    <div class="i-helper inline-block" data-content="{! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE'][costItem.contentHelp].Value__c }" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                {! costItem.costValue } {! costItem.costTariff }
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </apex:repeat>

                                                                <apex:outputPanel rendered="{! showInternationalFeesBlock }">
                                                                    <apex:outputPanel layout="block" styleClass="fee-international-header">
                                                                        <apex:outputPanel layout="block">
                                                                            {! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE']['INTERNATIONAL HEADING'].Value__c }
                                                                            <div class="i-helper inline-block"
                                                                                data-content="{! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE']['INTERNATIONAL HEADING HELP'].Value__c }" data-trigger="hover"
                                                                                data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <apex:repeat value="{! costsColumnsMap['2_2'] }" var="costItem">
                                                                        <apex:outputPanel layout="block" styleClass="fees-and-costs">
                                                                            <apex:outputPanel layout="block" styleClass="item">
                                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block" >
                                                                                    {! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE'][costItem.contentName].Value__c }
                                                                                    <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                        <div class="i-helper inline-block" data-content="{! stepPagesMap['CARD CONFIGURATION'].elements['TRANSACTION FEE'][costItem.contentHelp].Value__c }" data-trigger="hover" data-container="body" data-toggle="popover" data-placement="top">?</div>
                                                                                    </apex:outputPanel>
                                                                                </apex:outputPanel>
                                                                                <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                    {! costItem.costValue } {! costItem.costTariff }
                                                                                </apex:outputPanel>
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </apex:repeat>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block font-11" style="padding-right: 12px; color: #00000080; float: right;">
                                                                    {! stepPagesMap['CARD CONFIGURATION'].elements['VAT IS NOT INCLUDED']['REMARK'].Value__c }
                                                                </apex:outputPanel>

                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <div class="collapse-block">
                                                                            <div class="link" data-toggle="collapse" data-target="#otherPossibleFees">
                                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['OTHER FEE']['OTHER FEES HEADING'].Value__c }
                                                                                <div class="expander block-expand inline-block"></div>
                                                                            </div>
                                                                            <div class="row collapse" id="otherPossibleFees" style="margin-top: 12px;">
                                                                                <div class="fees-inner-block">
                                                                                    <apex:outputPanel layout="block" styleClass="font-15 fees-inner-text">
                                                                                        {! stepPagesMap['CARD CONFIGURATION'].elements['OTHER FEE']['OTHER FEES SUBHEADING'].Value__c }
                                                                                    </apex:outputPanel>
                                                                                    <apex:repeat value="{! costsColumnsMap['3'] }" var="costItem">
                                                                                        <apex:outputPanel layout="block" styleClass="fees-and-costs" style="{! costItem.style }">
                                                                                            <apex:outputPanel layout="block" styleClass="item" style="margin-top: 7px;">
                                                                                                <apex:outputPanel layout="block" styleClass="f-item inline-block">
                                                                                                    {! stepPagesMap['CARD CONFIGURATION'].elements['OTHER FEE'][costItem.contentName].Value__c }
                                                                                                    <apex:outputPanel rendered="{! costItem.showHelpItem }">
                                                                                                        <div class="i-helper inline-block"
                                                                                                            data-content="{! stepPagesMap['CARD CONFIGURATION'].elements['OTHER FEE'][costItem.contentHelp].Value__c }"
                                                                                                            data-trigger="hover"
                                                                                                            data-html="true"
                                                                                                            data-container="body"
                                                                                                            data-toggle="popover"
                                                                                                            data-placement="top">?</div>
                                                                                                    </apex:outputPanel>
                                                                                                </apex:outputPanel>
                                                                                                <apex:outputPanel layout="block" styleClass="f-val inline-block">
                                                                                                    {! costItem.costValue } <span class="fees-euro-symbol">{! costItem.costTariff }</span>
                                                                                                </apex:outputPanel>
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </apex:repeat>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <apex:repeat value="{! costsColumnsMap['DISCOUNT'] }" var="costItem">
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-sm-12">
                                                                            <div class="b-block-header" style="margin: 28px 12px 5px 12px;">
                                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['DISCOUNT BLOCK']['HEADING'].Value__c } {! costItem.discountValue } {! stepPagesMap['CARD CONFIGURATION'].elements['DISCOUNT BLOCK']['CURRENCY'].Value__c }
                                                                            </div>
                                                                            <div class="font-11" style="margin: 0 12px 0 12px;">
                                                                                {! stepPagesMap['CARD CONFIGURATION'].elements['DISCOUNT BLOCK']['MESSAGE'].Value__c }
                                                                                <ul class="font-11 discount-ul">
                                                                                    <li>
                                                                                        <span>{! stepPagesMap['CARD CONFIGURATION'].elements['DISCOUNT BLOCK']['ENDNOTE'].Value__c }</span>
                                                                                    </li>
                                                                                </ul>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </apex:repeat>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="center-block text-center" style="margin-top: 22px;">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <apex:commandButton value="{! stepPagesMap['CARD CONFIGURATION'].elements['CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                    action="{! goToSpecialOffers }"
                                                                    onComplete="toViewport('order-details-viewport'); setEvents_cardsOrder(); onPageRender();"
                                                                    reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                    status="splashStatus"
                                                                    styleClass="btn btn-red"
                                                                    style="width: auto;"/>
                                                                <script>
                                                                    isOffers = true;
                                                                    analytics_CardConfigurationSummaryOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                                                </script>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="text-center">
                                                                <apex:outputPanel layout="block" styleClass="save-and-continue">
                                                                    <apex:outputPanel layout="block">
                                                                        <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                            value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                            styleClass="font-13"
                                                                            reRender="sendDocumentsToEmail"
                                                                            status="splashStatus"/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                        {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </apex:outputPanel>

                                    <!-- STEP SPECIAL OFFERS -->
                                    <apex:outputPanel rendered="{! OR(AND(activeStep = 2, activeSubstep = 'Choosing offer'), AND(activeStep = 3, activeSubstep = 'Additional services')) }">
                                        <script>
                                            activePageAnalytics = 'Card configuration';
                                        </script>
                                        <apex:outputPanel layout="block" id="specialOffers" styleClass="special-offers" rendered="{! AND(activeStep = 2, activeSubstep = 'Choosing offer') }">
                                            <div class="wrapper">
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="m-offer" >
                                                            <apex:outputPanel layout="block" styleClass="b-col-header">
                                                                {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <apex:outputPanel layout="block" id="blockSpecialOffers">
                                                    <apex:repeat value="{! nonHomeOffersList }" var="nonHomeOffer">
                                                        <apex:outputPanel layout="block" styleClass="offer" id="allShellDiscount">
                                                            <div class="b-splitter"></div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" styleClass="font-15" style="margin-bottom: 6px;">
                                                                        {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['OFFER NAME'].Value__c }
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" styleClass="price-tag-text inline-block">
                                                                        <apex:outputPanel layout="block" styleClass="font-11">
                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['OFFER DESCRIPTION'].Value__c }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <div class="offer-label inline-block">
                                                                        <apex:outputPanel layout="block" styleClass="{! IF(OR(nonHomeOffer.offerRemoveBtnStatus = 'show-enabled', nonHomeOffersList.size = 1), 'arrow-right selected inline-block', 'arrow-right inline-block') }"/>
                                                                        <apex:outputPanel layout="block" styleClass="{! IF(OR(nonHomeOffer.offerRemoveBtnStatus = 'show-enabled', nonHomeOffersList.size = 1), 'price-right selected inline-block', 'price-right inline-block') }">
                                                                            <apex:outputPanel layout="block" styleClass="tag-font-15">
                                                                                {! nonHomeOffer.offerDiscount }
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel layout="block" styleClass="tag-font-13">
                                                                                {! nonHomeOffer.offerDiscountRatePer }
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <div class="collapse-block" style="margin-bottom: 24px;">
                                                                        <div class="link" data-toggle="collapse" data-target="#shellDiscount">
                                                                            <apex:outputPanel styleClass="font-13" style="color: #0093ee;">
                                                                                {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['DETAILS HEADING'].Value__c }<div class="expander inline-block block-collapse"></div>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                        <div class="row collapse in" id="shellDiscount" style="margin: 12px 0 0 0;">
                                                                            <div class="detail-list">
                                                                                <apex:outputPanel layout="block" styleClass="font-11">
                                                                                    <apex:outputPanel layout="block">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['DISCOUNT'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerDiscount } {! nonHomeOffer.offerDiscountRatePer }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['TIME'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerTime }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" rendered="{! OR(nonHomeOffer.offerIsBased = 'Volume', nonHomeOffer.offerIsBased = 'Fuel + Volume') }">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                           {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['VOLUME'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerVolume }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" rendered="{! OR(nonHomeOffer.offerIsBased = 'Fuel', nonHomeOffer.offerIsBased = 'Fuel + Volume') }">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['FUEL TYPE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerFuelType }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['GEOGRAPHY'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerCountry }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                           {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['STATION'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! nonHomeOffer.offerStation }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
<!--                                                                                     <apex:outputPanel layout="block">
                                                                                        <apex:outputPanel layout="block" styleClass="collapsable-head inline-block">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['FUEL PRICE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="inline-block collapsable-body">
                                                                                            {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[nonHomeOffer.offerContentKey]['FUEL PRICE VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel> -->
                                                                                </apex:outputPanel>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="b-splitter" style="margin-bottom: 20px;"></div>
                                                        </apex:outputPanel>
                                                    </apex:repeat>

                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="text-center" id="specialOffersContinueBlock">
                                                                <apex:outputPanel layout="block" styleClass="button-info font-11" style="color: #777;" rendered="{! AND(continueButtonStatus = 'show-disabled', nonHomeOffersList.size != 1 ) }">
                                                                    {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements['CONTINUE BUTTON']['REMARK'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="bottom-continue-btn" >
                                                                    <div class="bottom-continue-btn">
                                                                        <apex:commandButton value="{! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements['CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                            action="{! goToAdditionalParams }"
                                                                            disabled="{! continueButtonStatus != 'show-enabled' }"
                                                                            onComplete="toViewport('additional-viewport'); setEvents_additional(); onPageRender();"
                                                                            styleClass="btn btn-red continue"
                                                                            reRender="formBlock, systemError,onlineChatBlock"
                                                                            status="splashStatus"/>
                                                                    </div>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </apex:outputPanel>
                                            </div>
                                            <script>
                                                analytics_SpecialOfferOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                            </script>
                                        </apex:outputPanel>

                                        <apex:outputPanel styleClass="special-offers" rendered="{! AND(activeStep = 3, activeSubstep = 'Additional services') }">
                                            <script>
                                                activePageAnalytics = 'Additional services';
                                            </script>
                                            <div class="wrapper">
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="m-offer" >
                                                            <apex:outputPanel layout="block" styleClass="b-col-header">
                                                                {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <!-- ADDITIONAL OFFERS BLOCK-->
                                                <apex:outputPanel styleClass="additional-page" layout="block" id="blockCharityOffer">
                                                    <apex:outputPanel styleClass="top-gray-block" layout="block">
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <apex:outputPanel layout="block" styleClass="b-shell-header">
                                                                    <apex:repeat value="{! nonHomeOffersList }" var="offer">
                                                                        <apex:outputPanel layout="block" styleClass="inline-block" style="width: 75%;">
                                                                            <apex:outputPanel styleClass="b-semibold-header" layout="block">
                                                                                {! stepPagesMap['CARD CONFIGURATION. SPECIAL OFFERS'].elements[offer.offerContentKey]['TEASER'].Value__c }
                                                                            </apex:outputPanel>
                                                                            <apex:outputPanel styleClass="font-11" layout="block">
                                                                                {! offer.offerDiscount } {! offer.offerDiscountRatePer }
                                                                            </apex:outputPanel>
                                                                        </apex:outputPanel>
                                                                    </apex:repeat>
                                                                    <apex:outputPanel layout="block" styleClass="edit-special-offer inline-block pull-right">
                                                                        <apex:outputPanel styleClass="edit">
                                                                            <apex:commandLink action="{! editSpecialOffers }"
                                                                                styleClass="font-11"
                                                                                onClick="isOffers = true;"
                                                                                reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                                status="splashStatus">
                                                                                <apex:image url="{!URLFOR($Resource.e2e_images, 'pen.png')}" style="width: 15px;"/>
                                                                            </apex:commandLink>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </apex:outputPanel>

                                                    <span id="additional-viewport"></span>
                                                    <apex:outputPanel layout="block" rendered="{! AND(activeStep = 3, activeSubStep = 'Additional services') }">
                                                        <apex:outputPanel styleClass="offer scroll-to-additional" layout="block">
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" styleClass="m-nature-block" >
                                                                        <apex:outputPanel layout="block" styleClass="b-small-header">
                                                                            {! stepPagesMap['ADDITIONAL'].elements['CO2 TOP HEADING']['HEADING'].Value__c }
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel layout="block" styleClass="font-13">
                                                                            {! stepPagesMap['ADDITIONAL'].elements['CO2 TOP HEADING']['SUBHEADING'].Value__c }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12" style="padding-right: 12px;">
                                                                    <apex:outputPanel layout="block" styleClass="b-text-img" >
                                                                        <apex:image url="{!URLFOR($Resource.e2e_images, 'eco1.png')}" styleClass="eco-img"/>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" styleClass="text-under-picture">
                                                                        <apex:outputPanel layout="block" styleClass="font-11">
                                                                            {! stepPagesMap['ADDITIONAL'].elements['CO2 DESCRIPTION']['VALUE'].Value__c }
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <div class="agree" style="margin-top: 7px;">
                                                                        <div class="form-check inline-block">
                                                                            <div class="checkbox checkbox-red">
                                                                                <apex:inputCheckbox value="{! stepPagesMap['ADDITIONAL'].fields['CO2 TAKE CARE'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input" id="checkboxCareAdditionalBlock"/>
                                                                                <apex:outputLabel for="checkboxCareAdditionalBlock">
                                                                                    <apex:outputPanel styleClass="font-11">
                                                                                        <apex:outputPanel >
                                                                                            {! stepPagesMap['ADDITIONAL'].fields['CO2 TAKE CARE'].elementItemsMap['LABEL'].Value__c }
                                                                                        </apex:outputPanel><br/>
                                                                                        <apex:outputPanel >
                                                                                            {! stepPagesMap['ADDITIONAL'].fields['CO2 TAKE CARE'].elementItemsMap['SUBLABEL'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                </apex:outputLabel>
                                                                            </div>
                                                                            <!-- DIRECT DEBIT NO DEPOSIT / BANK TRANSFER NO DEPOSIT -->
                                                                            <apex:outputPanel rendered="{! AND(OR(opportunity.Zahlungsart__c == 'Lastschrift', opportunity.Zahlungsart__c == 'Bank√ºberweisung'), opportunity.Security_Amount_To_Pay__c == null) }">
                                                                                <div class="b-splitter" style="margin: 10px 10px 0px 0px;"></div>
                                                                                <div class="row">
                                                                                    <div class="col-xs-12 col-sm-12">
                                                                                        <apex:outputPanel layout="block" styleClass="b-block-header" style="margin-left: 0px;">
                                                                                            {! stepPagesMap['ADDITIONAL'].elements['TOP HEADING']['HEADING'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="row form-group" style="margin-top: -10px;">
                                                                                    <div class="billing-period block" style="margin-top: 10px;">
                                                                                        <div class="col-xs-12 col-sm-12" style="padding-left: 0px;">
                                                                                            <apex:outputPanel layout="block" styleClass="f-label">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['BILLING PERIOD'].elementItemsMap['LABEL'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="f-value">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['BILLING PERIOD'].elementItemsMap['-MONTHLY-'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="row form-group">
                                                                                    <div class="invoices block" style="margin-top: 0px;">
                                                                                        <div class="col-xs-12 col-sm-12" style="padding-left: 0px;">
                                                                                            <apex:outputPanel layout="block" styleClass="f-label">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['INVOICES FORMAT'].elementItemsMap['LABEL'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="f-value">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['INVOICES FORMAT'].elementItemsMap['VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="form-check" style="margin: 10px 0px 10px 0px">
                                                                                    <div class="checkbox checkbox-red">
                                                                                        <apex:inputCheckbox value="{! stepPagesMap['ADDITIONAL'].fields['PAPER INVOICE'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input paper-invoices" id="additionalPaperInvoice"/>
                                                                                        <apex:outputLabel for="additionalPaperInvoice">
                                                                                            <span class="form-check-labelHeader">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['PAPER INVOICE'].elementItemsMap['LABEL 1'].Value__c }
                                                                                            </span><br/>
                                                                                            <span class="font-11">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['PAPER INVOICE'].elementItemsMap['LABEL 2'].Value__c }
                                                                                            </span><br/>
                                                                                            <span class="font-11" style="color: #9299a2;">
                                                                                                {! stepPagesMap['ADDITIONAL'].fields['PAPER INVOICE'].elementItemsMap['LABEL 3'].Value__c }
                                                                                            </span>
                                                                                        </apex:outputLabel>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="checkbox checkbox-red">
                                                                                    <apex:inputCheckbox id="checkboxTC"
                                                                                        value="{! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['TC AGREEMENT CHECKBOX VALUE'].Value__c }"
                                                                                        styleClass="form-check-input additionalTC"
                                                                                        onclick="analytics_onClickCheckboxSendUI($j(this), '2', 'UI_08_Tankkarte_Step_8_Additional')"/>
                                                                                    <apex:outputLabel styleClass="font-11"
                                                                                        for="checkboxTC">
                                                                                        {! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['TC AGREEMENT CHECKBOX LABEL PART 1'].Value__c }
                                                                                        <apex:commandLink onclick="termsAndConditions(); scrollDisableControl('disable');
                                                                                                     analytics_onClickButtonSendUI('show','popup', 'UI_08_Tankkarte_Step_8_Additional');"
                                                                                            styleClass="font-11"
                                                                                            reRender="modalTermConditions"
                                                                                            status="splashStatus">
                                                                                            {! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['TC AGREEMENT CHECKBOX LABEL URL'].Value__c }
                                                                                        </apex:commandLink>
                                                                                        {! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['TC AGREEMENT CHECKBOX LABEL PART 2'].Value__c }
                                                                                    </apex:outputLabel>
                                                                                </div>
                                                                                <div class="checkbox checkbox-red">
                                                                                    <apex:inputCheckbox id="checkboxBehalfOfCompany"
                                                                                        value="{! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['BEHALF OF COMPANY CHECKBOX VALUE'].Value__c }"
                                                                                        styleClass="form-check-input additionalBehalfOfCompany"
                                                                                        onclick="analytics_onClickCheckboxSendUI($j(this), '1', 'UI_08_Tankkarte_Step_8_Additional')"/>
                                                                                    <apex:outputLabel value="{! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['BEHALF OF COMPANY CHECKBOX LABEL PART 1'].Value__c } {! selectedCompany.name } {! stepPagesMap['ADDITIONAL'].elements['ADDITIONAL SERVICE #1']['BEHALF OF COMPANY CHECKBOX LABEL PART 2'].Value__c }"
                                                                                        styleClass="font-11"
                                                                                        for="checkboxBehalfOfCompany"/>
                                                                                </div>
                                                                            </apex:outputPanel>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </apex:outputPanel>
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <div class="text-center" style="margin-top: 24px;">
                                                                    <apex:outputPanel layout="block" styleClass="bottom-continue-btn" >
                                                                        <apex:commandButton value="{! stepPagesMap['ADDITIONAL'].elements['CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                            action="{! goToPaymentOptions }"
                                                                            oncomplete="toViewport('order-details-viewport'); setEvents_directDebit(); setEvents_directDebitDeposit(); setEvents_bankTransferDeposit(); setEvents_bankTransferNoDeposit(); setEventsMustRemoveBlock(); onPageLoad(); onPageRender();"
                                                                            styleClass="btn btn-red"
                                                                            reRender="stepList, formBlock, systemError, onlineChatBlock"
                                                                            status="splashStatus"/>
                                                                    </apex:outputPanel>

                                                                    <apex:outputPanel layout="block" style="margin-bottom: 4px;">
                                                                        <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                            value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                            styleClass="font-13"
                                                                            reRender="sendDocumentsToEmail"
                                                                            status="splashStatus"/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="font-11 notification-email">
                                                                        {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <script>
                                                            isPaymentDetails = true;
                                                            analytics_AdditionalOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                                        </script>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>

                                    <!-- STEP MOBILE PAYMENT OPTIONS DIRECT DEBIT DEPOSIT -->
                                    <!-- <apex:outputPanel layout="block" id="directDebitDeposit" styleClass="payment-direct-debit-deposit"
                                                      rendered="{! AND(activeStep = 4, true, activeSubstep = 'DirectDebitDeposit') }">
                                        <script>
                                            activePageAnalytics = 'DirectDebitDeposit';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12" style="margin-top: 10px;">
                                                    <apex:outputPanel layout="block" styleClass="m-row-header margin-borders">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['DEPOSIT HEADING']['VALUE'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="payment-amount block" style="margin-top: 0px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="f-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['LABEL'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="f-value">
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['UNIT'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-desc" style="margin-top:16px;">
                                                        <apex:outputPanel layout="block" styleClass="font-11">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['DESCRIPTION'].Value__c }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="payment-pay-deposit">
                                                <apex:outputPanel layout="block" styleClass="m-row-header">
                                                    {! stepPagesMap['PAYMENT OPTIONS'].elements['ONLINE PAYMENT BANK']['VALUE'].Value__c }
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="font-11" style="margin-bottom:16px">
                                                    {! stepPagesMap['PAYMENT OPTIONS'].elements['ONLINE PAYMENT BANK']['DESCRIPTION'].Value__c }
                                                </apex:outputPanel>
                                                <apex:repeat value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].options }" var="param">
                                                    <div class="row">
                                                        <div class="col-xs-5 col-sm-5">
                                                            <div class="radio radio-red">
                                                                <apex:commandLink value="{! param.value }"
                                                                    action="{! changePaymentMethod }"
                                                                    onComplete="setEvents_directDebitDeposit(); onPageRender();"
                                                                    styleClass="category-link {! IF(selectedPaymentMethod = param.value, 'active', '') }"
                                                                    reRender="directDebitDeposit, paymentFormToSend, systemError"
                                                                    status="splashStatus">
                                                                    <apex:param value="{! param.value }" name="paymentMethod" assignto="{! selectedPaymentMethod }"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-7 col-sm-7 pull-right">
                                                            <apex:outputPanel styleClass="pay-logo" >
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, param.label)}"
                                                                            height="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].elementItemsMap[param.value&'Height'].Value__c }"
                                                                            width="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].elementItemsMap[param.value&'Width'].Value__c  }"/>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="b-splitter"></div>
                                                </apex:repeat>
                                                <apex:repeat value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].options }" var="param">
                                                    <div class="row">
                                                        <div class="col-xs-5 col-sm-5">
                                                            <div class="radio radio-red">
                                                                <apex:commandLink value="{! param.value }"
                                                                    action="{! changePaymentMethod }"
                                                                    onComplete="setEvents_directDebitDeposit(); onPageRender();"
                                                                    styleClass="category-link {! IF(selectedPaymentMethod = param.value, 'active', '') }"
                                                                    reRender="directDebitDeposit, paymentFormToSend, systemError"
                                                                    status="splashStatus">
                                                                    <apex:param value="{! param.value }" name="paymentMethod" assignto="{! selectedPaymentMethod }"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-7 col-sm-7 pull-right">
                                                            <apex:outputPanel styleClass="pay-logo" >
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, param.label)}"
                                                                            height="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].elementItemsMap[param.value&'Height'].Value__c }"
                                                                            width="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].elementItemsMap[param.value&'Width'].Value__c  }"/>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="b-splitter"></div>
                                                </apex:repeat>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="col-xs-4 col-sm-4 ingenico pull-right">
                                                        <div style="float:right;">
                                                            <apex:image url="{!URLFOR($Resource.e2e_images, "ingenico.png" )}" height="40px" width="100px"/>
                                                        </div>
                                                    </div>
                                                    <div class="font-11 payment-deposit-footer">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['DEPOSIT FOOTER']['VALUE'].Value__c }
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="b-splitter" style="margin: 16px 12px;"></div>
                                            <div class="form-check" style="margin: 8px 0px 8px 0px;">
                                                <div class="checkbox checkbox-red" style="min-height: 22px;">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input depositAgreement" id="checkboxDirectDebitDeposit"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="checkboxDirectDebitDeposit">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <apex:commandLink styleClass="form-check-label" onclick="showDepositAgreement(); return false;">{!stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['DOWNLOAD URL LABEL'].Value__c}</apex:commandLink>
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 2'].Value__c }
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['UNIT'].Value__c }
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 3'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin: 8px 0 0 0;">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input paymentOptionsDecision" id="DirectDebitDepositDecision"/>
                                                    <apex:outputLabel value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 1'].Value__c } {! selectedCompany.name } {! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 2'].Value__c }" styleClass="form-check-label" for="DirectDebitDepositDecision" style="margin-bottom: 16px;"/>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin-bottom: 15px;">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['VALUE'].Value__c }"  styleClass="form-check-input paymentOptionsTC" id="DirectDebitDepositTC"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="DirectDebitDepositTC" style="margin-bottom: 0px;">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <a onclick="termsAndConditions(); scrollDisableControl('disable');"
                                                            styleClass="form-check-label"
                                                            reRender="modalTermConditions">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL URL'].Value__c }
                                                        </a>
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 2'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="m-buttons center-block text-center" style="margin-top: 9px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:commandButton action="{! proceedToCheckout }"
                                                            value="{! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 1'].Value__c } {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 2'].Value__c }"
                                                            oncomplete="startPayment('payment-direct-debit-deposit');"
                                                            styleClass="btn btn-red continue"
                                                            reRender="formBlock, pageHeader, systemError"
                                                            status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="text-center">
                                                        <apex:outputPanel layout="block" styleClass="save-and-continue" style="margin-top:20px;">
                                                            <apex:outputPanel layout="block" style="margin-bottom: 4px;">
                                                                <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                    value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                    styleClass="font-13"
                                                                    reRender="sendDocumentsToEmail"
                                                                    status="splashStatus"/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            analytics_PaymentDetailsDepositOnLoad();
                                        </script>
                                    </apex:outputPanel> -->

                                    <!-- STEP MOBILE PAYMENT OPTIONS BANK TRANSFER DEPOSIT -->
                                    <!-- <apex:outputPanel layout="block" id="bankTransfer" styleClass="payment-bank-transfer"
                                                      rendered="{! AND(activeStep = 4, true, activeSubstep = 'BankTransferDeposit') }">
                                        <script>
                                            activePageAnalytics = 'BankTransferDeposit';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="billing-period block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="f-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['BILLING PERIOD'].elementItemsMap['LABEL'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="f-value">
                                                            {! IF (opportunity.Rechnungsperiode__c == '7',
                                                                    stepPagesMap['PAYMENT OPTIONS'].fields['BILLING PERIOD'].elementItemsMap['-WEEKLY-'].Value__c,
                                                                    IF (opportunity.Rechnungsperiode__c == '15',
                                                                            stepPagesMap['PAYMENT OPTIONS'].fields['BILLING PERIOD'].elementItemsMap['-BIWEEKLY-'].Value__c,
                                                                            IF (opportunity.Rechnungsperiode__c == '30',
                                                                                    stepPagesMap['PAYMENT OPTIONS'].fields['BILLING PERIOD'].elementItemsMap['-MONTHLY-'].Value__c,
                                                                                    ''))) }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="invoices block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="f-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['INVOICES FORMAT'].elementItemsMap['LABEL'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="f-value">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['INVOICES FORMAT'].elementItemsMap['VALUE'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin: 20px 0 10px 0">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input paper-invoices" id="mcheckboxBankTransferDepositPaper"/>
                                                    <apex:outputLabel for="mcheckboxBankTransferDepositPaper">
                                                        <span class="form-check-labelHeader">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 1'].Value__c }
                                                        </span><br/>
                                                        <span class="font-11">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 2'].Value__c }
                                                        </span><br/>
                                                        <span class="font-11" style="color: #9299a2;">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 3'].Value__c }
                                                        </span>
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="b-splitter"></div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="m-row-header pay-deposit" >
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['DEPOSIT HEADING']['VALUE'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="payment-amount block">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="f-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['LABEL'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="f-value">
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['UNIT'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-desc" style="margin-top:16px;">
                                                        <apex:outputPanel layout="block" styleClass="font-11">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['DESCRIPTION'].Value__c }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="payment-pay-deposit">
                                                <apex:outputPanel layout="block" styleClass="m-row-header">
                                                    {! stepPagesMap['PAYMENT OPTIONS'].elements['ONLINE PAYMENT BANK']['VALUE'].Value__c }
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="font-11" style="margin-bottom:16px">
                                                    {! stepPagesMap['PAYMENT OPTIONS'].elements['ONLINE PAYMENT BANK']['DESCRIPTION'].Value__c }
                                                </apex:outputPanel>
                                                 <apex:repeat value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].options }" var="param">
                                                    <div class="row">
                                                        <div class="col-xs-5 col-sm-5">
                                                            <div class="radio radio-red">
                                                                <apex:commandLink value="{! param.value }"
                                                                    action="{! changePaymentMethod }"
                                                                    onComplete="setEvents_bankTransferDeposit(); onPageRender();"
                                                                    styleClass="category-link {! IF(selectedPaymentMethod = param.value, 'active', '') }"
                                                                    reRender="bankTransfer, paymentFormToSend, systemError"
                                                                    status="splashStatus">
                                                                    <apex:param value="{! param.value }" name="paymentMethod" assignto="{! selectedPaymentMethod }"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-7 col-sm-7 pull-right">
                                                            <apex:outputPanel styleClass="pay-logo" >
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, param.label)}"
                                                                            height="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].elementItemsMap[param.value&'Height'].Value__c }"
                                                                            width="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Cards'].elementItemsMap[param.value&'Width'].Value__c  }"/>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="b-splitter"></div>
                                                </apex:repeat>
                                                <apex:repeat value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].options }" var="param">
                                                    <div class="row">
                                                        <div class="col-xs-5 col-sm-5">
                                                            <div class="radio radio-red">
                                                                <apex:commandLink value="{! param.value }"
                                                                    action="{! changePaymentMethod }"
                                                                    onComplete="setEvents_bankTransferDeposit(); onPageRender();"
                                                                    styleClass="category-link {! IF(selectedPaymentMethod = param.value, 'active', '') }"
                                                                    reRender="bankTransfer, paymentFormToSend, systemError"
                                                                    status="splashStatus">
                                                                    <apex:param value="{! param.value }" name="paymentMethod" assignto="{! selectedPaymentMethod }"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-7 col-sm-7 pull-right">
                                                            <apex:outputPanel styleClass="pay-logo" >
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, param.label)}"
                                                                            height="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].elementItemsMap[param.value&'Height'].Value__c }"
                                                                            width="{! stepPagesMap['PAYMENT OPTIONS'].fields['PaymentMethod Online Bank'].elementItemsMap[param.value&'Width'].Value__c  }"/>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="b-splitter"></div>
                                                </apex:repeat>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="col-xs-4 col-sm-4 ingenico pull-right" >
                                                        <div style="float:right;">
                                                            <apex:image url="{!URLFOR($Resource.e2e_images, "ingenico.png" )}" height="40px" width="100px"/>
                                                        </div>
                                                    </div>
                                                    <div class="font-11 payment-deposit-footer">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['DEPOSIT FOOTER']['VALUE'].Value__c }
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="b-splitter"></div>
                                            <div class="form-check" style="margin: 8px 0 0 0;">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input" id="checkboxBankTransfer1"/>
                                                    <apex:outputLabel value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 1'].Value__c } {! selectedCompany.name } {! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 2'].Value__c }" styleClass="form-check-label" for="checkboxBankTransfer1" style="margin-bottom: 16px;"/>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin-bottom: 15px;">
                                                <div class="checkbox checkbox-red" style="min-height: 22px;">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['VALUE'].Value__c }"  styleClass="form-check-input" id="checkboxBankTransfer2"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="checkboxBankTransfer2" style="margin-bottom: 0px;">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <apex:commandLink onclick="termsAndConditions(); scrollDisableControl('disable');"
                                                            styleClass="form-check-label"
                                                            reRender="modalTermConditions">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL URL'].Value__c }
                                                        </apex:commandLink>
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 2'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="form-check" >
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input" id="checkboxBankTransfer3"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="checkboxBankTransfer3" style="margin-bottom: 10px;">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <apex:commandLink styleClass="form-check-label" onclick="showDepositAgreement(); return false;">{!stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['DOWNLOAD URL LABEL'].Value__c}</apex:commandLink>
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 2'].Value__c }
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['UNIT'].Value__c }
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 3'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="m-buttons center-block text-center">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:commandButton value="{! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 1'].Value__c } {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 2'].Value__c }"
                                                            action="{! proceedToCheckout }"
                                                            onclick="startPayment('payment-bank-transfer');"
                                                            styleClass="btn btn-red continue"
                                                            reRender="formBlock, pageHeader, systemError"
                                                            status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="text-center">
                                                        <apex:outputPanel layout="block" styleClass="save-and-continue" style="margin-top:20px;">
                                                            <apex:outputPanel layout="block" style="margin-bottom: 4px;">
                                                                <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                    value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                    styleClass="font-13"
                                                                    reRender="sendDocumentsToEmail"
                                                                    status="splashStatus"/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            analytics_PaymentDetailsOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                        </script>
                                    </apex:outputPanel> -->

                                    <!-- STEP SELECT PAYMENT METHOD (DirectDebitDeposit/BankTransferDeposit)-->
                                    <apex:outputPanel layout="block" id="payment-options" styleClass="payment-options-block payment-direct-debit-deposit"
                                                      rendered="{! AND(activeStep = 4, OR(activeSubStep = 'DirectDebitDeposit', activeSubStep = 'BankTransferDeposit')) }">
                                        <script>
                                            activePageAnalytics = '{! activeSubStep }';
                                        </script>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="m-row-header margin-borders">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].elements['DEPOSIT HEADING']['VALUE'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row form-group">
                                                <div class="payment-amount block" style="margin-top: 0px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="f-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['LABEL'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="f-value">
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['UNIT'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-desc" style="margin-top:16px;">
                                                        <apex:outputPanel layout="block" styleClass="font-11">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['AMOUNT TO BE PAID'].elementItemsMap['DESCRIPTION'].Value__c }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="congratulations">
                                                <div class="wrapper" style="box-shadow: none;">
                                                    <div class="row">
                                                        <div class="col-xs-12 col-sm-12">
                                                            <div class="m-grey-block">
                                                                <div class="b-description-block">
                                                                    <apex:outputPanel styleClass="b-col-header inline-block" layout="block">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PAYMENT DETAILS BT HEADING'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="inline-block pull-right">
                                                                        <apex:commandLink action="{! showSendHowToPayDocument }"
                                                                            styleClass="btn btn-xs payment-modal"
                                                                            reRender="sendDocumentsToEmail" status="splashStatus">
                                                                            <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                                        </apex:commandLink>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID'].Value__c }
                                                                        </apex:outputPanel>
                                                                        <apex:outputPanel layout="block" styleClass="font-15" style="margin-top: 4px;">
                                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID UNIT'].Value__c }
                                                                            <div class="i-helper inline-block" style="margin-bottom: 3px;"
                                                                                data-content="{! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID HELP'].Value__c }"
                                                                                data-trigger="hover"
                                                                                data-container="body"
                                                                                data-toggle="popover"
                                                                                data-placement="top">?
                                                                            </div>
                                                                        </apex:outputPanel>
                                                                    </apex:outputPanel>
                                                                    <div class="row">
                                                                        <div class="col-xs-12 col-sm-12">
                                                                            <div class="collapse-block">
                                                                                <div class="link" data-toggle="collapse" data-target="#depositDetails">
                                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SHOW DEPOSIT DETAILS LABEL'].Value__c }<div class="expander block-expand inline-block"></div>
                                                                                </div>
                                                                                <div class="row collapse" id="depositDetails" style="margin-left: 0px;">
                                                                                    <div class="detail-list">
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT OWNER'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT OWNER VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PURPOSE OF PAYMENT'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PURPOSE OF PAYMENT VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT NUMBER'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT NUMBER VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK NAME'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK NAME VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
<!--                                                                                         <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK CODE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK CODE VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel> -->
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SWIFT'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SWIFT VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                            <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['IBAN'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['IBAN VALUE'].Value__c }
                                                                                            </apex:outputPanel>
                                                                                        </apex:outputPanel>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-check" style="margin: 8px 0px 8px 0px">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input paper-invoices" id="paymentPaperInvoice"/>
                                                    <apex:outputLabel for="paymentPaperInvoice">
                                                        <span class="form-check-labelHeader">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 1'].Value__c }
                                                        </span><br/>
                                                        <span class="font-11">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 2'].Value__c }
                                                        </span><br/>
                                                        <span class="font-11" style="color: #9299a2;">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['PAPER INVOICE'].elementItemsMap['LABEL 3'].Value__c }
                                                        </span>
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin: 8px 0px 8px 0px;">
                                                <div class="checkbox checkbox-red" style="min-height: 22px;">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input depositAgreement" id="checkboxDirectDebitDeposit"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="checkboxDirectDebitDeposit">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <apex:commandLink styleClass="form-check-label" onclick="showDepositAgreement(); return false;">{!stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['DOWNLOAD URL LABEL'].Value__c}</apex:commandLink>
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 2'].Value__c }
                                                            {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['UNIT'].Value__c }
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['LABEL PART 3'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin: 8px 0 0 0;">
                                                <div class="checkbox checkbox-red">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['VALUE'].Value__c }" styleClass="form-check-input paymentOptionsDecision" id="DirectDebitDepositDecision"/>
                                                    <apex:outputLabel value="{! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 1'].Value__c } {! selectedCompany.name } {! stepPagesMap['PAYMENT OPTIONS'].fields['DECISION'].elementItemsMap['LABEL PART 2'].Value__c }" styleClass="form-check-label" for="DirectDebitDepositDecision" style="margin-bottom: 16px;"/>
                                                </div>
                                            </div>
                                            <div class="form-check" style="margin-bottom: 15px;">
                                                <div class="checkbox checkbox-red" style="min-height: 22px;">
                                                    <apex:inputCheckbox value="{! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['VALUE'].Value__c }"  styleClass="form-check-input paymentOptionsTC" id="checkboxBankTransfer2"/>
                                                    <apex:outputLabel styleClass="form-check-label terms-text" for="checkboxBankTransfer2" style="margin-bottom: 0px;">
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 1'].Value__c }
                                                        <apex:commandLink onclick="termsAndConditions(); scrollDisableControl('disable'); return false;"
                                                            styleClass="form-check-label">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL URL'].Value__c }
                                                        </apex:commandLink>
                                                        {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['LABEL PART 2'].Value__c }
                                                    </apex:outputLabel>
                                                </div>
                                            </div>

                                            <div class="b-splitter" style="margin: 16px 12px;"></div>
                                            <div class="row">
                                                <div class="m-buttons center-block text-center" style="margin-top: 9px;">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:commandButton action="{! proceedToCheckout }"
                                                            value="{! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 1'].Value__c } {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['PAYMENT OPTIONS'].elements['PROCEED TO CHECKOUT BUTTON']['LABEL PART 2'].Value__c }"
                                                            styleClass="btn btn-red continue"
                                                            oncomplete="setEvents_cardsOrder(); onPageRender();"
                                                            reRender="formBlock, pageHeader, additionInfo, systemError"
                                                            status="splashStatus"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="text-center">
                                                        <apex:outputPanel layout="block" styleClass="save-and-continue" style="margin-top:20px;">
                                                            <apex:outputPanel layout="block" style="margin-bottom: 4px;">
                                                                <apex:commandLink action="{! showSaveAndContinueLaterModal }"
                                                                    value="{! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['LABEL'].Value__c }"
                                                                    styleClass="font-13"
                                                                    reRender="saveAndContinueLater"
                                                                    status="splashStatus"/>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel layout="block" styleClass="text-center text-muted font-11">
                                                                {! stepPagesMap['SAVE AND CONTINUE LATER'].elements['SAVE AND CONTINUE BUTTON']['REMARK'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            analytics_PaymentDetailsDepositOnLoad('{! opportunity.Zahlungsart__c }', '{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }','{! opportunity.E2E_Form_of_Business__c }');
                                        </script>
                                    </apex:outputPanel>

                                    <!-- STEP CONGRATULATIONS -->
                                    <span id="congratulations-viewport"></span>
                                    <apex:outputPanel layout="block" id="congratulations" styleClass="congratulations" rendered="{! AND(activeStep == 5, activeSubStep == 'Congratulations') }">
                                        <script>
                                            activePageAnalytics = 'Congratulations';
                                        </script>
                                        <div class="wrapper ym-hide-content">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="end-logo center-block">
                                                        <apex:image url="{!URLFOR($Resource.e2e_images, 'tick2.png')}" styleClass="center-block"></apex:image>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-header">
                                                        <!-- {! IF(paymentStatus = 'A', stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDERED AND PAID'].Value__c, IF(opportunity.Security_To_Pay__c != 'Kaution', stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDERED'].Value__c, IF(paymentStatus = 'E', stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDER EXCEPTION'].Value__c, IF(OR(paymentStatus = 'D', paymentStatus = 'C'), stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDERED AND NOT PAID'].Value__c, '')))) } -->
                                                        {! IF(opportunity.Security_To_Pay__c != 'Kaution', stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDERED'].Value__c, IF(opportunity.Security_To_Pay__c = 'Kaution', stepPagesMap['CONGRATULATIONS'].elements['HEADING ORDER']['CARD ORDERED AND NOT PAID'].Value__c, '')) }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <!-- Card are ordered. Deposit is successfully paid -->
                                                    <!-- <apex:outputPanel layout="block" styleClass="font-13" rendered="{! paymentStatus = 'A'}">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['THANKS BLOCK FOR CARDS'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['THANKS BLOCK FOR CARD'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED AND PAID']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel> -->

                                                    <!-- Card are ordered. Deposit is not required -->
                                                    <!-- <apex:outputPanel layout="block" styleClass="font-13" rendered="{! AND(opportunity.Security_To_Pay__c != 'Kaution', paymentStatus = null) }">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'),stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['THANKS BLOCK FOR CARDS'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['THANKS BLOCK FOR CARD'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel> -->

                                                    <!-- Deposit is not paid (CANCEL\DECLINE) -->
                                                    <!-- <apex:outputPanel layout="block" styleClass="font-13" rendered="{! OR(paymentStatus = 'D', paymentStatus = 'C') }">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'),stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['THANKS BLOCK FOR CARD'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['THANKS BLOCK FOR CARDS'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel> -->

                                                    <!-- Deposit is not certainly paid (EXCEPTION) -->
                                                    <!-- <apex:outputPanel layout="block" styleClass="font-13" rendered="{! paymentStatus = 'E' }">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'),stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['THANKS BLOCK FOR CARD'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['THANKS BLOCK FOR CARDS'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING EXCEPTION']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel> -->


                                                    <!-- TEMP BLOCK (MUST BE REMOVED) -->
                                                    <!-- Card are ordered. Deposit is not required -->
                                                    <apex:outputPanel layout="block" styleClass="info center-block" rendered="{! opportunity.Security_To_Pay__c != 'Kaution' }">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'),stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['THANKS BLOCK FOR CARDS'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['THANKS BLOCK FOR CARD'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDERED']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel>
                                                     <!-- Deposit is not paid -->
                                                    <apex:outputPanel layout="block" styleClass="info center-block" rendered="{! opportunity.Security_To_Pay__c = 'Kaution' }">
                                                        {! IF(OR(contact.Salutation = 'Herr', contact.Salutation = 'Mr'), stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['HI BLOCK 2'].Value__c + ' ' + stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['-MR-'].Value__c, IF(OR(contact.Salutation = 'Frau', contact.Salutation = 'Mrs'),stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['HI BLOCK'].Value__c + ' ' +  stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['-MRS-'].Value__c, ''))} {! contact.FirstName } {! contact.LastName }{! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['THANKS BLOCK FOR CARD'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['THANKS BLOCK FOR CARDS'].Value__c) }
                                                        <apex:outputPanel style="padding-left: 5px;">{! numberOfCards }</apex:outputPanel>
                                                        {! IF(numberOfCards > 1, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['CARDS BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['SUBHEADING ORDER NOT PAID']['CARD BLOCK'].Value__c) }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="font-15 middle-border">
                                                        <apex:outputPanel layout="block" styleClass="inline-block">
                                                            {! selectedCompany.street } {! selectedCompany.housenumber }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="inline-block">
                                                            {! IF(selectedCompany.postcode != null, ', ' + selectedCompany.postcode, '') }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="inline-block">
                                                            {! IF(selectedCompany.city != null, ', ' + selectedCompany.city, '') }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="inline-block">
                                                            {! IF(selectedCompany.country != null, ', ' + selectedCompany.country, '') }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="font-13 bottom-border">
                                                        <apex:outputPanel layout="inline">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['COPY OF ORDER']['VALUE PART 1'].Value__c } {! contact.Email } {! stepPagesMap['CONGRATULATIONS'].elements['COPY OF ORDER']['VALUE PART 2'].Value__c }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- <apex:outputPanel rendered="{! AND(opportunity.Security_To_Pay__c = 'Kaution', OR(paymentStatus = 'D', paymentStatus = 'C', paymentStatus = 'E')) }"> -->
                                        <apex:outputPanel rendered="{! opportunity.Security_To_Pay__c = 'Kaution' }">
                                            <div class="wrapper">
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel styleClass="m-header" layout="block">
                                                            <apex:outputPanel styleClass="b-col-header" layout="block" >
                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['TOP HEADING'].Value__c }
                                                            </apex:outputPanel>
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel styleClass="font-13" layout="block">
                                                            {! IF (opportunity.Zahlungsart__c = 'Bank√ºberweisung', stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK TRANSFER DESCRIPTION BLOCK'].Value__c, stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DIRECT DEBIT DESCRIPTION BLOCK'].Value__c) }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <div class="m-grey-block">
                                                            <div class="b-description-block">
                                                                <apex:outputPanel styleClass="b-col-header inline-block" layout="block">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PAYMENT DETAILS BT HEADING'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="inline-block pull-right">
                                                                    <apex:commandLink action="{! showSendHowToPayDocument }"
                                                                        styleClass="btn btn-xs payment-modal"
                                                                        reRender="sendDocumentsToEmail" status="splashStatus">
                                                                        <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                                    </apex:commandLink>
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                    <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="font-15" style="margin-top: 4px;">
                                                                        {! opportunity.Security_Amount_To_Pay__c } {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID UNIT'].Value__c }
                                                                        <div class="i-helper inline-block" style="margin-bottom: 3px;"
                                                                            data-content="{! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['DEPOSIT TO BE PAID HELP'].Value__c }"
                                                                            data-trigger="hover"
                                                                            data-container="body"
                                                                            data-toggle="popover"
                                                                            data-placement="top">?
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </apex:outputPanel>
                                                                <div class="row">
                                                                    <div class="col-xs-12 col-sm-12">
                                                                        <div class="collapse-block">
                                                                            <div class="link" data-toggle="collapse" data-target="#depositDetails">
                                                                                {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SHOW DEPOSIT DETAILS LABEL'].Value__c }<div class="expander block-expand inline-block"></div>
                                                                            </div>
                                                                            <div class="row collapse" id="depositDetails" style="margin-left: 0px;">
                                                                                <div class="detail-list">
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT OWNER'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT OWNER VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PURPOSE OF PAYMENT'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['PURPOSE OF PAYMENT VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT NUMBER'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['ACCOUNT NUMBER VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK NAME'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK NAME VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
<!--                                                                                     <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK CODE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['BANK CODE VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel> -->
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SWIFT'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['SWIFT VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                    <apex:outputPanel layout="block" styleClass="space-between-text">
                                                                                        <apex:outputPanel layout="block" styleClass="font-13 text-muted">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['IBAN'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                        <apex:outputPanel layout="block" styleClass="font-15">
                                                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO PAY BLOCK']['IBAN VALUE'].Value__c }
                                                                                        </apex:outputPanel>
                                                                                    </apex:outputPanel>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>

                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="m-header">
                                                        <apex:outputPanel layout="block" styleClass="b-col-header" style="margin-bottom: 12px;">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['TOP HEADING'].Value__c }
                                                        </apex:outputPanel>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="smart-img center-block">
                                                        <apex:image url="{! URLFOR($Resource.e2e_images, 'shellkarte_ch_web.png') }"/>
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="m-inside-wrapper">
                                                        <ul class="need-list font-13">
                                                            <li>
                                                                <apex:outputPanel styleClass="point-list">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 1'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="point">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 1 VALUE'].Value__c }
                                                                </apex:outputPanel>
                                                            </li>
                                                            <li>
                                                                <apex:outputPanel styleClass="point-list">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 2'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="point">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 2 VALUE'].Value__c }
                                                                </apex:outputPanel>
                                                            </li>
                                                            <li>
                                                                <apex:outputPanel styleClass="point-list">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 3'].Value__c }
                                                                </apex:outputPanel>
                                                                <apex:outputPanel layout="block" styleClass="point">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['HOW TO START BLOCK']['ITEM 3 VALUE'].Value__c }
                                                                </apex:outputPanel>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- BUSINESS DIRECT DEBIT MANDATE ACCEPTANCE -->
                                        <apex:outputPanel rendered="{! opportunity.Zahlungsart__c = 'Lastschrift' }">
                                            <div class="wrapper">
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12" style="margin: 10px 0 10px 0;">
                                                        <div class="col-xs-11 col-sm-11" style="padding-left: 0; font-size: 17px; font-weight: bold; font-style: normal; font-stretch: normal; line-height: normal; letter-spacing: -0.2px;">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['HEADING'].Value__c }
                                                            <!-- <apex:outputPanel layout="block" styleClass="pull-right" style="margin-right: 5px;">
                                                                <apex:commandLink action="{! showDDMandateDocument }"
                                                                    styleClass="btn btn-xs payment-modal"
                                                                    reRender="sendDDMandateAcceptance, modalDDMandate" status="splashStatus">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                                </apex:commandLink>
                                                            </apex:outputPanel> -->
                                                        </div>
                                                        <div class="col-xs-1 col-sm-1">
                                                            <div class="pull-right">
                                                                <apex:commandLink action="{! showDDMandateModal }"
                                                                    styleClass="btn btn-xs payment-modal"
                                                                    reRender="modalDDMandate"
                                                                    status="splashStatus"
                                                                    style="padding-right: 0px;">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, "full-screen.png" )}" height="17px" width="17px"/>
                                                                </apex:commandLink>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <apex:outputPanel layout="block" styleClass="font-13">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['DESCRIPTION'].Value__c }
                                                        </apex:outputPanel>
                                                        <div class="m-inside-wrapper">
                                                            <ul class="need-list font-13">
                                                                <li>
                                                                    <apex:outputPanel styleClass="point-list">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['ITEM 1'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="point">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['STEP 1'].Value__c }
                                                                    </apex:outputPanel>
                                                                </li>
                                                                <li>
                                                                    <apex:outputPanel styleClass="point-list">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['ITEM 2'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="point">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['STEP 2'].Value__c }
                                                                    </apex:outputPanel>
                                                                </li>
                                                                <li>
                                                                    <apex:outputPanel styleClass="point-list">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['ITEM 3'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="point">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['STEP 3'].Value__c }
                                                                    </apex:outputPanel>
                                                                </li>
                                                                <li>
                                                                    <apex:outputPanel styleClass="point-list">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['ITEM 4'].Value__c }
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel layout="block" styleClass="point">
                                                                        {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['STEP 4'].Value__c }
                                                                    </apex:outputPanel>
                                                                </li>
                                                            </ul>
                                                        </div>
                                                        <apex:outputPanel layout="block" styleClass="font-13" style="margin-top: -15px; margin-bottom: 15px;">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['MESSAGE'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:outputPanel layout="block" styleClass="font-13" style="margin-bottom: 15px;">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['SECOND MESSAGE'].Value__c }
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <script>
                                            $j(document).ready(function() {
                                                $j(this).scrollTop(0);
                                            });
                                            analytics_CongratsOnLoad('{! opportunity.Zahlungsart__c }', "{! IF(opportunity.Security_Amount_To_Pay__c != null, '1', '0') }");
                                        </script>
                                    </apex:outputPanel>

                                    <!--PROCESS ERROR PAGES -->
                                    <apex:outputPanel layout="block"
                                        styleClass="mobile-error-page"
                                        rendered="{! OR(
                                            activeSubStep = 'Too many reports',
                                            activeSubStep = 'Too high limit',
                                            activeSubStep = 'Company not found',
                                            activeSubStep = 'Private entity',
                                            activeSubStep = 'Authorization not granted',
                                            activeSubStep = 'Already in process',
                                            activeSubStep = 'Already a customer',
                                            activeSubStep = 'Black list')
                                        }">
                                        <apex:variable var="errorType" value="{! UPPER(activeSubStep) }"/>
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['PROCESS ERROR'].elements[errorType]['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="font-13 b-error-text">
                                                        {! stepPagesMap['PROCESS ERROR'].elements[errorType]['DESCRIPTION'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="buttons text-center">
                                                    <div class="col-xs-12 col-sm-12">
                                                        <a href="{! stepPagesMap['PROCESS ERROR'].elements['RETURN TO SITE BUTTON']['URL'].Value__c }" class="btn btn-gray">
                                                            {! stepPagesMap['PROCESS ERROR'].elements['RETURN TO SITE BUTTON']['LABEL'].Value__c }
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            activePageAnalytics = "{! IF(activeSubStep != 'Private entity', activeSubStep, '') }";
                                            analytics_AddError('{! activeStep }', activePageAnalytics, '{! activeSubStep }');
                                            endSplash();
                                        </script>
                                    </apex:outputPanel>

                                    <!--SYSTEM ERROR -->
                                    <apex:outputPanel layout="block"
                                        styleClass="mobile-error-page"
                                        rendered="{! activeSubStep = 'System error' }">
                                        <div class="wrapper">
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <apex:outputPanel layout="block" styleClass="b-block-header">
                                                        {! stepPagesMap['SYSTEM ERROR'].elements['TOP HEADING']['HEADING'].Value__c }
                                                    </apex:outputPanel>
                                                    <apex:outputPanel layout="block" styleClass="font-13 b-error-text">
                                                        {! stepPagesMap['SYSTEM ERROR'].elements['DESCRIPTION']['VALUE'].Value__c }
                                                    </apex:outputPanel>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-12 col-sm-12">
                                                    <div class="font-13 b-error-text">
                                                        {! stepPagesMap['SYSTEM ERROR'].elements['FEEDBACK HEADING']['HEADING'].Value__c }<br/>
                                                                    {! stepPagesMap['SYSTEM ERROR'].elements['PHONE']['VALUE'].Value__c }<br/>
                                                                    {! stepPagesMap['SYSTEM ERROR'].elements['EMAIL']['VALUE'].Value__c }<br/>
                                                                    {! stepPagesMap['SYSTEM ERROR'].elements['WORK TIME']['VALUE'].Value__c }
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="buttons text-center">
                                                    <div class="col-lg-12">
                                                        <div class="error-text">
                                                            <a href="{! stepPagesMap['SYSTEM ERROR'].elements['RETURN TO SITE BUTTON']['URL'].Value__c }" class="btn btn-gray" style="min-width: 130px">
                                                                {! stepPagesMap['SYSTEM ERROR'].elements['RETURN TO SITE BUTTON']['BUTTON NAME'].Value__c }
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <script>
                                            analytics_AddError('{! activeStep }', activePageAnalytics, 'SystemError');
                                        </script>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <apex:outputPanel id="modalWindows" styleClass="modalWindows">
                                <!-- MODAL SEND DOCUMENTS / SAVE AND CONTINUE-->
                                <apex:outputPanel layout="block" id="sendDocumentsToEmail">
                                    <apex:variable var="innerPageType" value="{! UPPER(activeInnerPage) }"/>
                                    <apex:outputPanel layout="block"
                                                      styleClass="modal-backdrop fade in"
                                                      rendered="{! OR(
                                                                    activeInnerPage = 'Save and continue later',
                                                                    activeInnerPage = 'Send How to Pay to the email',
                                                                    activeInnerPage = 'Send TC to the email',
                                                                    activeInnerPage = 'Send Deposit Agreement to the email',
                                                                    activeInnerPage = 'Send ddmandate to the email')
                                                                }"/>
                                    <apex:outputPanel layout="block"
                                                      styleClass="modal-info"
                                                      rendered="{! OR(
                                                                    activeInnerPage = 'Save and continue later',
                                                                    activeInnerPage = 'Send How to Pay to the email',
                                                                    activeInnerPage = 'Send TC to the email',
                                                                    activeInnerPage = 'Send Deposit Agreement to the email',
                                                                    activeInnerPage = 'Send ddmandate to the email')
                                                                }">
                                        <apex:outputPanel layout="block"
                                                          styleClass="{! IF(OR(
                                                                    activeInnerPage = 'Save and continue later',
                                                                    activeInnerPage = 'Send How to Pay to the email',
                                                                    activeInnerPage = 'Send TC to the email',
                                                                    activeInnerPage = 'Send Deposit Agreement to the email',
                                                                    activeInnerPage = 'Send ddmandate to the email'), 'modal fade in','modal fade') }"
                                                          style="{! IF(OR(
                                                                    activeInnerPage = 'Save and continue later',
                                                                    activeInnerPage = 'Send How to Pay to the email',
                                                                    activeInnerPage = 'Send TC to the email',
                                                                    activeInnerPage = 'Send Deposit Agreement to the email',
                                                                    activeInnerPage = 'Send ddmandate to the email'), 'display: block;', '')}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h4 class="modal-title">{! stepPagesMap[innerPageType].elements['TOP HEADING']['HEADING'].Value__c }</h4>
                                                    </div>
                                                    <div class="modal-body">
                                                        <div class="row">
                                                            <apex:outputPanel layout="block" styleClass="font-13 modal-text">
                                                                <p>
                                                                    {! stepPagesMap[innerPageType].elements['DESCRIPTION']['VALUE'].Value__c }
                                                                </p>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <div class="row">
                                                            <div class="modal-buttons">
                                                                <apex:commandButton value="{! stepPagesMap[innerPageType].elements['SEND BUTTON']['LABEL'].Value__c }"
                                                                    action="{! sendEnvelope }"
                                                                    style="min-width: 199px"
                                                                    immediate="true"
                                                                    styleClass="btn btn-red"
                                                                    reRender="sendDocumentsToEmail"
                                                                    status="splashStatus"/>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="modal-buttons">
                                                                <apex:commandButton value="{! stepPagesMap[innerPageType].elements['BACK TO FORM BUTTON']['LABEL'].Value__c }"
                                                                    action="{! closeModal }"
                                                                    style="min-width: 80px"
                                                                    immediate="true"
                                                                    styleClass="btn btn-gray"
                                                                    reRender="sendDocumentsToEmail"
                                                                    status="splashStatus"/>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- MOBILE MODAL DD MANDATE -->
                                <apex:outputPanel layout="block" id="modalDDMandate">
                                    <apex:outputPanel layout="block" styleClass="modal-backdrop fade in" rendered="{! activeInnerPage = 'Modal ddMandate' }"/>
                                    <apex:outputPanel layout="block" styleClass="modal-info" rendered="{! activeInnerPage = 'Modal ddMandate' }">
                                        <apex:outputPanel layout="block" styleClass="{! IF(activeInnerPage = 'Modal ddMandate', 'modal fade in','modal fade')}"
                                                          style="{! IF(activeInnerPage = 'Modal ddMandate', 'display: block; padding: 40px 0 24px 0; bottom:auto;', '')}">
                                            <div class="modal-dialog" style="width:100%">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <a onclick="$j('[id$=modalDDMandate]').hide(); $j('[id$=activeInnerPageName]').val(''); scrollDisableControl('enable');" class="close"/>
                                                        <apex:outputPanel layout="block" styleClass="b-block-header" style="margin: 0px;">
                                                            {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['DOCUMENT. LIGHTBOX HEADING'].Value__c }
                                                        <apex:commandLink action="{! showDDMandateDocument }"
                                                            onclick="scrollDisableControl('disable');"
                                                            styleClass="btn btn-xs payment-modal"
                                                            reRender="sendDocumentsToEmail, modalDDMandate" status="splashStatus">
                                                            <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                        </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div class="modal-body payment-modal-body">
                                                        <iframe id="fullFrameContract"
                                                                src="{! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['DOCUMENT. IFRAME URL'].Value__c }"
                                                                name="fullFrameContract"
                                                                width="100%"
                                                                height="100%"
                                                                style="border: 0px; height: 385px; width: 870px;">
                                                            Error loading
                                                        </iframe>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <div class="row">
                                                            <div class="modal-buttons">
                                                                <a
                                                                    onclick="$j('[id$=modalDDMandate]').hide(); $j('[id$=activeInnerPageName]').val(''); scrollDisableControl('enable');"
                                                                    class="btn btn-gray"
                                                                    style="min-width: 222px; font-size: 12px;">
                                                                    {! stepPagesMap['CONGRATULATIONS'].elements['DIRECT DEBIT MANDATE ACCEPTANCE BLOCK']['DOCUMENT. LIGHTBOX BACK BUTTON'].Value__c }
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- MOBILE MODAL TERM CONDITIONS -->
                                <apex:actionFunction name="termsAndConditions" action="{! showTermsAndConditions }" reRender="modalTermConditions" status="splashStatus"/>
                                <apex:outputPanel layout="block" id="modalTermConditions">
                                    <apex:outputPanel layout="block" styleClass="modal-backdrop fade in" rendered="{! activeInnerPage = 'Modal Term And Conditions' }"/>
                                    <apex:outputPanel layout="block" styleClass="modal-info" rendered="{! activeInnerPage = 'Modal Term And Conditions' }">
                                        <apex:outputPanel layout="block" styleClass="{! IF(activeInnerPage = 'Modal Term And Conditions', 'modal fade in','modal fade')}"
                                                          style="{! IF(activeInnerPage = 'Modal Term And Conditions', 'display: block; padding: 40px 0 24px 0; bottom:auto;', '')}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <a onclick="$j('[id$=modalTermConditions]').hide();
                                                                    $j('[id$=activeInnerPageName]').val('');
                                                                    scrollDisableControl('enable');"
                                                           class="close"/>
                                                        <div class="b-block-header" style="margin: 0px 15px 0px 0px;">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['MODAL WINDOW HEADING'].Value__c }
                                                        <apex:commandLink action="{! showSendTcDocument }"
                                                            styleClass="btn btn-xs payment-modal"
                                                            reRender="sendDocumentsToEmail, modalTermConditions" status="splashStatus">
                                                            <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                        </apex:commandLink>
                                                        </div>
                                                    </div>
                                                    <div class="modal-body payment-modal-body">
                                                        <iframe name="frameTermConditions" width="100%" height="100%"
                                                                style="border: 0px; -webkit-overflow-scrolling:touch; overflow-y: scroll;"  src="{! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['IFRAME URL'].Value__c }">
                                                            Error loading
                                                        </iframe>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <div class="row">
                                                            <div class="modal-buttons" style="margin: 10px 0 18px 15px;">
                                                                <a
                                                                    onclick="$j('[id$=modalTermConditions]').hide();
                                                                             $j('[id$=activeInnerPageName]').val('');
                                                                             scrollDisableControl('enable');"
                                                                    class="btn btn-red"
                                                                    style="min-width: 185px">
                                                                    {! stepPagesMap['PAYMENT OPTIONS'].fields['ACCEPT TERM CONDITIONS'].elementItemsMap['BACK BUTTON'].Value__c }
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- MODAL DEPOSIT AGREEMENT -->
                                <apex:actionFunction name="showDepositAgreement" action="{! showDepositAgreementModal }" reRender="modalDepositAgreement" status="splashStatus"/>
                                <apex:outputPanel layout="block" id="modalDepositAgreement">
                                    <apex:outputPanel layout="block" styleClass="modal-backdrop fade in" rendered="{! activeInnerPage = 'Modal Deposit Agreement' }"/>
                                    <apex:outputPanel layout="block" styleClass="modal-info" rendered="{! activeInnerPage = 'Modal Deposit Agreement' }">
                                        <apex:outputPanel layout="block" styleClass="{! IF(activeInnerPage = 'Modal Deposit Agreement', 'modal fade in','modal fade')}"
                                                          style="{! IF(activeInnerPage = 'Modal Deposit Agreement', 'display: block; padding: 40px 0 24px 0; bottom:auto;', '')}">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <a onclick="$j('[id$=modalDepositAgreement]').hide();
                                                                    $j('[id$=activeInnerPageName]').val('');
                                                                    scrollDisableControl('enable');"
                                                           class="close"/>
                                                        <apex:outputPanel layout="block" styleClass="b-block-header inline-block" style="margin: 0px;">
                                                            {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['MODAL WINDOW HEADING'].Value__c }
                                                            <apex:commandLink action="{! showSendDepositAgreementDocument }"
                                                                styleClass="btn btn-xs payment-modal"
                                                                reRender="modalDepositAgreement,sendDocumentsToEmail" status="splashStatus">
                                                                <apex:image url="{!URLFOR($Resource.e2e_images, "email-arrow.png" )}" height="17px" width="26px"/>
                                                            </apex:commandLink>
                                                        </apex:outputPanel>
                                                    </div>
                                                    <div class="modal-body payment-modal-body">
                                                        <iframe src="{! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['IFRAME URL'].Value__c }"
                                                            name="frameDepositAgreement"
                                                            width="100%"
                                                            height="100%"
                                                            style="border: 0px;">
                                                            Error loading
                                                        </iframe>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <div class="row">
                                                            <div class="modal-buttons" style="margin: 10px 0 18px 15px;">
                                                                <a
                                                                    onclick="$j('[id$=modalDepositAgreement]').hide();
                                                                             $j('[id$=activeInnerPageName]').val('');
                                                                             scrollDisableControl('enable');"
                                                                    class="btn btn-red"
                                                                    style="min-width: 185px">
                                                                    {! stepPagesMap['PAYMENT OPTIONS'].fields['DEPOSIT AGREEMENT'].elementItemsMap['BACK BUTTON'].Value__c }
                                                                </a>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </apex:outputPanel>
                                </apex:outputPanel>

                                <!-- MODAL COMPANY SELECTION -->
                                <apex:outputPanel layout="block" id="modalCompanySelection">
                                    <apex:outputPanel layout="block" styleClass="modal-backdrop fade in" rendered="{! activeInnerPage = 'Select company' }"/>
                                    <apex:outputPanel layout="block" styleClass="modal-info" rendered="{! activeInnerPage = 'Select company' }">
                                        <apex:outputPanel layout="block" styleClass="{! IF(activeInnerPage = 'Select company', 'modal fade in','modal fade')}"
                                                          style="{! IF(activeInnerPage = 'Select company', 'display: block; margin: 12px 0 0;', '')}">
                                            <div class="modal-dialog" style="position: absolute;">
                                                <div class="modal-content ym-hide-content">
                                                    <div class="modal-header" style="padding-bottom: 16px;">
                                                        <apex:commandLink action="{! closeModal }" immediate="true"
                                                                          styleClass="close" reRender="modalCompanySelection"/>
                                                        <h4 class="modal-title">
                                                            {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['SELECT COMPANY BLOCK']['HEADING'].Value__c }
                                                        </h4>
                                                        <apex:outputPanel styleClass="font-11" layout="block">
                                                            {! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['SELECT COMPANY BLOCK']['REMARK'].Value__c }
                                                        </apex:outputPanel>
                                                        <apex:inputHidden id="selected-company-id" value="{! selectedCompany.identificationnumber }"/>
                                                    </div>
                                                    <div class="modal-body" style="padding: 0;background-color: #f8f8f8;" id="modalCompanyChoice">
                                                        <div class="row" >
                                                            <apex:outputPanel layout="block" styleClass="select-company">
                                                                <div class="col-xs-12 col-sm-12">
                                                                    <apex:outputPanel layout="block" id="cf-companies">
                                                                        <div class="cf-companies-list" style="height: 380px;">
                                                                            <apex:repeat value="{! foundCompaniesList.companiesMap }" var="companyId">
                                                                                <div class="radio radio-red">
                                                                                    <div class="cf-company">
                                                                                        <input
                                                                                            id="{! companyId }"
                                                                                            type="radio"
                                                                                            name="company"
                                                                                            onclick="$j('[id$=selected-company-id]').val('{! companyId }');
                                                                                                     $j('.save-company-btn').attr('disabled', false);document.cookie = 'apex__e2esource={! opportunity.E2E_Encoded_Url__c }';"/>
                                                                                        <label for="{! companyId }">
                                                                                            <apex:outputPanel styleClass="select-item">
                                                                                                {! foundCompaniesList.companiesMap[companyId].name }
                                                                                            </apex:outputPanel>
                                                                                            <br/>
                                                                                            <apex:outputPanel styleClass="font-11">
                                                                                                {! foundCompaniesList.companiesMap[companyId].street } {! foundCompaniesList.companiesMap[companyId].housenumber }
                                                                                                {! IF(foundCompaniesList.companiesMap[companyId].postcode != null, ', ' +
                                                                                                foundCompaniesList.companiesMap[companyId].postcode, '') }
                                                                                                {! IF(foundCompaniesList.companiesMap[companyId].city != null, ', ' +
                                                                                                foundCompaniesList.companiesMap[companyId].city, '') }
                                                                                                {! IF(foundCompaniesList.companiesMap[companyId].country != null, ', ' +
                                                                                                foundCompaniesList.companiesMap[companyId].country, '') }
                                                                                            </apex:outputPanel>
                                                                                        </label>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="b-splitter"></div>
                                                                            </apex:repeat>
                                                                        </div>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </div>

                                                    <div class="modal-footer" style="margin-top: 16px; margin-bottom: 16px;">
                                                        <div class="row">
                                                            <div class="col-xs-12 col-sm-12">
                                                                <div class="center-block text-center">
                                                                    <apex:actionFunction name="goToSetTotalConsumption" action="{! goToSetTotalConsumption }"
                                                                        reRender="modalCompanySelection, stepList, formBlock, additionInfo, systemError, onlineChatBlock"
                                                                        oncomplete="
                                                                            endSplash();
                                                                            if({! AND(activeSubstep != 'Too many reports', activeSubstep != 'Authorization not granted', activeSubstep != 'Black list', activeSubstep != 'Already a customer', activeSubstep != 'Already in process') }) {toViewport('your-company-viewport')};
                                                                            setEvents_companyDetails();
                                                                            onPageRender();"/>
                                                                    <apex:commandButton value="{! stepPagesMap['CREDIT SCORE. SEARCH COMPANY'].elements['SELECT COMPANY BLOCK']['CONTINUE BUTTON'].Value__c }"
                                                                        action="{! deleteReportsForPreviousCompany }"
                                                                        styleClass="btn btn-red continue save-company-btn"
                                                                        onclick="startSplash();"
                                                                        oncomplete="goToSetTotalConsumption();"
                                                                        reRender="modalCompanySelection, stepList, formBlock, additionInfo, systemError, onlineChatBlock"/>
                                                                    <script>
                                                                        $j('.save-company-btn').attr('disabled', true);
                                                                    </script>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <script>
                                            analytics_CompaniesListOnLoad();
                                        </script>
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                </apex:outputPanel>
                            </div>

                            <!-- STEPS LIST -->
                            <apex:outputPanel id="stepList">
                                <apex:outputPanel layout="block"
                                    styleClass="col-xs-12 col-sm-12"
                                    rendered="{! AND(
                                        activeSubstep != 'Get started',
                                        activeSubStep != 'Too many reports',
                                        activeSubStep != 'Too high limit',
                                        activeSubStep != 'Company not found',
                                        activeSubStep != 'Private entity',
                                        activeSubStep != 'Authorization not granted',
                                        activeSubStep != 'Already in process',
                                        activeSubStep != 'Already a customer',
                                        activeSubStep != 'Black list',
                                        activeSubStep != 'System error'
                                    ) }">
                                    <div class="row">
                                        <div class="b-steps-list">
                                            <apex:outputPanel layout="block" styleClass="li" rendered="{! activeStep < 1 }">
                                                <apex:outputPanel styleClass="li-text" layout="block">{! menuItemsMap[2].Step_Name__c }</apex:outputPanel>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="li" rendered="{! AND(activeStep < 2, activeSubstep != 'Calculating credit score') }">
                                                <apex:outputPanel styleClass="li-text" layout="block">{! menuItemsMap[3].Step_Name__c }</apex:outputPanel>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="li" rendered="{! activeStep < 2 }">
                                                <apex:outputPanel styleClass="li-text" layout="block">{! menuItemsMap[4].Step_Name__c }</apex:outputPanel>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="li" rendered="{! AND(activeStep < 3, activeSubstep != 'Choosing offer', activeSubstep != 'Additional services') }">
                                                <apex:outputPanel styleClass="li-text" layout="block">{! menuItemsMap[5].Step_Name__c }</apex:outputPanel>
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="li" rendered="{! AND(activeStep < 4, opportunity.Security_Amount_To_Pay__c != null) }">
                                                <apex:outputPanel styleClass="li-text" layout="block">{! menuItemsMap[6].Step_Name__c }</apex:outputPanel>
                                            </apex:outputPanel>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>
                        </div>

                        <!-- BOTTOM ADDITION BLOCK -->
                        <apex:outputPanel layout="block" styleClass="addition-info" id="additionInfo">
                            <!-- STEP 0. ADDITION BLOCK -->
                            <apex:outputPanel layout="block" styleClass="contact-details-info" rendered="{! AND(activeStep = 0, activeSubstep = 'Get started') }">
                                <div class="row">
                                    <div class="b-why m-help-info">
                                        <div class="b-header">
                                            {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['TOP HEADING'].Value__c }
                                        </div>
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="why-info">
                                                <div class="collapse-block addition">
                                                    <div class="link" data-toggle="collapse" data-target="#vatRefund">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['SUBHEADING 1'].Value__c }
                                                        <div class="expander block-expand inline-block"></div>
                                                    </div>
                                                    <div class="row collapse" id="vatRefund">
                                                        <div class="desc font-13">
                                                            {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['BODY OF BLOCK 1'].Value__c }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="why-info">
                                                <div class="collapse-block addition">
                                                    <div class="link" data-toggle="collapse" data-target="#accounting">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['SUBHEADING 2'].Value__c }
                                                        <div class="expander block-expand inline-block"></div>
                                                    </div>
                                                    <div class="row collapse" id="accounting">
                                                        <div class="desc font-13">
                                                            {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['BODY OF BLOCK 2'].Value__c }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="why-info">
                                                <div class="collapse-block addition">
                                                    <div class="link" data-toggle="collapse" data-target="#spending">
                                                        {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['SUBHEADING 3'].Value__c }
                                                        <div class="expander block-expand inline-block"></div>
                                                    </div>
                                                    <div class="row collapse" id="spending">
                                                        <div class="desc font-13">
                                                            {! stepPagesMap['CONTACT DETAILS'].elements['WHY FUEL CARDS INFO BLOCK']['BODY OF BLOCK 3'].Value__c }
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="b-cards-type m-help-info">
                                        <div class="b-header">
                                            {! stepPagesMap['CONTACT DETAILS'].elements['TYPE OF CARD INFO BLOCK']['TOP HEADING'].Value__c }
                                        </div>
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="cards-types">
                                                <div class="div-table">
                                                    <div class="div-table-heading">
                                                        <div class="div-table-row">
                                                            <div class="div-table-head"></div>
                                                            <div class="div-table-head font-11">
                                                                <div class="first-div">
                                                                    <div style="width: 82px;">
                                                                       {! stepPagesMap['CONTACT DETAILS'].elements['TYPE OF CARD INFO BLOCK']['TABLE COLUMN 4 NAME'].Value__c }
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="div-table-head font-11">
                                                                <div class="first-div">
                                                                    <div style="width: 82px;">
                                                                       {! stepPagesMap['CONTACT DETAILS'].elements['TYPE OF CARD INFO BLOCK']['TABLE COLUMN 1 NAME'].Value__c }
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="div-table-head font-11">
                                                                <div class="first-div">
                                                                    <div style="width: 38px;">
                                                                        {! stepPagesMap['CONTACT DETAILS'].elements['TYPE OF CARD INFO BLOCK']['TABLE COLUMN 2 NAME'].Value__c }
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="div-table-head font-11">
                                                                <div class="first-div">
                                                                    <div>
                                                                        {! stepPagesMap['CONTACT DETAILS'].elements['TYPE OF CARD INFO BLOCK']['TABLE COLUMN 3 NAME'].Value__c }
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="div-table-body">
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 1']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 1']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 1']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 1']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 1']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 2']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 2']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 2']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 2']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 2']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 3']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 3']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 3']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 3']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 3']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 4']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 4']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 4']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 4']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 4']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 5']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 5']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 5']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 5']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 5']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 6']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 6']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 6']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 6']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 6']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 7']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 7']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 7']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 7']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 7']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 8']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 8']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 8']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 8']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 8']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                        <div class="div-table-row">
                                                            <div class="div-table-cell font-11">
                                                                {! stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 9']['CARD TYPE NAME'].Value__c }
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 9']['SHOP RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 9']['VEHICLE RELATED PRODUCTS'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 9']['ALL FUEL'].Value__c, 'TRUE')}">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                            <div class="div-table-cell">
                                                                <apex:outputPanel layout="block" rendered="{! CONTAINS(stepPagesMap['CONTACT DETAILS'].elements['CARD TYPE 9']['DIESEL ONLY'].Value__c, 'TRUE') }">
                                                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'path.png')}"/>
                                                                </apex:outputPanel>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="b-how-pay m-help-info">
                                        <apex:outputPanel layout="block" styleClass="b-header">
                                            {! stepPagesMap['CONTACT DETAILS'].elements['HOW TO PAY INFO BLOCK']['TOP HEADING'].Value__c }
                                        </apex:outputPanel>
                                        <div class="col-xs-12 col-sm-12">
                                            <div class="pay-info font-13" style="border-bottom: unset; padding-top: 0;">
                                                {! stepPagesMap['CONTACT DETAILS'].elements['HOW TO PAY INFO BLOCK']['BODY OF BLOCK'].Value__c }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>

                            <!-- STEP CONGRATULATION. ADDITION BLOCK -->
                            <apex:outputPanel id="congratulationsInfo" layout="block" styleClass="congratulations-info" rendered="{! AND(activeStep = 5, activeSubstep = 'Congratulations') }">
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12">
                                        <apex:outputPanel layout="block" styleClass="info-block">
                                            <apex:outputPanel layout="block" styleClass="b-col-header">
                                                {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['TOP HEADING'].Value__c }
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="font-13">
                                                {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['TEXT BLOCK'].Value__c }
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block">
                                                <apex:outputPanel layout="block" styleClass="font-15" style="margin-bottom: 4px;">
                                                    {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['SUBBLOCK HEADING 1'].Value__c }
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="font-13">
                                                    {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['TEXT BLOCK SUBBLOCK 1'].Value__c }
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-9 col-sm-9">
                                        <apex:outputPanel layout="block" styleClass="info-block">
                                            <apex:outputPanel layout="block" styleClass="font-15">
                                                {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['SUBBLOCK HEADING 2'].Value__c }
                                            </apex:outputPanel>

                                            <apex:outputPanel layout="block" styleClass="font-13 customer-care" rendered="{! OR( opportunity.Garantie_other__c != null, AND(opportunity.Garantie_other__c = null, OR(paymentStatus = 'A', paymentStatus = 'C', paymentStatus = null))) }">
                                                <apex:outputPanel layout="block">
                                                    {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['WORK TIME SUBBLOCK 2 SUCCESS'].Value__c }
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="assistance-info">
                                                    <apex:outputPanel layout="block">
                                                        {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['PHONE SUBBLOCK 2 SUCCESS'].Value__c }
                                                        <apex:image url="{! URLFOR($Resource.e2e_images, 'phone.png') }"></apex:image>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block">
                                                    <a href="mailto:{! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['EMAIL SUBBLOCK 2 SUCCESS'].Value__c }">{! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['EMAIL SUBBLOCK 2 SUCCESS'].Value__c }</a>
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                            <apex:outputPanel layout="block" styleClass="font-13 customer-care" rendered="{! AND(opportunity.Garantie_other__c = null, OR(paymentStatus = 'D', paymentStatus = 'E')) }">
                                                <apex:outputPanel layout="block">
                                                    {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['WORK TIME SUBBLOCK 2 UNSUCCESS'].Value__c }
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block" styleClass="assistance-info">
                                                    <apex:outputPanel layout="block">
                                                        {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['PHONE SUBBLOCK 2 UNSUCCESS'].Value__c }
                                                        <apex:image url="{! URLFOR($Resource.e2e_images, 'phone.png') }"></apex:image>
                                                    </apex:outputPanel>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block">
                                                    <a href="mailto:{! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['EMAIL SUBBLOCK 2 UNSUCCESS'].Value__c }">{! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['EMAIL SUBBLOCK 2 UNSUCCESS'].Value__c }</a>
                                                </apex:outputPanel>
                                            </apex:outputPanel>

                                        </apex:outputPanel>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12">
                                        <apex:outputPanel layout="block" styleClass="buttons-block">
                                            <div class="buttons text-center">
                                                <apex:outputPanel layout="block">
                                                    <a href="{! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['RETURN TO SITE URL'].Value__c }" class="btn btn-gray" style="line-height: 16px;">
                                                        {! stepPagesMap['CONGRATULATIONS'].elements['ADDITIONAL INFO BLOCK']['RETURN TO SITE BUTTON'].Value__c }
                                                    </a>
                                                </apex:outputPanel>
                                            </div>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </apex:outputPanel>

                            <!-- STEP MOBILE ERROR PAGE -->
                            <apex:outputPanel layout="block"
                                styleClass="mobile-error-info"
                                rendered="{! OR(
                                    activeSubStep = 'Too many reports',
                                    activeSubStep = 'Too high limit',
                                    activeSubStep = 'Company not found',
                                    activeSubStep = 'Authorization not granted',
                                    activeSubStep = 'Already in process',
                                    activeSubStep = 'Already a customer')
                                }">
                                <script>
                                    toViewport('top-heading-viewport');
                                </script>
                                <apex:variable var="errorType" value="{! UPPER(activeSubStep) }"/>
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12">
                                        <apex:outputPanel layout="block" styleClass="b-block-header">
                                            {! stepPagesMap['PROCESS ERROR'].elements[errorType]['FEEDBACK HEADING'].Value__c }
                                        </apex:outputPanel>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12">
                                        <apex:outputPanel layout="block" styleClass="font-13 customer-care">
                                            <apex:outputPanel layout="block">
                                                {! stepPagesMap['PROCESS ERROR'].elements[errorType]['WORK TIME'].Value__c }
                                            </apex:outputPanel>
                                            <apex:outputPanel layout="block" styleClass="assistance-info">
                                                <apex:outputPanel layout="block">
                                                    {! stepPagesMap['PROCESS ERROR'].elements[errorType]['PHONE'].Value__c }
                                                    <apex:image url="{! URLFOR($Resource.e2e_images, 'phone.png') }"></apex:image>
                                                </apex:outputPanel>
                                                <apex:outputPanel layout="block">
                                                    <apex:outputLink >
                                                        {! stepPagesMap['PROCESS ERROR'].elements[errorType]['EMAIL'].Value__c }
                                                    </apex:outputLink>
                                                </apex:outputPanel>
                                            </apex:outputPanel>
                                        </apex:outputPanel>
                                    </div>
                                </div>
                            </apex:outputPanel>
                        </apex:outputPanel>

                        <!-- BACK TO TOP -->
                        <apex:outputPanel layout="block"
                            rendered="{! AND(
                                activeStep != 0,
                                activeSubstep != 'Get started'
                            )}">
                            <div class="row">
                                <div class="col-xs-12 col-sm-12">
                                    <apex:outputPanel layout="block" styleClass="back-to-top">
                                        <a href="" id="top"> &#8593; {! stepPagesMap['FOOTER'].elements['BACK TO THE TOP BUTTON']['LABEL'].Value__c } </a>
                                    </apex:outputPanel>
                                </div>
                            </div>
                        </apex:outputPanel>
                    </div>
                </div>
            </main>
            <footer>
                <div class="container hidden-lgxl">
                    <div class="row">
                        <div class="col-xs-12 col-sm-12">
                            <div class="fleetcor">
                                <div class="b-page-logo" style="margin: 13px 0 10px 0px;">
                                    <apex:image url="{!URLFOR($Resource.e2e_images, 'm-logo.png')}"/>
                                </div>
                                <apex:outputPanel layout="block" styleClass="fleetcor-desc text-muted">
                                    {! stepPagesMap['FOOTER'].elements['DESCRIPTION']['VALUE'].Value__c }
                                </apex:outputPanel>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="b-copyright">
                            <apex:outputPanel layout="block">
                                <apex:outputLink value="{! stepPagesMap['FOOTER'].elements['COPYRIGHT']['URL'].Value__c }" target="_blank">
                                    {! stepPagesMap['FOOTER'].elements['COPYRIGHT']['VALUE'].Value__c }
                                </apex:outputLink>
                            </apex:outputPanel>
                        </div>
                    </div>
                </div>
                <!-- CHAT BLOCK -->
                <div class="chat-button" id="chat-button-offline" style="display: none;" onclick="setupOfflineChat(); return false;">
                    <apex:image url="{!URLFOR($Resource.e2e_images, 'chat.png')}" />
                </div>
                <div  class="chat-button" id="chat-button-online" style=" display: none;" onclick="setupOnlineChat(); return false;">
                    <apex:image url="{!URLFOR($Resource.e2e_images, 'chat.png')}" />
                </div>
                <div class="chat-box" id="chatOfflineBlock">
                    <span>
                        <div class="no_save no_brand" id="liveAgentClientChatSettings">
                            <div class="liveAgentState" id="liveAgentClientChat">
                                 <div class="chat-header">{! pageMapChat['CHAT'].elements['CHAT HEADING']['TEXT'].Value__c }
                                    <span id="clientChatEndButtonID">
                                        <button class="close liveAgentEndButton" onclick="closeChat('offline'); return false;" />
                                    </span>
                                 </div>
                                <div class="chat-status">
                                    {! pageMapChat['CHAT'].elements['CHAT OFFLINE']['VALUE'].Value__c }
                                </div>
                                <div>
                                    <div>
                                        <span>
                                            <div class="liveAgentAlert" id="liveAgentMessageContainer"></div>
                                        </span>
                                        <div style="word-wrap: break-word; padding-top:1px;">
                                            <span>
                                                <div class="liveAgentChatElement" id="liveAgentChatLog">
                                                    <div id="liveAgentChatLogText" class="liveAgentChatLogText" style="margin-top:10px;">
                                                        <span class="chat-operator">
                                                            <span class="chat-name"><strong>FLEETCOR</strong>
                                                                <span class="chat-customDateTime" style="display: inline"></span>
                                                            </span>
                                                            <span class="chat-messageText">
                                                                 {! pageMapChat['CHAT'].elements['CHAT OFFLINE GREETING']['VALUE'].Value__c }
                                                            </span>
                                                        </span>
                                                    </div>
                                                    <span class="chat-operator" id="liveAgentChatLogTyping" style="display: none;"></span>
                                                </div>
                                            </span>
                                        </div>
                                        <div class="col-xs-9 col-lg-9 col-md-9 col-sm-9" style="padding: 0px;">
                                            <span>
                                                <div class="liveAgentChatElement liveAgentChatInput" id="liveAgentChatInput">
                                                     <textarea class="liveAgentChatTextArea" id="liveAgentChatTextArea" maxlength="6000"
                                                              placeholder="{!pageMapChat['CHAT'].elements['TEXTAREA']['PLACEHOLDER'].Value__c }" wrap="soft" data-uidsfdc="3" />
                                                </div>
                                            </span>
                                        </div>
                                        <div class="col-xs-3 col-lg-3 col-md-3 col-sm-3" style="padding: 0px;">
                                            <span>
                                                 <button class="liveAgentChatElement liveAgentSendButton" onclick="updateOfflineChat();return false;" style="margin: 0px;"> {! pageMapChat['CHAT'].elements['SEND BUTTON']['TEXT'].Value__c} </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </span>
                </div>
                <div class="chat-box" id="chatOnlineBlock">
                    <div class="chat-header" style="margin:0px;">
                        <button class="close liveAgentEndButton"
                                onclick="closeChat('online'); return false;"
                                style="position:absolute; right:6px; top:8px;"
                                id="clientChatEndButtonID" label="x">
                        </button>
                    </div>
                </div>
                <div class="lightbox"></div>
            </footer>
        </body>
    </apex:form>
    <!-- PAYMENT FORM -->
<!--     <apex:outputPanel id="paymentFormToSend" style="display: none;" >
        <form class="paymentFormToSubmit" method="POST" action="{! paymentURL }" id="paymentFormToSubmit">
            <apex:repeat value="{! paymentParameters }" var="param">
                <input type="hidden"  name="{! param }" value="{! paymentParameters[param] }" />
            </apex:repeat>
        </form>
    </apex:outputPanel> -->
</apex:page>